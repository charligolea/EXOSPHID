module solar_spectrum

using Interpolations

export flux_outputs

const c = 299792458 # Speed of light in m/s
const h  = 6.62607015e-34 # m2 kg / s

# Wavelength in Angstroms (A) from Huebner (2015)
solar_wavelength = 
    (1, 2, 4, 6, 8, 10, 40, 50, 60, 70, 80, 90, 100, 110, 120, 128, 153, 176, 205, 231, 270, 280, 300, 320, 340, 360, 370, 400, 430, 460, 480, 500, 
    520, 540, 560, 580, 600, 620, 630, 680, 710, 740, 770, 800, 830, 860, 890, 911, 920, 930, 940, 950, 960, 970, 980, 995, 1007, 1017, 1027, 1035, 1045, 1057, 1070, 1080, 
    1090, 1100, 1110, 1120, 1130, 1140, 1150, 1157, 1163, 1170, 1176, 1183, 1190, 1198, 1205, 1212, 1220, 1227, 1235, 1242, 1250, 1258, 1266, 1274, 1282, 1290, 1299, 1307, 1316, 1324, 1333, 1342,
    1351, 1360, 1370, 1379, 1389, 1408, 1428, 1449, 1470, 1492, 1515, 1538, 1562, 1587, 1613, 1639, 1667, 1695, 1724, 1739, 1754, 1770, 1786, 1802, 1818, 1835, 1852, 1869, 1887, 1905, 1923, 1942, 
    1961, 1980, 2000, 2020, 2041, 2062, 2083, 2105, 2128, 2150, 2174, 2198, 2222, 2247, 2273, 2299, 2326, 2353, 2381, 2410, 2439, 2469, 2500, 2532, 2564, 2597, 2632, 2667, 2703, 2740, 2778, 2817,
    2857, 2899, 2941, 2985, 3030, 3077, 3125, 3175, 3225, 3275, 3325, 3375, 3425, 3475, 3525, 3575, 3625, 3675, 3725, 3775, 3825, 3875, 3925, 3975, 4025, 4075, 4125, 4175, 4225, 4275, 4325, 4375, 4425, 
    4475, 4525, 4575, 4625, 4675, 4725, 4775, 4825, 4875, 4925, 4975, 5025, 5075, 5125, 5175, 5225, 5275, 5325, 5375, 5425, 5475, 5525, 5575, 5625, 5675, 5725, 5775, 5825, 5875, 5925, 5975, 6025, 6075, 
    6125, 6175, 6225, 6275, 6325, 6375, 6425, 6475, 6550, 6650, 6750, 6850, 6950, 7050, 7150, 7250, 7350, 7450, 7550, 7650, 7750, 7850, 7950, 8050, 8150, 8250, 8350, 8450, 8550, 8650, 8750, 8850, 8950, 
    9050, 9150, 9250, 9350, 9450, 9550, 9650, 9750, 9850, 9950, 10150, 10750, 11250, 11750, 12250, 12750, 13250, 13750, 14250, 14750, 15250, 15750, 16250, 16750, 17250, 17750, 18250, 18750, 19250, 19750, 20375, 21500, 22500, 
    23500, 24500, 25500, 26500, 27500, 28500, 29500, 30500, 31500, 32500, 33500, 34500, 35500, 36500, 37500, 38500, 39500, 40500, 41500, 42500, 43500, 44500, 45500, 46500, 47500, 48500, 49500, 52750, 65000, 75000, 85000, 95000)

function normalize_flux_distribution(wavelengths::NTuple{N, Int64}, solar_fluxes::NTuple{N, Float64}, min_wavelength::Float64, max_wavelength::Float64)  where {N}

    """ 
    OBJECTIVE: For a certain wavelength range other than  1A - 95e3 A (Huebner Data), determine the weighted probabiulities of a photon having a certain energy/wvl
    
    INPUTS: 
    - wavelengths::  solar_wavelength data from Huebner (2015)
    - solar_fluxes::  Solar fluxes in photons/s (already includes cross section dependency)
    - min_wavelength:: Lower bound for wavelength interval to study
    - max_wavelength:: Upper bound for wavelength interval to study

    OUTPUTS:
    - filtered_wavelengths:: new wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector
    """

    # Convert tuples to vectors for indexing
    wl_vec = collect(wavelengths)
    flux_vec = collect(solar_fluxes)

    # Filter data to get wavelengths within the specified range
    filtered_indices = (wl_vec .>= min_wavelength) .& (wl_vec .<= max_wavelength)
    filtered_wavelengths = wl_vec[filtered_indices]
    filtered_fluxes = flux_vec[filtered_indices]

    # Exclude Lyman-alpha if the condition holds
    if min_wavelength != 1.0 && max_wavelength != 95000.0
        if min_wavelength < 1208.0 && max_wavelength > 1220.0
            exclude_indices = findall(x -> x != 1212, filtered_wavelengths)  # Indices excluding 1212
            filtered_wavelengths = filtered_wavelengths[exclude_indices]
            filtered_fluxes = filtered_fluxes[exclude_indices]
        end
    end

    # Normalize the fluxes
    total_flux = sum(filtered_fluxes)
    normalized_fluxes = filtered_fluxes / total_flux

    return Tuple(filtered_wavelengths), Tuple(normalized_fluxes)
end


function generate_weighted_random_wvl(wavelengths::NTuple{N,Int64}, normalized_fluxes::NTuple{N,Float64}) where {N}
    """ 
    OBJECTIVE: Generate random wavelength according to the given weights derived from the species dependent photon flux in photons/s
    
    INPUTS: 
    - wavelengths::  wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector

    OUTPUTS:
    - wavelength vector / value
    """
    cumulative_distribution = Base.cumsum(collect(normalized_fluxes))
    random_value = rand()
    selected_index = findfirst(x -> x >= random_value, cumulative_distribution)
    return wavelengths[selected_index] * 1e-10
end


function generate_energy_vector(wavelengths::NTuple{N,Int64}, normalized_fluxes::NTuple{N,Float64}, num_reactions::Int) where {N}
    
    """ 
    OBJECTIVE: Generate vector of size num_reactions with random energies and wavelengths according to the given weights derived from the species dependent photon flux in photons/s
    
    INPUTS: 
    - wavelengths::  wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector
    - num_reactions:: number of photons to be simulated at once (usually 1)

    OUTPUTS:
    - wvl_vector, e_vector
    """

    if num_reactions == 1
        photon_wvl_m = generate_weighted_random_wvl(wavelengths, normalized_fluxes)
        photon_wvl = Int(round(photon_wvl_m / 1e-10))
        photon_energy = h * c / photon_wvl_m
        return photon_wvl, photon_energy
    else
        e_vector = Float64[]
        wvl_vector = Int64[]
        for i in 1:num_reactions
            photon_wvl_m = generate_weighted_random_wvl(wavelengths, normalized_fluxes)
            push!(wvl_vector, Int(round(photon_wvl_m / 1e-10)))
            push!(e_vector, h * c / photon_wvl_m)
        end
        return wvl_vector, e_vector
    end
end



function flux_outputs(parent_type::String, wvl_range, sun_mode::Float64, num_reactions::Int64)

    """ 
    OBJECTIVE: Get photon energy and wavelength for a certain parent species and degree of solar activity
    INPUTS: 
    - parent_type:: Parent species to be photodissociated/ionized
    - wvl_range::  2D Tuple
    - sun_mode:: decimal degree of solar activity (0.0 -> quiet sun, 1.0 -> active sun, or in between)
    - num_reactions:: number of photons to be simulated at once (usually 1)

    OUTPUTS:
    - Final wavelength and energy vector / value
    """

    wavelengths = solar_wavelength
    flux_quiet, flux_active = nothing, nothing

    if parent_type == "H2O"
        if wvl_range == (1.0, 95000.0)
            # H2O normalized fluxes when USING full solar spectrum. QUIET SUN
            flux_quiet = (1.18120617e-06, 1.18120617e-06, 1.18120617e-06, 1.18120617e-06,
                1.18120617e-06, 1.18120617e-06, 1.18120617e-06, 3.19146662e-06, 5.66225583e-06, 7.85996108e-06, 9.97710403e-06, 9.02078020e-06, 8.06445637e-06, 4.99705787e-06, 1.14640725e-05, 2.62273287e-05, 1.30221759e-04, 5.39093310e-04, 3.50904270e-04, 4.62114957e-04,
                4.79624634e-04, 6.19263942e-04, 2.47389193e-03, 6.16344331e-04, 3.13395048e-04, 1.30524352e-03, 1.36427711e-04, 1.23162209e-04, 1.03494487e-04, 1.85827087e-04, 3.53299276e-04, 4.89484917e-04, 2.61448417e-04, 3.04365371e-04, 2.45233979e-04, 7.24442622e-04,
                6.39187211e-04, 1.90277996e-03, 1.05773541e-04, 2.12279093e-04, 1.13191802e-04, 2.87239923e-04, 6.63352054e-04, 5.17702751e-04, 1.15200828e-03, 1.72585583e-03, 2.95867055e-03, 3.23922912e-04, 5.96760773e-04, 1.00491525e-03, 5.75754577e-04, 5.84783594e-04,
                1.34146901e-03, 5.00991238e-03, 5.53092894e-04, 1.52291707e-04, 2.69384282e-04, 1.30198387e-03, 1.07526604e-03, 5.16180881e-04, 3.25445628e-05, 5.55467505e-05, 2.42560834e-04, 2.75425269e-04, 8.66411882e-05, 1.25142234e-04, 4.38747699e-04, 3.51747787e-04,
                1.15192510e-04, 3.70302579e-05, 3.81370890e-05, 3.31420899e-05, 1.40566900e-04, 2.03086591e-04, 7.51485653e-05, 1.31906073e-04, 1.72783405e-04, 1.58369137e-04, 2.03409840e-01, 3.73740180e-01, 6.51981613e-02, 1.70562926e-03, 2.13071805e-03, 2.17702269e-03,
                2.22994229e-03, 2.28286189e-03, 1.07639476e-03, 9.96094426e-04, 8.95238033e-04, 2.50222580e-03, 4.13855813e-03, 2.69605540e-03, 1.20541866e-03, 3.35378131e-03, 3.06450301e-03, 1.46607562e-03, 9.14655708e-04, 7.06665676e-04, 5.70130808e-04, 4.88280800e-04,
                4.10991934e-04, 3.20106595e-04, 2.95426317e-04, 4.96598684e-04, 8.32024244e-04, 1.15020549e-03, 1.89257396e-03, 3.34426830e-03, 5.34069892e-03, 8.56320184e-03, 8.91920772e-03, 1.86713674e-02, 2.73406574e-02, 2.94558390e-02, 3.25335932e-02, 3.42707408e-02,
                3.38931860e-02, 2.99406071e-02, 2.05711295e-02, 1.35124461e-02, 1.00848863e-02, 4.25857067e-03, 3.43738287e-04, 5.44393923e-09, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12,
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12,
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 
                2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12, 2.29398075e-12)

            # H2O normalized fluxes when USING full solar spectrum. QUIET SUN
            flux_active = (3.89495910e-06, 3.89495910e-06, 3.89495910e-06, 3.89495910e-06,
                3.89495910e-06, 3.89495910e-06, 3.89495910e-06, 1.05236768e-05, 7.29189491e-06, 9.53054069e-06, 1.20504841e-05, 1.07869027e-05, 9.70811854e-06, 6.05567186e-06, 1.45548629e-05, 3.69677043e-05, 3.04016995e-04, 1.48170098e-03, 6.22257026e-04, 1.21088138e-03,
                6.76622792e-04, 7.14858841e-04, 3.59150460e-03, 8.22593588e-04, 3.54816961e-04, 1.93391201e-03, 1.52214160e-04, 1.46274626e-04, 1.28577868e-04, 2.30864960e-04, 4.35906313e-04, 5.75589469e-04, 3.02583757e-04, 3.22244280e-04, 2.47305340e-04, 7.05821093e-04,
                6.13845447e-04, 1.88244094e-03, 1.06199161e-04, 2.16964873e-04, 1.26962226e-04, 2.93361265e-04, 8.45071497e-04, 6.65515549e-04, 1.44515451e-03, 2.15307579e-03, 3.69106263e-03, 4.04107093e-04, 7.44483493e-04, 1.02378593e-03, 5.85791582e-04, 5.94191116e-04,
                1.36124440e-03, 6.06347317e-03, 6.73353607e-04, 1.85631807e-04, 3.28679594e-04, 1.58986191e-03, 9.98889215e-04, 4.59587410e-04, 2.89764148e-05, 4.94566695e-05, 2.15966747e-04, 2.62336891e-04, 8.25239458e-05, 1.19195398e-04, 4.17898139e-04, 3.35032516e-04,
                1.13269220e-04, 3.64979882e-05, 3.72290696e-05, 3.21341011e-05, 1.35495889e-04, 1.94418808e-04, 7.21233253e-05, 1.47419589e-04, 2.07062843e-04, 1.86637365e-04, 2.36175840e-01, 4.27435987e-01, 7.32678598e-02, 1.89631764e-03, 2.36152085e-03, 2.40621641e-03,
                2.45695197e-03, 2.50731943e-03, 1.17848548e-03, 1.05050166e-03, 8.65872632e-04, 2.41530390e-03, 3.98577957e-03, 2.60626618e-03, 1.17129589e-03, 3.48812039e-03, 3.23428892e-03, 1.51454840e-03, 9.24462498e-04, 7.18183677e-04, 5.84532191e-04, 4.86162095e-04,
                3.82996654e-04, 2.74291314e-04, 2.54610865e-04, 4.30579777e-04, 7.25752670e-04, 9.20775213e-04, 1.48118006e-03, 2.57417629e-03, 4.06465682e-03, 6.32994369e-03, 6.42312899e-03, 1.28765629e-02, 1.82306679e-02, 1.83925648e-02, 2.00670883e-02, 2.10038576e-02,
                2.06392231e-02, 1.81067567e-02, 1.23542514e-02, 8.10561289e-03, 6.04323112e-03, 2.54905670e-03, 2.05523009e-04, 3.25133842e-09, 1.36844077e-12, 1.36682441e-12, 1.36036627e-12, 1.33979031e-12, 1.32807334e-12, 1.31635638e-12, 1.30402274e-12, 1.29168909e-12,
                1.28726823e-12, 1.27575063e-12, 1.24685752e-12, 1.24685752e-12, 1.23452387e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12, 1.22310786e-12,
                1.22310786e-12, 1.21900697e-12, 1.19935819e-12, 1.19935408e-12, 1.19934997e-12, 1.19934574e-12, 1.19934124e-12, 1.19933675e-12, 1.19933213e-12, 1.19932738e-12, 1.19932250e-12, 1.19931749e-12, 1.19931236e-12, 1.19930697e-12, 1.19930158e-12, 1.19929593e-12,
                1.19929015e-12, 1.19928412e-12, 1.19927795e-12, 1.19927154e-12, 1.19926512e-12, 1.19925870e-12, 1.19925228e-12, 1.19924586e-12, 1.19923944e-12, 1.19923302e-12, 1.19922660e-12, 1.19922019e-12, 1.19921377e-12, 1.19920735e-12, 1.19920093e-12, 1.19919451e-12,
                1.19918809e-12, 1.19918167e-12, 1.19917525e-12, 1.19916883e-12, 1.19916242e-12, 1.19915600e-12, 1.19914958e-12, 1.19914316e-12, 1.19913674e-12, 1.19913032e-12, 1.19912390e-12, 1.19911748e-12, 1.19911107e-12, 1.19910465e-12, 1.19909823e-12, 1.19909181e-12,
                1.19908539e-12, 1.19907897e-12, 1.19907255e-12, 1.19906613e-12, 1.19905971e-12, 1.19905330e-12, 1.19904688e-12, 1.19904046e-12, 1.19903404e-12, 1.19902762e-12, 1.19902120e-12, 1.19901478e-12, 1.19900836e-12, 1.19900195e-12, 1.19899553e-12, 1.19898911e-12,
                1.19898269e-12, 1.19897627e-12, 1.19896985e-12, 1.19896343e-12, 1.19895701e-12, 1.19895059e-12, 1.19894418e-12, 1.19893776e-12, 1.19893134e-12, 1.19892492e-12, 1.19891850e-12, 1.19891208e-12, 1.19890566e-12, 1.19889924e-12, 1.19889283e-12, 1.19888641e-12,
                1.19887999e-12, 1.19887357e-12, 1.19886715e-12, 1.19886073e-12, 1.19885431e-12, 1.19884789e-12, 1.19883827e-12, 1.19882543e-12, 1.19881259e-12, 1.19879975e-12, 1.19878691e-12, 1.19877408e-12, 1.19876124e-12, 1.19874840e-12, 1.19873556e-12, 1.19872273e-12,
                1.19870989e-12, 1.19869705e-12, 1.19868421e-12, 1.19867138e-12, 1.19865854e-12, 1.19864570e-12, 1.19863286e-12, 1.19862002e-12, 1.19860719e-12, 1.19859435e-12, 1.19858151e-12, 1.19856867e-12, 1.19855584e-12, 1.19854300e-12, 1.19853016e-12, 1.19851732e-12,
                1.19850449e-12, 1.19849165e-12, 1.19847881e-12, 1.19846597e-12, 1.19845314e-12, 1.19844030e-12, 1.19842746e-12, 1.19841462e-12, 1.19840178e-12, 1.19837611e-12, 1.19829908e-12, 1.19823490e-12, 1.19817071e-12, 1.19810652e-12, 1.19804233e-12, 1.19797814e-12,
                1.19791395e-12, 1.19784977e-12, 1.19778558e-12, 1.19772139e-12, 1.19765720e-12, 1.19759301e-12, 1.19752882e-12, 1.19746464e-12, 1.19740045e-12, 1.19733626e-12, 1.19727207e-12, 1.19720788e-12, 1.19714369e-12, 1.19706346e-12, 1.19691904e-12, 1.19679066e-12,
                1.19666228e-12, 1.19653391e-12, 1.19640553e-12, 1.19627715e-12, 1.19614878e-12, 1.19602040e-12, 1.19589202e-12, 1.19576365e-12, 1.19563527e-12, 1.19550689e-12, 1.19537852e-12, 1.19525014e-12, 1.19512176e-12, 1.19499339e-12, 1.19486501e-12, 1.19473663e-12,
                1.19460826e-12, 1.19447988e-12, 1.19435150e-12, 1.19422313e-12, 1.19409475e-12, 1.19396637e-12, 1.19383800e-12, 1.19370962e-12, 1.19358124e-12, 1.19345287e-12, 1.19332449e-12, 1.19290727e-12, 1.19133465e-12, 1.19005089e-12, 1.18876712e-12, 1.18748336e-12)

        else

            # H2O Flux already multiplied by cross_section!!! Photons per second!!! QUIET SUN
            solar_flux_water = (1.32708816e-12, 1.32708816e-12, 1.32708816e-12, 1.32708816e-12,
                1.32708816e-12, 1.32708816e-12, 1.32708816e-12, 3.58562091e-12, 6.36155891e-12, 8.83068638e-12, 1.12093019e-11, 1.01348696e-11, 9.06043737e-12, 5.61420730e-12, 1.28799148e-11, 2.94664709e-11, 1.46304479e-10, 6.05672713e-10, 3.94241845e-10, 5.19187337e-10,
                5.38859503e-10, 6.95744623e-10, 2.77942391e-09, 6.92464433e-10, 3.52100138e-10, 1.46644443e-09, 1.53276883e-10, 1.38373056e-10, 1.16276321e-10, 2.08777208e-10, 3.96932640e-10, 5.49937556e-10, 2.93737966e-10, 3.41955273e-10, 2.75521002e-10, 8.13913140e-10,
                7.18128466e-10, 2.13777815e-09, 1.18836844e-10, 2.38496105e-10, 1.27171280e-10, 3.22714788e-10, 7.45277729e-10, 5.81640365e-10, 1.29428425e-09, 1.93900344e-09, 3.32407394e-09, 3.63928221e-10, 6.70462256e-10, 1.12902485e-09, 6.46861741e-10, 6.57005864e-10,
                1.50714387e-09, 5.62864937e-09, 6.21401281e-10, 1.71100123e-10, 3.02653930e-10, 1.46278221e-09, 1.20806415e-09, 5.79930540e-10, 3.65638995e-11, 6.24069163e-11, 2.72517718e-10, 3.09440994e-10, 9.73415966e-11, 1.40597620e-10, 4.92934162e-10, 3.95189539e-10,
                1.29419080e-10, 4.16035895e-11, 4.28471170e-11, 3.72352228e-11, 1.57927271e-10, 2.28168304e-10, 8.44296053e-11, 1.48196811e-10, 1.94122597e-10, 1.77928130e-10, 2.28531476e-07, 4.19898048e-07, 7.32503010e-08, 1.91627884e-09, 2.39386718e-09, 2.44589057e-09,
                2.50534587e-09, 2.56480117e-09, 1.20933227e-09, 1.11911464e-09, 1.00580222e-09, 2.81125709e-09, 4.64968065e-09, 3.02902514e-09, 1.35429095e-09, 3.76798188e-09, 3.44297697e-09, 1.64713970e-09, 1.02761803e-09, 7.93940695e-10, 6.40543422e-10, 5.48584728e-10,
                4.61750490e-10, 3.59640579e-10, 3.31912223e-10, 5.57929892e-10, 9.34781367e-10, 1.29225881e-09, 2.12631168e-09, 3.75729399e-09, 6.00028890e-09, 9.62077918e-09, 1.00207527e-08, 2.09773290e-08, 3.07172985e-08, 3.30937105e-08, 3.65515752e-08, 3.85032649e-08, 
                3.80790812e-08, 3.36383487e-08, 2.31117166e-08, 1.51812678e-08, 1.13303956e-08, 4.78451504e-09, 3.86190845e-10, 6.11627965e-15, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18,
                2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18, 2.57729324e-18)


            # H2O Flux already multiplied by cross_section!!! Photons per second!!! ACTIVE SUN
            solar_flux_water_active = (8.45355155e-12, 8.45355155e-12, 8.45355155e-12, 8.45355155e-12,
                8.45355155e-12, 8.45355155e-12, 8.45355155e-12, 2.28404052e-11, 1.58262020e-11, 2.06849199e-11, 2.61541612e-11, 2.34117061e-11, 2.10703318e-11, 1.31431250e-11, 3.15896215e-11, 8.02340630e-11, 6.59833202e-10, 3.21585807e-09, 1.35053584e-09, 2.62807591e-09,
                1.46853035e-09, 1.55151721e-09, 7.79493918e-09, 1.78534283e-09, 7.70088566e-10, 4.19732903e-09, 3.30362967e-10, 3.17471906e-10, 2.79063170e-10, 5.01065298e-10, 9.46083486e-10, 1.24924938e-09, 6.56722528e-10, 6.99393386e-10, 5.36747212e-10, 1.53190183e-09,
                1.33227949e-09, 4.08561709e-09, 2.30492813e-10, 4.70896790e-10, 2.75556609e-10, 6.36706192e-10, 1.83412849e-09, 1.44442338e-09, 3.13653824e-09, 4.67299828e-09, 8.01101819e-09, 8.77067012e-10, 1.61581404e-09, 2.22200719e-09, 1.27139187e-09, 1.28962207e-09,
                2.95442118e-09, 1.31600568e-08, 1.46143497e-09, 4.02892049e-10, 7.13360480e-10, 3.45060866e-09, 2.16797179e-09, 9.97480529e-10, 6.28899072e-11, 1.07339896e-10, 4.68730475e-10, 5.69371429e-10, 1.79108538e-10, 2.58699621e-10, 9.06998859e-10, 7.27148751e-10,
                2.45837547e-10, 7.92145994e-11, 8.08013256e-11, 6.97432945e-11, 2.94077923e-10, 4.21963201e-10, 1.56535212e-10, 3.19956915e-10, 4.49405595e-10, 4.05074493e-10, 5.12591939e-07, 9.27699639e-07, 1.59019290e-07, 4.11573485e-09, 5.12540382e-09, 5.22241028e-09,
                5.33252585e-09, 5.44184253e-09, 2.55776440e-09, 2.27999054e-09, 1.87927491e-09, 5.24213362e-09, 8.65066672e-09, 5.65659482e-09, 2.54216024e-09, 7.57055587e-09, 7.01964447e-09, 3.28714953e-09, 2.00643734e-09, 1.55873337e-09, 1.26865851e-09, 1.05515776e-09,
                8.31249281e-10, 5.95317101e-10, 5.52602997e-10, 9.34522865e-10, 1.57516098e-09, 1.99843452e-09, 3.21472746e-09, 5.58694749e-09, 8.82186053e-09, 1.37383998e-08, 1.39406475e-08, 2.79470684e-08, 3.95675248e-08, 3.99189030e-08, 4.35532596e-08, 4.55864075e-08,
                4.47950112e-08, 3.92985901e-08, 2.68134526e-08, 1.75922814e-08, 1.31161238e-08, 5.53242837e-09, 4.46063567e-10, 7.05664840e-15, 2.97004007e-18, 2.96653195e-18, 2.95251531e-18, 2.90785760e-18, 2.88242731e-18, 2.85699702e-18, 2.83022829e-18, 2.80345956e-18,
                2.79386460e-18, 2.76886700e-18, 2.70615790e-18, 2.70615790e-18, 2.67938914e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18, 2.65461204e-18,
                2.65461204e-18, 2.64571154e-18, 2.60306617e-18, 2.60305726e-18, 2.60304834e-18, 2.60303915e-18, 2.60302940e-18, 2.60301964e-18, 2.60300961e-18, 2.60299930e-18, 2.60298872e-18, 2.60297785e-18, 2.60296670e-18, 2.60295500e-18, 2.60294330e-18, 2.60293104e-18,
                2.60291850e-18, 2.60290541e-18, 2.60289203e-18, 2.60287810e-18, 2.60286417e-18, 2.60285024e-18, 2.60283631e-18, 2.60282238e-18, 2.60280844e-18, 2.60279451e-18, 2.60278058e-18, 2.60276665e-18, 2.60275272e-18, 2.60273879e-18, 2.60272486e-18, 2.60271093e-18,
                2.60269699e-18, 2.60268306e-18, 2.60266913e-18, 2.60265520e-18, 2.60264127e-18, 2.60262734e-18, 2.60261341e-18, 2.60259947e-18, 2.60258554e-18, 2.60257161e-18, 2.60255768e-18, 2.60254375e-18, 2.60252982e-18, 2.60251589e-18, 2.60250196e-18, 2.60248802e-18,
                2.60247409e-18, 2.60246016e-18, 2.60244623e-18, 2.60243230e-18, 2.60241837e-18, 2.60240444e-18, 2.60239050e-18, 2.60237657e-18, 2.60236264e-18, 2.60234871e-18, 2.60233478e-18, 2.60232085e-18, 2.60230692e-18, 2.60229299e-18, 2.60227905e-18, 2.60226512e-18,
                2.60225119e-18, 2.60223726e-18, 2.60222333e-18, 2.60220940e-18, 2.60219547e-18, 2.60218154e-18, 2.60216760e-18, 2.60215367e-18, 2.60213974e-18, 2.60212581e-18, 2.60211188e-18, 2.60209795e-18, 2.60208402e-18, 2.60207008e-18, 2.60205615e-18, 2.60204222e-18,
                2.60202829e-18, 2.60201436e-18, 2.60200043e-18, 2.60198650e-18, 2.60197257e-18, 2.60195863e-18, 2.60193774e-18, 2.60190987e-18, 2.60188201e-18, 2.60185415e-18, 2.60182629e-18, 2.60179842e-18, 2.60177056e-18, 2.60174270e-18, 2.60171484e-18, 2.60168697e-18,
                2.60165911e-18, 2.60163125e-18, 2.60160339e-18, 2.60157552e-18, 2.60154766e-18, 2.60151980e-18, 2.60149194e-18, 2.60146407e-18, 2.60143621e-18, 2.60140835e-18, 2.60138048e-18, 2.60135262e-18, 2.60132476e-18, 2.60129690e-18, 2.60126903e-18, 2.60124117e-18,
                2.60121331e-18, 2.60118545e-18, 2.60115758e-18, 2.60112972e-18, 2.60110186e-18, 2.60107400e-18, 2.60104613e-18, 2.60101827e-18, 2.60099041e-18, 2.60093468e-18, 2.60076751e-18, 2.60062819e-18, 2.60048888e-18, 2.60034957e-18, 2.60021025e-18, 2.60007094e-18,
                2.59993163e-18, 2.59979231e-18, 2.59965300e-18, 2.59951369e-18, 2.59937438e-18, 2.59923506e-18, 2.59909575e-18, 2.59895644e-18, 2.59881712e-18, 2.59867781e-18, 2.59853850e-18, 2.59839918e-18, 2.59825987e-18, 2.59808573e-18, 2.59777227e-18, 2.59749365e-18,
                2.59721502e-18, 2.59693640e-18, 2.59665777e-18, 2.59637914e-18, 2.59610052e-18, 2.59582189e-18, 2.59554326e-18, 2.59526464e-18, 2.59498601e-18, 2.59470738e-18, 2.59442876e-18, 2.59415013e-18, 2.59387151e-18, 2.59359288e-18, 2.59331425e-18, 2.59303563e-18,
                2.59275700e-18, 2.59247837e-18, 2.59219975e-18, 2.59192112e-18, 2.59164250e-18, 2.59136387e-18, 2.59108524e-18, 2.59080662e-18, 2.59052799e-18, 2.59024936e-18, 2.58997074e-18, 2.58906520e-18, 2.58565203e-18, 2.58286577e-18, 2.58007950e-18, 2.57729324e-18)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_water, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_water_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "OH"
        if wvl_range == (1.0, 95000.0)
            flux_quiet =  (0.00000000e+00, 2.30878048e-14, 4.65592554e-12, 8.27441142e-11,
                7.28626258e-10, 2.05628015e-08, 1.20814948e-06, 3.40872351e-06, 5.81255861e-06, 6.74884823e-06, 1.04591889e-05, 1.01498322e-05, 6.60168362e-06, 3.33127144e-06, 1.78337409e-06, 4.93979662e-05, 1.79383097e-04, 8.68208503e-04, 3.90887744e-04, 8.45750206e-04,
                1.70581165e-04, 6.07426675e-04, 2.48293560e-03, 5.28829506e-04, 2.18976662e-04, 6.77718158e-04, 9.42889186e-05, 1.59747891e-04, 1.10605115e-04, 1.42247464e-04, 3.03136951e-04, 4.62897785e-04, 1.84684842e-04, 2.87387385e-04, 4.26326008e-05, 8.72449251e-04,
                4.89110476e-04, 1.04323852e-03, 9.67501582e-05, 2.37641426e-04, 9.80756545e-05, 2.76444766e-04, 5.74041261e-04, 2.93982510e-04, 2.94117027e-04, 7.30827532e-04, 3.73255600e-04, 4.96052812e-06, 6.45232382e-06, 4.65390792e-06, 1.93939438e-05, 5.96236718e-06,
                8.52916171e-06, 5.65467001e-04, 9.93176883e-05, 2.10492098e-05, 2.05930960e-05, 8.01688518e-04, 6.08535050e-04, 4.88823277e-04, 4.58121701e-05, 5.46404007e-05, 4.63083760e-05, 2.72667614e-04, 5.27747237e-05, 5.60078976e-05, 5.92410715e-05, 2.96156537e-04,
                6.57074192e-05, 6.89405931e-05, 5.04114479e-05, 4.45485490e-05, 6.00520609e-05, 1.59681454e-04, 6.88928407e-05, 7.84165027e-05, 1.18239513e-04, 1.26103363e-04, 4.93604096e-04, 2.01443834e-01, 7.01762724e-03, 2.49272766e-03, 2.80508913e-03, 2.19518555e-03,
                2.21711609e-03, 4.60847935e-03, 1.47470333e-03, 1.78186715e-03, 1.23423708e-03, 1.27616132e-03, 7.41771041e-03, 2.03922834e-03, 1.31175127e-03, 1.62303327e-03, 7.84278944e-04, 1.05581807e-03, 1.32449966e-03, 8.53601525e-04, 8.65316001e-04, 9.33441121e-04,
                2.16431377e-03, 2.64049363e-03, 3.22386977e-03, 4.25648314e-03, 2.92274706e-03, 3.40243368e-03, 5.49561887e-03, 6.26552330e-03, 7.50064317e-03, 1.18458440e-02, 1.22068881e-02, 3.08928836e-02, 5.27518314e-02, 7.75733135e-02, 3.75035547e-02, 4.06632533e-02,
                2.46514156e-02, 3.75128509e-02, 2.94888536e-02, 2.12589537e-02, 2.88443736e-02, 3.73052822e-02, 4.58934901e-02, 1.74663228e-03, 1.87307963e-03, 1.99225546e-03, 2.60631108e-03, 3.22884261e-03, 2.46317832e-03, 2.80222208e-03, 3.20562261e-03, 3.81072341e-03,
                4.16531937e-03, 4.62571325e-03, 9.02729343e-03, 1.17734253e-02, 1.41048612e-02, 1.18569589e-02, 1.53278399e-02, 1.39866910e-02, 1.79757692e-02, 1.40681178e-02, 1.44546399e-02, 1.42969415e-02, 1.00907381e-02, 6.65759420e-03, 3.44675553e-03, 7.40935678e-07,
                7.93098649e-07, 1.78664446e-02, 7.83985059e-07, 9.18324848e-07, 1.44763572e-06, 7.59807721e-07, 1.60088346e-06, 1.77038084e-06, 1.62019130e-06, 1.63813554e-06, 1.87115335e-06, 2.26896934e-06, 3.22979147e-06, 5.03127553e-06, 5.05619957e-06, 4.79904923e-06,
                6.19146313e-06, 7.06385460e-06, 7.06096285e-06, 7.91087609e-06, 9.03504346e-06, 1.05400542e-05, 9.49276141e-06, 9.73333153e-06, 1.01390632e-05, 1.00596190e-05, 9.77940122e-06, 9.59140853e-06, 1.05615335e-05, 1.06744271e-05, 1.04238615e-05, 9.51711211e-06,
                8.72707282e-06, 8.27328713e-06, 8.70855756e-06, 1.08509316e-05, 1.28706065e-05, 1.29388752e-05, 1.23974836e-05, 1.20348270e-05, 1.14284159e-05, 1.05026226e-05, 1.01805005e-05, 1.09566243e-05, 1.09881558e-05, 1.07272366e-05, 1.00930720e-05, 9.37783844e-06,
                8.77332595e-06, 8.25504945e-06, 7.73921952e-06, 6.97528990e-06, 5.95592085e-06, 5.24368187e-06, 4.74879447e-06, 3.98024568e-06, 3.31887540e-06, 2.65206400e-06, 1.91670992e-06, 1.25561363e-06, 6.16536500e-07, 1.40124906e-15, 1.43358817e-15, 1.44962804e-15,
                1.46566228e-15, 1.45455368e-15, 1.44344884e-15, 1.44319888e-15, 1.44837354e-15, 1.44812264e-15, 1.45871722e-15, 1.46930805e-15, 1.46905339e-15, 1.46879873e-15, 1.47396305e-15, 1.47370745e-15, 1.46803475e-15, 1.46236393e-15, 1.46211021e-15, 1.46185649e-15,
                1.45618943e-15, 1.45052425e-15, 1.44486094e-15, 1.43919952e-15, 1.43353997e-15, 2.13641481e-15, 2.82257695e-15, 2.79997448e-15, 2.77738704e-15, 2.74941305e-15, 2.72145784e-15, 2.69352143e-15, 2.66560381e-15, 2.64309907e-15, 2.60443276e-15, 2.58735404e-15,
                2.51640219e-15, 2.47243201e-15, 2.52003151e-15, 2.44379271e-15, 2.47522500e-15, 2.43670717e-15, 2.37132981e-15, 2.33287400e-15, 2.31593812e-15, 2.16472534e-15, 2.32505737e-15, 2.28130144e-15, 2.29123448e-15, 2.26897593e-15, 2.21455965e-15, 2.14946045e-15,
                2.08440636e-15, 2.07831878e-15, 2.02404345e-15, 2.01262757e-15, 1.99051750e-15, 1.98981836e-15, 2.02654888e-15, 2.02583659e-15, 4.00215857e-15, 1.12665076e-14, 8.95154511e-15, 8.51024584e-15, 7.96425996e-15, 7.84416225e-15, 7.56571905e-15, 6.97133661e-15,
                6.58989825e-15, 6.10452505e-15, 5.88349953e-15, 5.61078850e-15, 5.20815891e-15, 5.07863541e-15, 4.79829362e-15, 4.28985897e-15, 4.00149174e-15, 3.60001779e-15, 3.37084447e-15, 3.19933337e-15, 3.84872924e-15, 5.71362312e-15, 4.24454738e-15, 3.74377619e-15,
                3.47556633e-15, 3.07741891e-15, 2.77809888e-15, 2.49601824e-15, 2.26108887e-15, 2.04283508e-15, 1.86099138e-15, 1.68542038e-15, 1.57038727e-15, 1.41190532e-15, 1.32319891e-15, 1.20583984e-15, 1.12338734e-15, 1.03669189e-15, 9.69937686e-16, 8.98865356e-16,
                8.18743313e-16, 7.63068571e-16, 7.03056913e-16, 6.67154265e-16, 6.26801936e-16, 5.86750311e-16, 5.42324182e-16, 4.93579932e-16, 4.48457896e-16, 4.27241443e-16, 1.30640920e-15, 3.05925353e-15, 1.45887642e-15, 9.66777806e-16, 6.92421942e-16, 1.97274931e-15)


            flux_active = (0.00000000e+00, 1.01156619e-13, 2.03994139e-11, 3.62534027e-10,
                3.19239398e-09, 9.00936014e-08, 5.29337103e-06, 1.49349386e-05, 9.94609787e-06, 1.08732976e-05, 1.67854299e-05, 1.61267180e-05, 1.05596409e-05, 5.36404541e-06, 3.00847298e-06, 9.25149590e-05, 5.56455310e-04, 3.17069985e-03, 9.21017070e-04, 2.94461254e-03,
                3.19750100e-04, 9.31692994e-04, 4.78956013e-03, 9.37803962e-04, 3.29415890e-04, 1.33422403e-03, 1.39780821e-04, 2.52093199e-04, 1.82582305e-04, 2.34816174e-04, 4.96962660e-04, 7.23257753e-04, 2.84004562e-04, 4.04289208e-04, 5.71253860e-05, 1.12944551e-03,
                6.24126175e-04, 1.37135810e-03, 1.29071452e-04, 3.22729617e-04, 1.46168988e-04, 3.75146424e-04, 9.71688260e-04, 5.02150267e-04, 4.90245166e-04, 1.21144632e-03, 6.18722070e-04, 8.22275198e-06, 1.06956068e-05, 6.29987565e-06, 2.62184087e-05, 8.04978278e-06,
                1.14999586e-05, 9.09354176e-04, 1.60659416e-04, 3.40915231e-05, 3.33854016e-05, 1.30075030e-03, 7.51140986e-04, 5.78299155e-04, 5.41977857e-05, 6.46419657e-05, 5.47848188e-05, 3.45083038e-04, 6.67907044e-05, 7.08825488e-05, 7.49743933e-05, 3.74810180e-04,
                8.58492581e-05, 9.02862625e-05, 6.53880346e-05, 5.73923882e-05, 7.69140073e-05, 2.03116861e-04, 8.78544190e-05, 1.16448083e-04, 1.88276990e-04, 1.97464569e-04, 7.61511971e-04, 3.06118617e-01, 1.04785918e-02, 3.68244059e-03, 4.13092144e-03, 3.22386935e-03,
                3.24583131e-03, 6.72546232e-03, 2.14531856e-03, 2.49692801e-03, 1.58616568e-03, 1.63676124e-03, 9.49223675e-03, 2.61933041e-03, 1.69361492e-03, 2.24294497e-03, 1.09982550e-03, 1.44927348e-03, 1.77876252e-03, 1.15268644e-03, 1.17880815e-03, 1.23490300e-03,
                2.67988633e-03, 3.00633260e-03, 3.69181314e-03, 4.90380793e-03, 3.38749266e-03, 3.61911450e-03, 5.71486629e-03, 6.40809577e-03, 7.58505550e-03, 1.16349399e-02, 1.16804560e-02, 2.83084928e-02, 4.67375173e-02, 6.43602480e-02, 3.07368411e-02, 3.31140397e-02,
                1.99460675e-02, 3.01435644e-02, 2.35315566e-02, 1.69444797e-02, 2.29664452e-02, 2.96701976e-02, 3.64601204e-02, 1.38606903e-03, 1.48465979e-03, 1.57725697e-03, 2.05365178e-03, 2.50569616e-03, 1.89479667e-03, 2.13658776e-03, 2.42126463e-03, 2.85108470e-03,
                3.10571828e-03, 3.41813490e-03, 6.51957207e-03, 8.50284701e-03, 1.00858617e-02, 8.40006745e-03, 1.08590145e-02, 9.90887703e-03, 1.27349411e-02, 9.96656382e-03, 1.02403956e-02, 1.01286741e-02, 7.14878759e-03, 4.71657535e-03, 2.44185537e-03, 5.24916186e-07,
                5.61871064e-07, 1.26150515e-02, 5.44629789e-07, 6.37952662e-07, 1.00565710e-06, 5.27828455e-07, 1.11210857e-06, 1.22985113e-06, 1.12551287e-06, 1.13797385e-06, 1.29984050e-06, 1.57618611e-06, 2.24363132e-06, 3.49504812e-06, 3.51234617e-06, 3.33369808e-06,
                4.30092886e-06, 4.90691499e-06, 4.90488103e-06, 5.49524182e-06, 6.27610424e-06, 7.32150601e-06, 6.59398293e-06, 6.76105463e-06, 7.04284995e-06, 6.98762857e-06, 6.79294690e-06, 6.66232816e-06, 7.33615142e-06, 7.41452882e-06, 7.24044553e-06, 6.61057927e-06,
                6.06178610e-06, 5.74655782e-06, 6.04886073e-06, 7.53688800e-06, 8.93967482e-06, 8.98704484e-06, 8.61096059e-06, 8.35902430e-06, 7.93778714e-06, 7.29472368e-06, 7.07095200e-06, 7.60997461e-06, 7.63183408e-06, 7.45057254e-06, 7.01007770e-06, 6.51328203e-06,
                6.09339143e-06, 5.73339900e-06, 5.37510965e-06, 4.84451271e-06, 4.13651335e-06, 3.64182878e-06, 3.29810317e-06, 2.76432065e-06, 2.30498000e-06, 1.84186540e-06, 1.33115294e-06, 8.72017619e-07, 4.28179338e-07, 9.73150306e-16, 9.95604090e-16, 1.00673814e-15,
                1.01786815e-15, 1.01014808e-15, 1.00243070e-15, 1.00225175e-15, 1.00583999e-15, 1.00566036e-15, 1.01301243e-15, 1.02036181e-15, 1.02017950e-15, 1.01999719e-15, 1.02357804e-15, 1.02339506e-15, 1.01945028e-15, 1.01550684e-15, 1.01532522e-15, 1.01514359e-15,
                1.01120285e-15, 1.00726346e-15, 1.00332541e-15, 9.99388713e-16, 9.95453361e-16, 1.48352328e-15, 1.95997751e-15, 1.94426170e-15, 1.92855665e-15, 1.90911168e-15, 1.88968017e-15, 1.87026212e-15, 1.85085754e-15, 1.83521176e-15, 1.80834479e-15, 1.79646723e-15,
                1.74718480e-15, 1.71663711e-15, 1.74966723e-15, 1.69671617e-15, 1.71852109e-15, 1.69176047e-15, 1.64635256e-15, 1.61963634e-15, 1.60786110e-15, 1.50286416e-15, 1.61415765e-15, 1.58376339e-15, 1.59064223e-15, 1.57517282e-15, 1.53737938e-15, 1.49217059e-15,
                1.44699408e-15, 1.44275263e-15, 1.40506007e-15, 1.39712037e-15, 1.38175726e-15, 1.38125715e-15, 1.40673903e-15, 1.40622952e-15, 2.77805884e-15, 7.82036743e-15, 6.21309412e-15, 5.90648044e-15, 5.52724640e-15, 5.44360620e-15, 5.25009393e-15, 4.83737380e-15,
                4.57245072e-15, 4.23544389e-15, 4.08187314e-15, 3.89246220e-15, 3.61294589e-15, 3.52290548e-15, 3.32826192e-15, 2.97543462e-15, 2.77527512e-15, 2.49669494e-15, 2.33763267e-15, 2.21857321e-15, 2.66875277e-15, 3.96162593e-15, 2.94266525e-15, 2.59521157e-15,
                2.40902820e-15, 2.13283043e-15, 1.92517765e-15, 1.72951473e-15, 1.56656181e-15, 1.41519601e-15, 1.28908345e-15, 1.16734247e-15, 1.08755238e-15, 9.77692671e-16, 9.16168345e-16, 8.34820555e-16, 7.77653949e-16, 7.17562783e-16, 6.71285673e-16, 6.22030276e-16,
                5.66523564e-16, 5.27943085e-16, 4.86370633e-16, 4.61483784e-16, 4.33524673e-16, 4.05779521e-16, 3.75015371e-16, 3.41272181e-16, 3.10040452e-16, 2.95340732e-16, 9.02989051e-16, 2.11381441e-15, 1.00669284e-15, 6.66402941e-16, 4.76773719e-16, 1.35688841e-15)

        else

            solar_flux_hydroxyde = (0.00000000e+00, 5.19190654e-19, 1.04700860e-16, 1.86072133e-15,
                1.63850980e-14, 4.62409244e-13, 2.71684521e-11, 7.66542079e-11, 1.30710829e-10, 1.51765790e-10, 2.35202661e-10, 2.28245953e-10, 1.48456402e-10, 7.49124921e-11, 4.01039062e-11, 1.11084456e-09, 4.03390570e-09, 1.95239757e-08, 8.79014983e-09, 1.90189412e-08,
                3.83597087e-09, 1.36596032e-08, 5.58354061e-08, 1.18921370e-08, 4.92427225e-09, 1.52402940e-08, 2.12033694e-09, 3.59235590e-09, 2.48724997e-09, 3.19881230e-09, 6.81684001e-09, 1.04094870e-08, 4.15312952e-09, 6.46266917e-09, 9.58707339e-10, 1.96193402e-08,
                1.09989490e-08, 2.34599909e-08, 2.17568445e-09, 5.34399907e-09, 2.20549176e-09, 6.21659531e-09, 1.29088434e-08, 6.61097809e-09, 6.61400306e-09, 1.64345994e-08, 8.39364421e-09, 1.11550659e-10, 1.45097650e-10, 1.04655489e-10, 4.36124371e-10, 1.34079673e-10,
                1.91800870e-10, 1.27160284e-08, 2.23342219e-09, 4.73347427e-10, 4.63090496e-10, 1.80280971e-08, 1.36845280e-08, 1.09924906e-08, 1.03020840e-09, 1.22873463e-09, 1.04136691e-09, 6.13165600e-09, 1.18677993e-09, 1.25948644e-09, 1.33219294e-09, 6.65986686e-09,
                1.47760596e-09, 1.55031247e-09, 1.13363539e-09, 1.00179252e-09, 1.35043020e-09, 3.59086190e-09, 1.54923863e-09, 1.76340348e-09, 2.65892970e-09, 2.83576927e-09, 1.11000000e-08, 4.53000000e-06, 1.57810000e-07, 5.60556066e-08, 6.30798844e-08, 4.93645815e-08,
                4.98577479e-08, 1.03633906e-07, 3.31626238e-08, 4.00700186e-08, 2.77551011e-08, 2.86978790e-08, 1.66806933e-07, 4.58574691e-08, 2.94982136e-08, 3.64982168e-08, 1.76365965e-08, 2.37428754e-08, 2.97848951e-08, 1.91954990e-08, 1.94589301e-08, 2.09909045e-08,
                4.86703474e-08, 5.93785171e-08, 7.24972801e-08, 9.57183363e-08, 6.57257357e-08, 7.65127642e-08, 1.23583597e-07, 1.40896944e-07, 1.68671897e-07, 2.66385286e-07, 2.74504322e-07, 6.94708595e-07, 1.18626513e-06, 1.74444213e-06, 8.43367104e-07, 9.14421325e-07,
                5.54352598e-07, 8.43576155e-07, 6.63135249e-07, 4.78064075e-07, 6.48642403e-07, 8.38908421e-07, 1.03203710e-06, 3.92776691e-08, 4.21211737e-08, 4.48011591e-08, 5.86098317e-08, 7.26091077e-08, 5.53911111e-08, 6.30154113e-08, 7.20869443e-08, 8.56942439e-08,
                9.36682767e-08, 1.04021457e-07, 2.03002685e-07, 2.64756760e-07, 3.17185293e-07, 2.66635235e-07, 3.44687219e-07, 3.14527922e-07, 4.04232946e-07, 3.16359018e-07, 3.25050996e-07, 3.21504728e-07, 2.26917066e-07, 1.49713700e-07, 7.75094589e-08, 1.66619080e-11,
                1.78349310e-11, 4.01774493e-07, 1.76299877e-11, 2.06509749e-11, 3.25539368e-11, 1.70862960e-11, 3.60001193e-11, 3.98117185e-11, 3.64343075e-11, 3.68378314e-11, 4.20778562e-11, 5.10238061e-11, 7.26304453e-11, 1.13141602e-10, 1.13702086e-10, 1.07919377e-10,
                1.39231504e-10, 1.58849545e-10, 1.58784516e-10, 1.77897074e-10, 2.03176965e-10, 2.37021133e-10, 2.13469970e-10, 2.18879829e-10, 2.28003784e-10, 2.26217269e-10, 2.19915828e-10, 2.15688313e-10, 2.37504151e-10, 2.40042864e-10, 2.34408231e-10, 2.14017560e-10,
                1.96251427e-10, 1.86046850e-10, 1.95835062e-10, 2.44012038e-10, 2.89429795e-10, 2.90964998e-10, 2.78790368e-10, 2.70635072e-10, 2.56998307e-10, 2.36179383e-10, 2.28935611e-10, 2.46388819e-10, 2.47097887e-10, 2.41230426e-10, 2.26969548e-10, 2.10885622e-10,
                1.97291552e-10, 1.85636727e-10, 1.74036920e-10, 1.56857932e-10, 1.33934710e-10, 1.17918124e-10, 1.06789265e-10, 8.95064028e-11, 7.46337344e-11, 5.96387078e-11, 4.31023168e-11, 2.82358096e-11, 1.38644618e-11, 3.15108094e-20, 3.22380402e-20, 3.25987394e-20,
                3.29593118e-20, 3.27095055e-20, 3.24597837e-20, 3.24541626e-20, 3.25705286e-20, 3.25648865e-20, 3.28031338e-20, 3.30412966e-20, 3.30355699e-20, 3.30298432e-20, 3.31459767e-20, 3.31402289e-20, 3.30126631e-20, 3.28851396e-20, 3.28794341e-20, 3.28737285e-20,
                3.27462896e-20, 3.26188929e-20, 3.24915384e-20, 3.23642262e-20, 3.22369563e-20, 4.80429652e-20, 6.34731447e-20, 6.29648680e-20, 6.24569294e-20, 6.18278597e-20, 6.11992126e-20, 6.05709882e-20, 5.99431863e-20, 5.94371074e-20, 5.85675926e-20, 5.81835324e-20,
                5.65879914e-20, 5.55992051e-20, 5.66696063e-20, 5.49551741e-20, 5.56620128e-20, 5.47958369e-20, 5.33256534e-20, 5.24608722e-20, 5.20800239e-20, 4.86796028e-20, 5.22850945e-20, 5.13011262e-20, 5.15244968e-20, 5.10239543e-20, 4.98002595e-20, 4.83363310e-20,
                4.68734168e-20, 4.67365214e-20, 4.55159964e-20, 4.52592800e-20, 4.47620763e-20, 4.47463543e-20, 4.55723378e-20, 4.55563200e-20, 8.99991724e-20, 2.53357368e-19, 2.01299283e-19, 1.91375496e-19, 1.79097553e-19, 1.76396836e-19, 1.70135301e-19, 1.56769032e-19,
                1.48191377e-19, 1.37276470e-19, 1.32306124e-19, 1.26173492e-19, 1.17119295e-19, 1.14206615e-19, 1.07902385e-19, 9.64688806e-20, 8.99841770e-20, 8.09559680e-20, 7.58023970e-20, 7.19455141e-20, 8.65489062e-20, 1.28486002e-19, 9.54499289e-20, 8.41887578e-20,
                7.81573462e-20, 6.92039434e-20, 6.24729369e-20, 5.61296041e-20, 5.08465928e-20, 4.59385763e-20, 4.18493374e-20, 3.79011568e-20, 3.53143315e-20, 3.17504437e-20, 2.97556443e-20, 2.71165138e-20, 2.52623501e-20, 2.33127726e-20, 2.18116268e-20, 2.02133765e-20,
                1.84116194e-20, 1.71596249e-20, 1.58101033e-20, 1.50027368e-20, 1.40953074e-20, 1.31946402e-20, 1.21956006e-20, 1.10994566e-20, 1.00847677e-20, 9.60765937e-21, 2.93780830e-20, 6.87954465e-20, 3.28067137e-20, 2.17405685e-20, 1.55709477e-20, 4.43625113e-20)

            solar_flux_hydroxyde_active = (0.00000000e+00, 3.30724447e-18, 6.66944480e-16, 1.18527948e-14,
                1.04373074e-13, 2.94554688e-12, 1.73063040e-10, 4.88287304e-10, 3.25180669e-10, 3.55494813e-10, 5.48787817e-10, 5.27251694e-10, 3.45240028e-10, 1.75373689e-10, 9.83599065e-11, 3.02471146e-09, 1.81929147e-08, 1.03663800e-07, 3.01120048e-08, 9.62720345e-08,
                1.04540044e-08, 3.04610466e-08, 1.56591297e-07, 3.06608404e-08, 1.07700206e-08, 4.36215154e-08, 4.57003555e-09, 8.24200969e-09, 5.96939994e-09, 7.67714951e-09, 1.62478444e-08, 2.36464031e-08, 9.28532924e-09, 1.32179511e-08, 1.86767428e-09, 3.69264259e-08,
                2.04053660e-08, 4.48355878e-08, 4.21990026e-09, 1.05514176e-08, 4.77889216e-09, 1.22651483e-08, 3.17686637e-08, 1.64174495e-08, 1.60282206e-08, 3.96073847e-08, 2.02286826e-08, 2.68837088e-10, 3.49685337e-10, 2.05970000e-10, 8.57192419e-10, 2.63181982e-10,
                3.75983052e-10, 2.97306947e-08, 5.25264653e-09, 1.11459835e-09, 1.09151220e-09, 4.25271155e-08, 2.45580258e-08, 1.89070838e-08, 1.77195845e-09, 2.11342357e-09, 1.79115109e-09, 1.12822470e-08, 2.18367507e-09, 2.31745504e-09, 2.45123501e-09, 1.22541550e-08,
                2.80678107e-09, 2.95184580e-09, 2.13781577e-09, 1.87640373e-09, 2.51464933e-09, 6.64076279e-09, 2.87233839e-09, 3.80718811e-09, 6.15558365e-09, 6.45596510e-09, 2.48970979e-08, 1.00083327e-05, 3.42590184e-07, 1.20394803e-07, 1.35057569e-07, 1.05402139e-07,
                1.06120170e-07, 2.19884257e-07, 7.01396804e-08, 8.16353038e-08, 5.18585703e-08, 5.35127565e-08, 3.10341999e-07, 8.56371639e-08, 5.53715476e-08, 7.33315069e-08, 3.59580207e-08, 4.73829764e-08, 5.81553886e-08, 3.76862718e-08, 3.85403026e-08, 4.03742845e-08,
                8.76169971e-08, 9.82899282e-08, 1.20701232e-07, 1.60326548e-07, 1.10751688e-07, 1.18324401e-07, 1.86843531e-07, 2.09508180e-07, 2.47988051e-07, 3.80396171e-07, 3.81884287e-07, 9.25526247e-07, 1.52805023e-06, 2.10421300e-06, 1.00491938e-06, 1.08264022e-06,
                6.52122636e-07, 9.85522620e-07, 7.69347680e-07, 5.53987837e-07, 7.50871761e-07, 9.70046225e-07, 1.19203797e-06, 4.53165513e-08, 4.85399067e-08, 5.15673063e-08, 6.71426993e-08, 8.19219723e-08, 6.19490435e-08, 6.98542328e-08, 7.91615427e-08, 9.32142075e-08,
                1.01539273e-07, 1.11753515e-07, 2.13152820e-07, 2.77994598e-07, 3.29750149e-07, 2.74634292e-07, 3.55027835e-07, 3.23963760e-07, 4.16359934e-07, 3.25849789e-07, 3.34802526e-07, 3.31149870e-07, 2.33724578e-07, 1.54205111e-07, 7.98347427e-08, 1.71617652e-11,
                1.83699789e-11, 4.12440228e-07, 1.78062876e-11, 2.08574132e-11, 3.28792509e-11, 1.72569798e-11, 3.63596068e-11, 4.02091170e-11, 3.67978509e-11, 3.72052539e-11, 4.24973701e-11, 5.15322956e-11, 7.33539466e-11, 1.14268138e-10, 1.14833686e-10, 1.08992912e-10, 
                1.40615842e-10, 1.60428132e-10, 1.60361633e-10, 1.79663063e-10, 2.05192810e-10, 2.39371485e-10, 2.15585631e-10, 2.21047922e-10, 2.30261022e-10, 2.28455598e-10, 2.22090617e-10, 2.17820129e-10, 2.39850307e-10, 2.42412801e-10, 2.36721270e-10, 2.16128236e-10, 
                1.98185830e-10, 1.87879663e-10, 1.97763244e-10, 2.46413248e-10, 2.92276376e-10, 2.93825105e-10, 2.81529295e-10, 2.73292416e-10, 2.59520363e-10, 2.38495856e-10, 2.31179798e-10, 2.48802763e-10, 2.49517443e-10, 2.43591225e-10, 2.29189556e-10, 2.12947171e-10, 
                1.99219144e-10, 1.87449445e-10, 1.75735427e-10, 1.58387933e-10, 1.35240392e-10, 1.19067029e-10, 1.07829162e-10, 9.03775179e-11, 7.53596987e-11, 6.02184927e-11, 4.35211082e-11, 2.85100023e-11, 1.39990221e-11, 3.18164643e-20, 3.25505749e-20, 3.29145947e-20, 
                3.32784827e-20, 3.30260804e-20, 3.27737663e-20, 3.27679154e-20, 3.28852303e-20, 3.28793576e-20, 3.31197283e-20, 3.33600111e-20, 3.33540506e-20, 3.33480902e-20, 3.34651635e-20, 3.34591812e-20, 3.33302093e-20, 3.32012814e-20, 3.31953432e-20, 3.31894052e-20, 
                3.30605654e-20, 3.29317697e-20, 3.28030181e-20, 3.26743105e-20, 3.25456470e-20, 4.85027494e-20, 6.40800852e-20, 6.35662676e-20, 6.30528023e-20, 6.24170625e-20, 6.17817630e-20, 6.11469037e-20, 6.05124846e-20, 6.00009567e-20, 5.91225602e-20, 5.87342316e-20, 
                5.71229773e-20, 5.61242419e-20, 5.72041385e-20, 5.54729410e-20, 5.61858375e-20, 5.53109178e-20, 5.38263381e-20, 5.29528701e-20, 5.25678870e-20, 4.91350860e-20, 5.27737482e-20, 5.17800291e-20, 5.20049279e-20, 5.14991666e-20, 5.02635365e-20, 4.87854670e-20, 
                4.73084528e-20, 4.71697816e-20, 4.59374499e-20, 4.56778671e-20, 4.51755811e-20, 4.51592302e-20, 4.59923423e-20, 4.59756844e-20, 9.08266783e-20, 2.55681408e-19, 2.03132739e-19, 1.93108220e-19, 1.80709431e-19, 1.77974873e-19, 1.71648126e-19, 1.58154531e-19, 
                1.49493058e-19, 1.38474857e-19, 1.33453969e-19, 1.27261312e-19, 1.18122723e-19, 1.15178915e-19, 1.08815181e-19, 9.72797407e-20, 9.07356665e-20, 8.16276838e-20, 7.64272546e-20, 7.25346895e-20, 8.72529932e-20, 1.29522571e-19, 9.62083689e-20, 8.48486157e-20, 
                7.87614814e-20, 6.97313897e-20, 6.29423281e-20, 5.65452666e-20, 5.12176355e-20, 4.62688374e-20, 4.21456759e-20, 3.81654405e-20, 3.55567597e-20, 3.19649737e-20, 2.99534791e-20, 2.72938704e-20, 2.54248485e-20, 2.34602101e-20, 2.19472126e-20, 2.03368420e-20, 
                1.85220892e-20, 1.72607276e-20, 1.59015455e-20, 1.50878875e-20, 1.41737840e-20, 1.32666758e-20, 1.22608636e-20, 1.11576538e-20, 1.01365543e-20, 9.65595733e-21, 2.95225914e-20, 6.91096744e-20, 3.29131138e-20, 2.17875751e-20, 1.55877811e-20, 4.43625113e-20)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_hydroxyde, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_hydroxyde_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "H2"
        if wvl_range == (1.0, 95000.0)
            flux_quiet = (0.00000000e+00, 2.69662313e-17, 6.60110870e-15, 1.22696352e-13,
                1.10224470e-12, 3.14606032e-11, 5.44683883e-07, 1.28230048e-06, 4.16628273e-06, 6.15223331e-06, 1.08539081e-05, 1.14294686e-05, 7.86515079e-06, 6.07442449e-06, 4.14605806e-06, 1.31250827e-04, 6.15462094e-04, 3.40274513e-03, 2.16059075e-03, 7.15576710e-03,
                2.11947523e-03, 8.20902250e-03, 4.01901749e-02, 9.60110193e-03, 4.53001084e-03, 1.63812354e-02, 2.43415883e-03, 4.75143508e-03, 3.63111632e-03, 5.10215106e-03, 1.08411020e-02, 1.65100751e-02, 7.32796099e-03, 1.24666011e-02, 2.02459887e-03, 4.53369763e-02,
                2.79100494e-02, 6.77526561e-02, 6.83214750e-03, 2.31395545e-02, 1.19026417e-02, 4.60684354e-02, 7.69436466e-02, 4.22016794e-02, 1.30743724e-01, 2.61937611e-19, 2.03089055e-01, 1.19871696e-02, 3.65766590e-02, 1.09877055e-01, 4.17133890e-20, 7.30335431e-21,
                7.30335431e-21, 3.72190171e-19, 5.30897678e-20, 8.77807008e-21, 7.30335431e-21, 2.52808418e-19, 1.72752419e-19, 1.28510946e-19, 1.10252560e-20, 1.19381753e-20, 9.19941744e-21, 5.06319082e-20, 9.19941744e-21, 9.19941744e-21, 9.19941744e-21, 4.36094522e-20,
                9.19941744e-21, 9.19941744e-21, 6.42554730e-21, 5.50560555e-21, 7.23312975e-21, 1.86797331e-20, 7.86515079e-21, 8.70784552e-21, 1.27808700e-20, 1.33426665e-20, 5.19661749e-20, 2.12078173e-17, 2.57724138e-19, 9.55054025e-20, 1.13061543e-19, 9.26964200e-20,
                9.90166305e-20, 2.18398384e-19, 7.44380343e-20, 9.62076481e-20, 7.16290518e-20, 8.00559991e-20, 5.11937047e-19, 1.54494033e-19, 1.11657051e-19, 1.55196279e-19, 8.70784552e-20, 1.39746876e-19, 2.16993892e-19, 1.80477121e-19, 1.92415296e-19, 2.17696138e-19,
                5.33706661e-19, 7.09268062e-19, 9.12919288e-19, 1.27808700e-18, 9.33986656e-19, 1.16572771e-18, 2.03651226e-18, 2.52808418e-18, 3.33566663e-18, 4.49437188e-18, 3.85532838e-18, 8.35672272e-18, 1.23595227e-17, 1.62920981e-17, 1.01123367e-17, 1.28510946e-17,
                9.41009112e-18, 1.83988349e-17, 2.02246735e-17, 2.20505120e-17, 2.67555576e-17, 3.11094804e-17, 3.47611575e-17, 4.17133890e-17, 4.62779855e-17, 5.09830310e-17, 6.91711922e-17, 8.91851920e-17, 7.09268062e-17, 8.42694728e-17, 1.01123367e-16, 1.26404209e-16,
                1.46067086e-16, 1.72050174e-16, 3.57443014e-16, 4.99998872e-16, 6.48172695e-16, 5.91290801e-16, 8.42694728e-16, 8.56739640e-16, 1.24297472e-15, 1.12359297e-15, 1.37640139e-15, 1.68538946e-15, 1.58005261e-15, 1.55196279e-15, 1.62920981e-15, 1.75561402e-15,
                1.91713051e-15, 2.02246735e-15, 2.12078173e-15, 2.78791506e-15, 5.00701117e-15, 3.06881330e-15, 7.86515079e-15, 8.77807008e-15, 8.14604903e-15, 8.35672272e-15, 9.69098937e-15, 1.19381753e-14, 1.72752419e-14, 2.73875786e-14, 2.80195997e-14, 2.71066804e-14,
                3.56740768e-14, 4.15729399e-14, 4.24858592e-14, 4.87358451e-14, 5.70223432e-14, 6.81880484e-14, 6.29914309e-14, 6.62919852e-14, 7.09268062e-14, 7.23312975e-14, 7.23312975e-14, 7.30335431e-14, 8.28649815e-14, 8.63762096e-14, 8.70784552e-14, 8.21627359e-14,
                7.79492623e-14, 7.65447711e-14, 8.35672272e-14, 1.08145823e-13, 1.33426665e-13, 1.39746876e-13, 1.39746876e-13, 1.41853612e-13, 1.41151367e-13, 1.36235648e-13, 1.39044630e-13, 1.58005261e-13, 1.67836700e-13, 1.74156910e-13, 1.74859156e-13, 1.74156910e-13,
                1.75561402e-13, 1.79072630e-13, 1.83286103e-13, 1.81881612e-13, 1.72752419e-13, 1.71347928e-13, 1.77668138e-13, 1.74156910e-13, 1.74859156e-13, 1.75561402e-13, 1.70645682e-13, 1.70645682e-13, 1.76965893e-13, 1.81179366e-13, 1.85392840e-13, 1.87499577e-13,
                1.89606314e-13, 1.88201822e-13, 1.86797331e-13, 1.86797331e-13, 1.87499577e-13, 1.87499577e-13, 1.88904068e-13, 1.90308559e-13, 1.90308559e-13, 1.90308559e-13, 1.91010805e-13, 1.91010805e-13, 1.90308559e-13, 1.89606314e-13, 1.89606314e-13, 1.89606314e-13,
                1.88904068e-13, 1.88201822e-13, 1.87499577e-13, 1.86797331e-13, 1.86095086e-13, 2.77387014e-13, 3.66572206e-13, 3.63763224e-13, 3.60954242e-13, 3.57443014e-13, 3.53931786e-13, 3.50420558e-13, 3.46909330e-13, 3.44100347e-13, 3.39184628e-13, 3.37077891e-13,
                3.27948698e-13, 3.22330733e-13, 3.28650944e-13, 3.18819505e-13, 3.23032979e-13, 3.18117260e-13, 3.09690312e-13, 3.04774593e-13, 3.02667856e-13, 2.83004979e-13, 3.04072348e-13, 2.98454383e-13, 2.99858874e-13, 2.97049891e-13, 2.90027435e-13, 2.81600488e-13,
                2.73173541e-13, 2.72471295e-13, 2.65448839e-13, 2.64044348e-13, 2.61235366e-13, 2.61235366e-13, 2.66151085e-13, 2.66151085e-13, 5.25981959e-13, 1.48173823e-12, 1.17977262e-12, 1.12359297e-12, 1.05336841e-12, 1.03932350e-12, 1.00421122e-12, 9.26964200e-13,
                8.77807008e-13, 8.14604903e-13, 7.86515079e-13, 7.51402799e-13, 6.98734378e-13, 6.82582729e-13, 6.46065958e-13, 5.78650380e-13, 5.40729117e-13, 4.87358451e-13, 4.57161890e-13, 4.34690030e-13, 5.23875222e-13, 7.79492623e-13, 5.81459362e-13, 5.14746029e-13,
                4.79633749e-13, 4.26263083e-13, 3.86235083e-13, 3.48313821e-13, 3.16712768e-13, 2.87218453e-13, 2.62639857e-13, 2.38763506e-13, 2.23314103e-13, 2.01544489e-13, 1.89606314e-13, 1.73454665e-13, 1.62218735e-13, 1.50280560e-13, 1.41151367e-13, 1.31319928e-13,
                1.20083999e-13, 1.12359297e-13, 1.03932350e-13, 9.90166305e-14, 9.33986656e-14, 8.77807008e-14, 8.14604903e-14, 7.44380343e-14, 6.79071501e-14, 6.49577186e-14, 1.99437752e-13, 4.73313539e-13, 2.35252278e-13, 1.55898525e-13, 1.11657051e-13, 3.18117260e-13)

            flux_active = (0.00000000e+00, 7.45057629e-17, 1.82383899e-14, 3.39001221e-13,
                3.04542306e-12, 8.69233901e-11, 1.50492250e-06, 3.54290425e-06, 4.49564561e-06, 6.25060935e-06, 1.09844559e-05, 1.14517304e-05, 7.93340168e-06, 6.16801626e-06, 4.41059305e-06, 1.55011132e-04, 1.20394884e-03, 7.83643372e-03, 3.21030345e-03, 1.57108683e-02,
                2.50533556e-03, 7.94014370e-03, 4.88886468e-02, 1.07368135e-02, 4.29738140e-03, 2.03368756e-02, 2.27558882e-03, 4.72834050e-03, 3.77991107e-03, 5.31122540e-03, 1.12076938e-02, 1.62672818e-02, 7.10616291e-03, 1.10593718e-02, 1.71074097e-03, 3.70114081e-02,
                2.24586674e-02, 5.61631596e-02, 5.74769469e-03, 1.98166214e-02, 1.11865284e-02, 3.94233792e-02, 8.21324083e-02, 4.54569072e-02, 1.37426963e-01, 2.73807339e-19, 2.12292054e-01, 1.25303693e-02, 3.82341338e-02, 9.37948838e-02, 3.55609717e-20, 6.21792902e-21,
                6.20969465e-21, 3.77440629e-19, 5.41562214e-20, 8.96535720e-21, 7.46646918e-21, 2.58665048e-19, 1.34467691e-19, 9.58735362e-20, 8.22521595e-21, 8.90628478e-21, 6.86307827e-21, 4.04084598e-20, 7.34189769e-21, 7.34189769e-21, 7.34189769e-21, 3.48039577e-20,
                7.57949742e-21, 7.59739896e-21, 5.25578007e-21, 4.47284423e-21, 5.84200231e-21, 1.49837359e-20, 6.32491245e-21, 8.15442865e-21, 1.28337324e-20, 1.31753783e-20, 5.05564624e-20, 2.03230874e-17, 2.42675352e-19, 8.89706579e-20, 1.04996089e-19, 8.58473921e-20,
                9.14120822e-20, 2.00988803e-19, 6.82873050e-20, 8.50155258e-20, 5.80493161e-20, 6.47487790e-20, 4.13117120e-19, 1.25139404e-19, 9.09090834e-20, 1.35247874e-19, 7.70055263e-20, 1.20965440e-19, 1.83768714e-19, 1.53686636e-19, 1.65297366e-19, 1.81616202e-19,
                4.16731875e-19, 5.09237354e-19, 6.59253663e-19, 9.28540603e-19, 6.82630595e-19, 7.81929720e-19, 1.33547094e-18, 1.63050120e-18, 2.12716337e-18, 2.78371703e-18, 2.32634519e-18, 4.82894477e-18, 6.90538254e-18, 8.52393890e-18, 5.22632326e-18, 6.59945559e-18,
                4.80139235e-18, 9.32315281e-18, 1.01772919e-17, 1.10831441e-17, 1.34339776e-17, 1.56027378e-17, 1.74148279e-17, 2.08745345e-17, 2.31314628e-17, 2.54531201e-17, 3.43703348e-17, 4.36447722e-17, 3.44060734e-17, 4.05178514e-17, 4.81658616e-17, 5.96378770e-17,
                6.86790159e-17, 8.01721543e-17, 1.62789463e-16, 2.27713355e-16, 2.92275808e-16, 2.64160894e-16, 3.76476333e-16, 3.82750939e-16, 5.55302592e-16, 5.01968445e-16, 6.14911345e-16, 7.52952667e-16, 7.05893125e-16, 6.93343914e-16, 7.27854245e-16, 7.84325695e-16,
                8.56483659e-16, 9.00513761e-16, 9.29068052e-16, 1.22132038e-15, 2.19344696e-15, 1.34436597e-15, 3.44550171e-15, 3.84541161e-15, 3.56852822e-15, 3.66080325e-15, 4.24528398e-15, 5.22967582e-15, 7.56761614e-15, 1.19973863e-14, 1.22741939e-14, 1.18742269e-14,
                1.56271456e-14, 1.82110701e-14, 1.86108798e-14, 2.13485643e-14, 2.49783018e-14, 2.98692134e-14, 2.75927302e-14, 2.90383477e-14, 3.10684048e-14, 3.16834512e-14, 3.16832816e-14, 3.19907150e-14, 3.62969632e-14, 3.78347676e-14, 3.81421631e-14, 3.59887839e-14,
                3.41430225e-14, 3.35276534e-14, 3.66033890e-14, 4.73688381e-14, 5.84417601e-14, 6.12097264e-14, 6.12093987e-14, 6.21318209e-14, 6.18239067e-14, 5.96705159e-14, 6.09005098e-14, 6.92047544e-14, 7.35104345e-14, 7.62782015e-14, 7.65853649e-14, 7.62773849e-14,
                7.68921135e-14, 7.84295359e-14, 8.02745070e-14, 7.96589503e-14, 7.56602195e-14, 7.50446941e-14, 7.78123195e-14, 7.62741183e-14, 7.65812653e-14, 7.68884090e-14, 7.47351334e-14, 7.47347333e-14, 7.75022715e-14, 7.93471389e-14, 8.11919866e-14, 8.21141832e-14,
                8.30363699e-14, 8.24208444e-14, 8.18053255e-14, 8.18048876e-14, 8.21119852e-14, 8.21115456e-14, 8.27261704e-14, 8.33407887e-14, 8.33403425e-14, 8.33398963e-14, 8.36469758e-14, 8.36465279e-14, 8.33385578e-14, 8.30305909e-14, 8.30301463e-14, 8.30297018e-14,
                8.27217415e-14, 8.24137845e-14, 8.21058307e-14, 8.17978803e-14, 8.14899332e-14, 1.21465476e-13, 1.60517644e-13, 1.59285918e-13, 1.58054219e-13, 1.56515050e-13, 1.54975915e-13, 1.53436812e-13, 1.51897742e-13, 1.50666188e-13, 1.48512223e-13, 1.47588206e-13,
                1.43589488e-13, 1.41128199e-13, 1.43893878e-13, 1.39587865e-13, 1.41431124e-13, 1.39277420e-13, 1.35586499e-13, 1.33432904e-13, 1.32509137e-13, 1.23899328e-13, 1.33121177e-13, 1.30660264e-13, 1.31273730e-13, 1.30042606e-13, 1.26966953e-13, 1.23276520e-13,
                1.19586166e-13, 1.19277469e-13, 1.16202063e-13, 1.15585999e-13, 1.14355136e-13, 1.14353911e-13, 1.16504484e-13, 1.16503236e-13, 2.30237437e-13, 6.48585561e-13, 5.16376164e-13, 4.91760480e-13, 4.61000753e-13, 4.54829709e-13, 4.39440296e-13, 4.05615463e-13,
                3.84084972e-13, 3.56411755e-13, 3.44103254e-13, 3.28723885e-13, 3.05666109e-13, 2.98584457e-13, 2.82595655e-13, 2.53093846e-13, 2.36494922e-13, 2.13141139e-13, 1.99924270e-13, 1.90086772e-13, 2.29074521e-13, 3.40825304e-13, 2.54206580e-13, 2.25016230e-13,
                2.09644747e-13, 1.86296793e-13, 1.68784584e-13, 1.52196674e-13, 1.38373657e-13, 1.25473951e-13, 1.14724256e-13, 1.04283582e-13, 9.75253495e-14, 8.80087108e-14, 8.27867605e-14, 7.57264215e-14, 7.08134597e-14, 6.55950327e-14, 6.16036690e-14, 5.73067085e-14,
                5.23978299e-14, 4.90219406e-14, 4.53404216e-14, 4.31912992e-14, 4.07363495e-14, 3.82819267e-14, 3.55218082e-14, 3.24560929e-14, 2.96053458e-14, 2.83164420e-14, 8.69297783e-14, 2.06233047e-13, 1.02369424e-13, 6.77657400e-14, 4.84825649e-14, 1.37980404e-13)

        else

            solar_flux_hydrogen = (0.00000000e+00, 3.84000000e-24, 9.40000000e-22, 1.74720000e-20,
                1.56960000e-19, 4.48000000e-18, 7.75631600e-14, 1.82600000e-13, 5.93280000e-13, 8.76080000e-13, 1.54560000e-12, 1.62756000e-12, 1.12000000e-12, 8.65000000e-13, 5.90400000e-13, 1.86901600e-11, 8.76420000e-11, 4.84552000e-10, 3.07668817e-10, 1.01898353e-09,
                3.01813953e-10, 1.16896744e-09, 5.72309382e-09, 1.36720000e-09, 6.45075000e-10, 2.33269318e-09, 3.46625000e-10, 6.76605882e-10, 5.17072131e-10, 7.26547950e-10, 1.54377640e-09, 2.35104000e-09, 1.04350400e-09, 1.77524800e-09, 2.88303529e-10, 6.45600000e-09,
                3.97440000e-09, 9.64800000e-09, 9.72900000e-10, 3.29508000e-09, 1.69494000e-09, 6.56016000e-09, 1.09568000e-08, 6.00953270e-09, 1.86179483e-08, 3.73000000e-26, 2.89199467e-08, 1.70697680e-09, 5.20852800e-09, 1.56465280e-08, 5.94000000e-27, 1.04000000e-27,
                1.04000000e-27, 5.30000000e-26, 7.56000000e-27, 1.25000000e-27, 1.04000000e-27, 3.60000000e-26, 2.46000000e-26, 1.83000000e-26, 1.57000000e-27, 1.70000000e-27, 1.31000000e-27, 7.21000000e-27, 1.31000000e-27, 1.31000000e-27, 1.31000000e-27, 6.21000000e-27,
                1.31000000e-27, 1.31000000e-27, 9.15000000e-28, 7.84000000e-28, 1.03000000e-27, 2.66000000e-27, 1.12000000e-27, 1.24000000e-27, 1.82000000e-27, 1.90000000e-27, 7.40000000e-27, 3.02000000e-24, 3.67000000e-26, 1.36000000e-26, 1.61000000e-26, 1.32000000e-26,
                1.41000000e-26, 3.11000000e-26, 1.06000000e-26, 1.37000000e-26, 1.02000000e-26, 1.14000000e-26, 7.29000000e-26, 2.20000000e-26, 1.59000000e-26, 2.21000000e-26, 1.24000000e-26, 1.99000000e-26, 3.09000000e-26, 2.57000000e-26, 2.74000000e-26, 3.10000000e-26,
                7.60000000e-26, 1.01000000e-25, 1.30000000e-25, 1.82000000e-25, 1.33000000e-25, 1.66000000e-25, 2.90000000e-25, 3.60000000e-25, 4.75000000e-25, 6.40000000e-25, 5.49000000e-25, 1.19000000e-24, 1.76000000e-24, 2.32000000e-24, 1.44000000e-24, 1.83000000e-24,
                1.34000000e-24, 2.62000000e-24, 2.88000000e-24, 3.14000000e-24, 3.81000000e-24, 4.43000000e-24, 4.95000000e-24, 5.94000000e-24, 6.59000000e-24, 7.26000000e-24, 9.85000000e-24, 1.27000000e-23, 1.01000000e-23, 1.20000000e-23, 1.44000000e-23, 1.80000000e-23,
                2.08000000e-23, 2.45000000e-23, 5.09000000e-23, 7.12000000e-23, 9.23000000e-23, 8.42000000e-23, 1.20000000e-22, 1.22000000e-22, 1.77000000e-22, 1.60000000e-22, 1.96000000e-22, 2.40000000e-22, 2.25000000e-22, 2.21000000e-22, 2.32000000e-22, 2.50000000e-22,
                2.73000000e-22, 2.88000000e-22, 3.02000000e-22, 3.97000000e-22, 7.13000000e-22, 4.37000000e-22, 1.12000000e-21, 1.25000000e-21, 1.16000000e-21, 1.19000000e-21, 1.38000000e-21, 1.70000000e-21, 2.46000000e-21, 3.90000000e-21, 3.99000000e-21, 3.86000000e-21,
                5.08000000e-21, 5.92000000e-21, 6.05000000e-21, 6.94000000e-21, 8.12000000e-21, 9.71000000e-21, 8.97000000e-21, 9.44000000e-21, 1.01000000e-20, 1.03000000e-20, 1.03000000e-20, 1.04000000e-20, 1.18000000e-20, 1.23000000e-20, 1.24000000e-20, 1.17000000e-20,
                1.11000000e-20, 1.09000000e-20, 1.19000000e-20, 1.54000000e-20, 1.90000000e-20, 1.99000000e-20, 1.99000000e-20, 2.02000000e-20, 2.01000000e-20, 1.94000000e-20, 1.98000000e-20, 2.25000000e-20, 2.39000000e-20, 2.48000000e-20, 2.49000000e-20, 2.48000000e-20,
                2.50000000e-20, 2.55000000e-20, 2.61000000e-20, 2.59000000e-20, 2.46000000e-20, 2.44000000e-20, 2.53000000e-20, 2.48000000e-20, 2.49000000e-20, 2.50000000e-20, 2.43000000e-20, 2.43000000e-20, 2.52000000e-20, 2.58000000e-20, 2.64000000e-20, 2.67000000e-20,
                2.70000000e-20, 2.68000000e-20, 2.66000000e-20, 2.66000000e-20, 2.67000000e-20, 2.67000000e-20, 2.69000000e-20, 2.71000000e-20, 2.71000000e-20, 2.71000000e-20, 2.72000000e-20, 2.72000000e-20, 2.71000000e-20, 2.70000000e-20, 2.70000000e-20, 2.70000000e-20,
                2.69000000e-20, 2.68000000e-20, 2.67000000e-20, 2.66000000e-20, 2.65000000e-20, 3.95000000e-20, 5.22000000e-20, 5.18000000e-20, 5.14000000e-20, 5.09000000e-20, 5.04000000e-20, 4.99000000e-20, 4.94000000e-20, 4.90000000e-20, 4.83000000e-20, 4.80000000e-20,
                4.67000000e-20, 4.59000000e-20, 4.68000000e-20, 4.54000000e-20, 4.60000000e-20, 4.53000000e-20, 4.41000000e-20, 4.34000000e-20, 4.31000000e-20, 4.03000000e-20, 4.33000000e-20, 4.25000000e-20, 4.27000000e-20, 4.23000000e-20, 4.13000000e-20, 4.01000000e-20,
                3.89000000e-20, 3.88000000e-20, 3.78000000e-20, 3.76000000e-20, 3.72000000e-20, 3.72000000e-20, 3.79000000e-20, 3.79000000e-20, 7.49000000e-20, 2.11000000e-19, 1.68000000e-19, 1.60000000e-19, 1.50000000e-19, 1.48000000e-19, 1.43000000e-19, 1.32000000e-19,
                1.25000000e-19, 1.16000000e-19, 1.12000000e-19, 1.07000000e-19, 9.95000000e-20, 9.72000000e-20, 9.20000000e-20, 8.24000000e-20, 7.70000000e-20, 6.94000000e-20, 6.51000000e-20, 6.19000000e-20, 7.46000000e-20, 1.11000000e-19, 8.28000000e-20, 7.33000000e-20,
                6.83000000e-20, 6.07000000e-20, 5.50000000e-20, 4.96000000e-20, 4.51000000e-20, 4.09000000e-20, 3.74000000e-20, 3.40000000e-20, 3.18000000e-20, 2.87000000e-20, 2.70000000e-20, 2.47000000e-20, 2.31000000e-20, 2.14000000e-20, 2.01000000e-20, 1.87000000e-20,
                1.71000000e-20, 1.60000000e-20, 1.48000000e-20, 1.41000000e-20, 1.33000000e-20, 1.25000000e-20, 1.16000000e-20, 1.06000000e-20, 9.67000000e-21, 9.25000000e-21, 2.84000000e-20, 6.74000000e-20, 3.35000000e-20, 2.22000000e-20, 1.59000000e-20, 4.53000000e-20)

            solar_flux_hydrogen_active = (0.00000000e+00, 2.44608000e-23, 5.98780000e-21, 1.11296640e-19,
                9.99835200e-19, 2.85376000e-17, 4.94077329e-13, 1.16316200e-12, 1.47595412e-12, 2.05212187e-12, 3.60627913e-12, 3.75968885e-12, 2.60459519e-12, 2.02500593e-12, 1.44803073e-12, 5.08913157e-11, 3.95265420e-10, 2.57275988e-09, 1.05396667e-09, 5.15799574e-09,
                8.22520430e-10, 2.60680865e-09, 1.60505089e-08, 3.52497630e-09, 1.41086250e-09, 6.67674859e-09, 7.47092853e-10, 1.55234960e-09, 1.24097311e-09, 1.74371508e-09, 3.67956981e-09, 5.34067046e-09, 2.33300651e-09, 3.63087458e-09, 5.61649073e-10, 1.21511225e-08,
                7.37334872e-09, 1.84387859e-08, 1.88701122e-09, 6.50594524e-09, 3.67262106e-09, 1.29429907e-08, 2.69646848e-08, 1.49238431e-08, 4.51183012e-08, 8.98930000e-26, 6.96970715e-08, 4.11381409e-09, 1.25525525e-08, 3.07935629e-08, 1.16749334e-26, 2.04139267e-27,
                2.03868926e-27, 1.23916585e-25, 1.77798931e-26, 2.94339392e-27, 2.45129776e-27, 8.49216727e-26, 4.41467500e-26, 3.14760000e-26, 2.70040000e-27, 2.92400000e-27, 2.25320000e-27, 1.32664000e-26, 2.41040000e-27, 2.41040000e-27, 2.41040000e-27, 1.14264000e-26,
                2.48840577e-27, 2.49428298e-27, 1.72551196e-27, 1.46846826e-27, 1.91797311e-27, 4.91927273e-27, 2.07651613e-27, 2.67716000e-27, 4.21341047e-27, 4.32557537e-27, 1.65980653e-26, 6.67222180e-24, 7.96721358e-26, 2.92097334e-26, 3.44710025e-26, 2.81843418e-26,
                3.00112713e-26, 6.59861295e-26, 2.24192337e-26, 2.79112339e-26, 1.90580252e-26, 2.12575091e-26, 1.35629445e-25, 4.10842038e-26, 2.98461330e-26, 4.44028899e-26, 2.52814910e-26, 3.97138600e-26, 6.03326451e-26, 5.04564735e-26, 5.42683634e-26, 5.96259593e-26,
                1.36816196e-25, 1.67186438e-25, 2.16437915e-25, 3.04846835e-25, 2.24112737e-25, 2.56713383e-25, 4.38445113e-25, 5.35305755e-25, 6.98363665e-25, 9.13915152e-25, 7.63756550e-25, 1.58537874e-24, 2.26708881e-24, 2.79847299e-24, 1.71584107e-24, 2.16665070e-24,
                1.57633307e-24, 3.06086090e-24, 3.34128117e-24, 3.63867920e-24, 4.41047548e-24, 5.12249570e-24, 5.71741844e-24, 6.85326602e-24, 7.59423248e-24, 8.35644995e-24, 1.12840383e-23, 1.43289056e-23, 1.12957716e-23, 1.33023141e-23, 1.58132131e-23, 1.95795617e-23,
                2.25478353e-23, 2.63211187e-23, 5.34450000e-23, 7.47600000e-23, 9.59563367e-23, 8.67260000e-23, 1.23600000e-22, 1.25660000e-22, 1.82310000e-22, 1.64800000e-22, 2.01880000e-22, 2.47200000e-22, 2.31750000e-22, 2.27630000e-22, 2.38960000e-22, 2.57500000e-22,
                2.81190000e-22, 2.95645412e-22, 3.05020000e-22, 4.00968627e-22, 7.20125067e-22, 4.41365417e-22, 1.13118402e-21, 1.26247743e-21, 1.17157454e-21, 1.20186912e-21, 1.39375853e-21, 1.71694174e-21, 2.48450506e-21, 3.93883177e-21, 4.02970977e-21, 3.89839761e-21,
                5.13050893e-21, 5.97883072e-21, 6.11009122e-21, 7.00889357e-21, 8.20056357e-21, 9.80628646e-21, 9.05889997e-21, 9.53350703e-21, 1.01999900e-20, 1.04019143e-20, 1.04018586e-20, 1.05027914e-20, 1.19165649e-20, 1.24214376e-20, 1.25223578e-20, 1.18153873e-20,
                1.12094100e-20, 1.10073797e-20, 1.20171668e-20, 1.55515443e-20, 1.91868676e-20, 2.00956116e-20, 2.00955041e-20, 2.03983422e-20, 2.02972516e-20, 1.95902773e-20, 1.99940935e-20, 2.27204392e-20, 2.41340262e-20, 2.50427049e-20, 2.51435489e-20, 2.50424368e-20,
                2.52442568e-20, 2.57490041e-20, 2.63547219e-20, 2.61526300e-20, 2.48398168e-20, 2.46377351e-20, 2.55463673e-20, 2.50413643e-20, 2.51422030e-20, 2.52430405e-20, 2.45361041e-20, 2.45359727e-20, 2.54445762e-20, 2.60502600e-20, 2.66559373e-20, 2.69587014e-20,
                2.72614622e-20, 2.70593805e-20, 2.68573011e-20, 2.68571573e-20, 2.69579797e-20, 2.69578354e-20, 2.71596214e-20, 2.73614051e-20, 2.73612586e-20, 2.73611122e-20, 2.74619286e-20, 2.74617816e-20, 2.73606727e-20, 2.72595649e-20, 2.72594189e-20, 2.72592730e-20,
                2.71581673e-20, 2.70570627e-20, 2.69559592e-20, 2.68548568e-20, 2.67537554e-20, 3.98780257e-20, 5.26991449e-20, 5.22947600e-20, 5.18903838e-20, 5.13850632e-20, 5.08797535e-20, 5.03744546e-20, 4.98691665e-20, 4.94648378e-20, 4.87576751e-20, 4.84543135e-20,
                4.71415043e-20, 4.63334449e-20, 4.72414378e-20, 4.58277416e-20, 4.64328973e-20, 4.57258200e-20, 4.45140632e-20, 4.38070216e-20, 4.35037422e-20, 4.06770773e-20, 4.37046795e-20, 4.28967432e-20, 4.30981486e-20, 4.26939616e-20, 4.16842016e-20, 4.04726049e-20,
                3.92610341e-20, 3.91596865e-20, 3.81500076e-20, 3.79477492e-20, 3.75436476e-20, 3.75432454e-20, 3.82492946e-20, 3.82488849e-20, 7.55886751e-20, 2.12935497e-19, 1.69530162e-19, 1.61448649e-19, 1.51350000e-19, 1.49324000e-19, 1.44271541e-19, 1.33166595e-19,
                1.26097973e-19, 1.17012649e-19, 1.12971676e-19, 1.07922514e-19, 1.00352473e-19, 9.80275135e-20, 9.27782703e-20, 8.30926054e-20, 7.76430541e-20, 6.99758324e-20, 6.56366351e-20, 6.24069108e-20, 7.52068811e-20, 1.11895500e-19, 8.34579243e-20, 7.38745135e-20,
                6.88279405e-20, 6.11626324e-20, 5.54132432e-20, 4.99673081e-20, 4.54291081e-20, 4.11940378e-20, 3.76648324e-20, 3.42370811e-20, 3.20183027e-20, 2.88939189e-20, 2.71795135e-20, 2.48615514e-20, 2.32485892e-20, 2.15353405e-20, 2.02249459e-20, 1.88142216e-20,
                1.72026000e-20, 1.60942703e-20, 1.48856000e-20, 1.41800270e-20, 1.33740486e-20, 1.25682432e-20, 1.16620757e-20, 1.06555784e-20, 9.71965676e-21, 9.29650000e-21, 2.85396973e-20, 6.77078541e-20, 3.36086486e-20, 2.22480000e-20, 1.59171892e-20, 4.53000000e-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_hydrogen, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_hydrogen_active, wvl_range[1], wvl_range[2])
        end
    
    elseif parent_type == "H"
        if wvl_range == (1.0, 95000.0)
            flux_quiet = (7.59663731e-09, 7.59533215e-09, 7.59272183e-09, 7.59011150e-09,
                7.58750118e-09, 7.58489085e-09, 7.59706858e-06, 9.04774653e-06, 1.26558707e-05, 2.40973856e-05, 2.88308310e-05, 2.23913973e-05, 1.32301306e-05, 1.00977998e-05, 1.17860154e-04, 1.18387785e-04, 5.96234036e-04, 3.05222668e-03, 1.99667102e-03, 3.67994457e-03,
                6.45242840e-03, 6.49626276e-03, 2.93819154e-02, 7.03588616e-03, 3.33964754e-03, 1.15667868e-03, 1.15467841e-03, 2.15487875e-03, 1.74209391e-03, 3.64184024e-03, 8.21173365e-03, 1.32083984e-02, 5.81872647e-03, 9.38414985e-03, 1.50481881e-03, 3.22306246e-02,
                1.94167227e-02, 9.05517879e-02, 1.98499583e-03, 1.13232681e-02, 6.08934371e-03, 2.14580808e-02, 5.90271855e-02, 4.13904286e-02, 1.14773530e-01, 1.70830316e-01, 3.18747416e-01, 1.80284485e-03, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12,
                3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12, 3.39594420e-12)


            flux_active = (2.15613201e-08, 2.15799442e-08, 2.16171926e-08, 2.16544409e-08,
                2.16916892e-08, 2.17289375e-08, 1.00577718e-05, 1.42137075e-05, 2.54375674e-05, 2.54249388e-05, 2.09575118e-05, 2.09575118e-05, 1.36666073e-05, 1.11972101e-05, 1.90600417e-04, 1.91016976e-04, 1.23092629e-03, 7.38921736e-03, 4.77940482e-03, 3.54796104e-03,
                7.47355604e-03, 7.47355604e-03, 3.95590571e-02, 9.38287060e-03, 3.17901909e-03, 1.51204652e-03, 1.50194954e-03, 2.86174951e-03, 1.87520231e-03, 3.88750398e-03, 8.62222608e-03, 1.40394101e-02, 5.84575679e-03, 8.89710961e-03, 1.41797780e-03, 2.74507797e-02,
                1.58861883e-02, 1.79174433e-03, 1.78718967e-03, 1.05488579e-02, 6.22598971e-03, 1.88331598e-02, 6.58328993e-02, 4.75962678e-02, 1.27596916e-01, 1.91041362e-01, 3.48389390e-01, 2.01909394e-03, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12,
                1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12, 1.49543240e-12)

        else

            solar_flux_atomic_H_quiet = (2.23697354e-17, 2.23658921e-17, 2.23582055e-17, 2.23505189e-17,
                2.23428323e-17, 2.23351457e-17, 2.23710053e-14, 2.66428009e-14, 3.72676051e-14, 7.09593096e-14, 8.48978349e-14, 6.59357045e-14, 3.89586218e-14, 2.97348815e-14, 3.47061515e-13, 3.48615224e-13, 1.75572389e-12, 8.98785875e-12, 5.87957547e-12, 1.08362928e-11,
                1.90003958e-11, 1.91294744e-11, 8.65206073e-11, 2.07184976e-11, 9.83422384e-12, 3.40605916e-12, 3.40016899e-12, 6.34544806e-12, 5.12992501e-12, 1.07240874e-11, 2.41810029e-11, 3.88946273e-11, 1.71343406e-11, 2.76334041e-11, 4.43122360e-12, 9.49091702e-11,
                5.71762123e-11, 2.66646867e-10, 5.84519565e-12, 3.33435046e-11, 1.79312243e-11, 6.31873773e-11, 1.73816712e-10, 1.21881946e-10, 3.37972366e-10, 5.03042176e-10, 9.38612053e-10, 5.30881765e-12, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20)

            solar_flux_atomic_H_active = (1.44181175e-16, 1.44305715e-16, 1.44554796e-16, 1.44803876e-16,
                1.45052957e-16, 1.45302038e-16, 6.72566125e-14, 9.50474755e-14, 1.70101754e-13, 1.70017305e-13, 1.40143491e-13, 1.40143491e-13, 9.13890005e-14, 7.48760700e-14, 1.27455053e-12, 1.27733608e-12, 8.23123994e-12, 4.94119115e-11, 3.19600191e-11, 2.37253188e-11,
                4.99758868e-11, 4.99758868e-11, 2.64532566e-10, 6.27435287e-11, 2.12581932e-11, 1.01110991e-11, 1.00435803e-11, 1.91366023e-11, 1.25395324e-11, 2.59958522e-11, 5.76570767e-11, 9.38819438e-11, 3.90907458e-11, 5.94952309e-11, 9.48205883e-12, 1.83564163e-10,
                1.06231404e-10, 1.19814465e-11, 1.19509893e-11, 7.05405194e-11, 4.16333744e-11, 1.25937888e-10, 4.40226513e-10, 3.18277628e-10, 8.53244292e-10, 1.27749915e-09, 2.32968999e-09, 1.35017399e-11, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_atomic_H_quiet, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_atomic_H_active, wvl_range[1], wvl_range[2])
        end
    
    elseif parent_type == "H(-)"
        if wvl_range == (1.0, 95000.0)
            flux_active = flux_quiet = (6.60089163e-10, 6.60102502e-10, 6.60129178e-10, 6.60155855e-10,
                6.60182532e-10, 6.60209209e-10, 6.60609360e-10, 6.60742744e-10, 6.60876127e-10, 6.61009511e-10, 6.61142895e-10, 6.61276279e-10, 6.61409662e-10, 6.61543046e-10, 6.61676430e-10, 6.61783137e-10, 6.62116596e-10, 6.62423379e-10, 6.62810192e-10, 6.63156990e-10, 
                6.63677186e-10, 6.63810570e-10, 6.64077337e-10, 6.64344105e-10, 6.64610872e-10, 6.64877640e-10, 6.65011024e-10, 6.65411175e-10, 6.65811326e-10, 6.66211477e-10, 6.66478245e-10, 6.66745012e-10, 6.67011780e-10, 8.61165727e-10, 1.17261150e-09, 1.48405728e-09, 
                1.79550306e-09, 1.42772531e-09, 1.22677513e-09, 6.82343994e-10, 7.11334198e-10, 7.40324402e-10, 7.69314606e-10, 6.89283664e-10, 1.45583131e-09, 2.59649783e-09, 4.47919049e-09, 6.36112671e-09, 7.16767080e-09, 8.06383090e-09, 8.95999101e-09, 9.85615111e-09, 
                1.07523112e-08, 1.10091405e-08, 1.03202931e-08, 9.28702198e-09, 8.70621955e-09, 8.46627039e-09, 8.22632124e-09, 8.03436192e-09, 6.86486971e-09, 1.98064919e-09, 1.91587751e-09, 1.86605313e-09, 1.81622876e-09, 1.76640439e-09, 1.71658002e-09, 1.66675565e-09, 
                3.66647057e-08, 2.63798229e-07, 4.90931752e-07, 6.49925218e-07, 7.86205332e-07, 9.45198798e-07, 1.08147891e-06, 1.24047238e-06, 1.31993827e-06, 1.08131970e-06, 8.72528445e-07, 6.63737193e-07, 4.25118620e-07, 2.16327368e-07, 1.98532602e-08, 2.18950891e-08, 
                2.42286080e-08, 2.65621268e-08, 2.88956456e-08, 3.12291644e-08, 3.35626832e-08, 3.60473300e-08, 3.89024578e-08, 4.14403491e-08, 4.42954769e-08, 4.68333683e-08, 4.96884961e-08, 4.73899180e-08, 1.86598708e-08, 1.65663713e-08, 1.70924917e-08, 1.75660001e-08, 
                1.80921205e-08, 1.90917494e-08, 2.01439903e-08, 2.63181574e-08, 3.38556492e-08, 4.17520693e-08, 5.05737800e-08, 6.77801788e-08, 8.41416894e-08, 9.46531817e-08, 1.05585134e-07, 3.32327584e-07, 4.29109844e-07, 5.25892103e-07, 6.26130872e-07, 6.96886997e-07, 
                7.78163577e-07, 8.64858595e-07, 9.51553613e-07, 1.03824863e-06, 1.12494365e-06, 1.28560923e-06, 1.59305808e-06, 1.90050692e-06, 2.22604100e-06, 2.55157507e-06, 2.93675859e-06, 3.42493866e-06, 3.91311873e-06, 4.43896559e-06, 5.56287922e-06, 6.68679285e-06,
                9.00028852e-06, 1.30442339e-05, 1.75669589e-05, 2.26790154e-05, 2.80234382e-05, 3.31354947e-05, 3.99251923e-05, 4.72375236e-05, 5.45498549e-05, 5.88868759e-05, 5.83914818e-05, 5.78960878e-05, 5.73816401e-05, 5.68671924e-05, 6.01590148e-05, 6.42364871e-05,
                6.83139593e-05, 7.25320341e-05, 9.43078018e-05, 1.32757039e-04, 1.64354398e-04, 2.84718535e-04, 2.88725229e-04, 2.92731922e-04, 2.96853093e-04, 3.01088740e-04, 3.40105229e-04, 3.82093777e-04, 8.73072586e-04, 8.71151289e-04, 8.69229992e-04, 8.93482081e-04,
                1.04139140e-03, 1.19587447e-03, 1.42271277e-03, 1.72585007e-03, 2.02898737e-03, 2.16791439e-03, 2.26354778e-03, 2.35918117e-03, 2.45481456e-03, 2.55044795e-03, 2.64608135e-03, 2.86963654e-03, 3.20655419e-03, 3.35681636e-03, 3.26666576e-03, 3.17651516e-03,
                3.08636456e-03, 3.24828219e-03, 3.49056484e-03, 5.76273629e-03, 5.82693082e-03, 5.89112535e-03, 5.95531988e-03, 6.01951441e-03, 6.08370894e-03, 6.47121665e-03, 7.14657350e-03, 7.69058512e-03, 7.90371072e-03, 8.11683632e-03, 8.32996192e-03, 8.54308752e-03,
                8.75621312e-03, 8.96933871e-03, 9.18246431e-03, 9.39558991e-03, 9.42172569e-03, 9.42801678e-03, 9.43430786e-03, 9.44059895e-03, 9.44689004e-03, 9.45318112e-03, 9.45947221e-03, 9.70081124e-03, 1.00119173e-02, 1.03230233e-02, 1.06341294e-02, 1.09452354e-02,
                1.11744224e-02, 1.12317499e-02, 1.12890773e-02, 1.13464048e-02, 1.14037322e-02, 1.14610597e-02, 1.15183871e-02, 1.15757146e-02, 1.16330420e-02, 1.16903695e-02, 1.17476969e-02, 1.18050244e-02, 1.18623519e-02, 1.19209454e-02, 1.20021162e-02, 1.20832870e-02,
                1.21644577e-02, 1.22456285e-02, 1.23267993e-02, 1.24079701e-02, 1.24891409e-02, 1.25703117e-02, 1.26920678e-02, 1.28455926e-02, 1.26914263e-02, 1.25372599e-02, 1.23830935e-02, 1.23368178e-02, 1.23063761e-02, 1.22759344e-02, 1.22449466e-02, 1.21839179e-02,
                1.21228893e-02, 1.20618607e-02, 1.20008320e-02, 1.19398034e-02, 1.18787748e-02, 1.17516393e-02, 1.13845078e-02, 1.10173762e-02, 1.06502447e-02, 1.11290009e-02, 1.15013213e-02, 1.13177221e-02, 1.11341230e-02, 1.09505238e-02, 1.07669247e-02, 1.05833255e-02,
                1.03997263e-02, 1.02161272e-02, 1.00628961e-02, 9.91611605e-03, 9.76933599e-03, 9.62255592e-03, 9.47577586e-03, 9.32899579e-03, 9.18221573e-03, 8.95546270e-03, 7.27529487e-03, 6.87077561e-03, 5.68127147e-03, 5.04178068e-03, 4.11843972e-03, 3.17671910e-03,
                2.38562417e-03, 1.67200894e-03, 1.06965999e-03, 5.85453529e-04, 2.40111106e-04, 5.34755186e-05, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20,
                6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20,
                6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20, 6.52656971e-20)

        else
            solar_flux_negative_H = (1.01138759e-10, 1.01140803e-10, 1.01144890e-10, 1.01148978e-10,
                1.01153065e-10, 1.01157153e-10, 1.01218464e-10, 1.01238901e-10, 1.01259338e-10, 1.01279775e-10, 1.01300212e-10, 1.01320649e-10, 1.01341086e-10, 1.01361523e-10, 1.01381960e-10, 1.01398310e-10, 1.01449402e-10, 1.01496407e-10, 1.01555675e-10, 1.01608811e-10,
                1.01688516e-10, 1.01708953e-10, 1.01749827e-10, 1.01790701e-10, 1.01831575e-10, 1.01872449e-10, 1.01892886e-10, 1.01954197e-10, 1.02015508e-10, 1.02076819e-10, 1.02117693e-10, 1.02158568e-10, 1.02199442e-10, 1.31947679e-10, 1.79667353e-10, 2.27387027e-10,
                2.75106701e-10, 2.18755851e-10, 1.87966295e-10, 1.04548641e-10, 1.08990516e-10, 1.13432390e-10, 1.17874265e-10, 1.05611936e-10, 2.23062248e-10, 3.97834996e-10, 6.86300873e-10, 9.74650849e-10, 1.09822941e-09, 1.23553892e-09, 1.37284843e-09, 1.51015795e-09,
                1.64746746e-09, 1.68681881e-09, 1.58127371e-09, 1.42295607e-09, 1.33396561e-09, 1.29720064e-09, 1.26043567e-09, 1.23102369e-09, 1.05183427e-09, 3.03474762e-10, 2.93550455e-10, 2.85916372e-10, 2.78282290e-10, 2.70648207e-10, 2.63014125e-10, 2.55380042e-10,
                5.61776052e-09, 4.04191237e-08, 7.52204870e-08, 9.95814412e-08, 1.20462259e-07, 1.44823213e-07, 1.65704031e-07, 1.90064986e-07, 2.02240737e-07, 1.65679636e-07, 1.33688673e-07, 1.01697710e-07, 6.51366090e-08, 3.31456458e-08, 3.04191345e-09, 3.35476217e-09,
                3.71230356e-09, 4.06984495e-09, 4.42738634e-09, 4.78492773e-09, 5.14246912e-09, 5.52316631e-09, 5.96062855e-09, 6.34948387e-09, 6.78694611e-09, 7.17580143e-09, 7.61326367e-09, 7.26107589e-09, 2.85906251e-09, 2.53829684e-09, 2.61890893e-09, 2.69145981e-09,
                2.77207191e-09, 2.92523488e-09, 3.08645907e-09, 4.03246400e-09, 5.18735733e-09, 6.39724559e-09, 7.74890674e-09, 1.03852685e-08, 1.28921766e-08, 1.45027458e-08, 1.61777378e-08, 5.09191810e-08, 6.57481438e-08, 8.05771066e-08, 9.59356752e-08, 1.06776918e-07,
                1.19230103e-07, 1.32513500e-07, 1.45796897e-07, 1.59080294e-07, 1.72363692e-07, 1.96980847e-07, 2.44088112e-07, 2.91195377e-07, 3.41073657e-07, 3.90951938e-07, 4.49969697e-07, 5.24768571e-07, 5.99567445e-07, 6.80137619e-07, 8.52343492e-07, 1.02454937e-06,
                1.37902281e-06, 1.99863550e-06, 2.69160673e-06, 3.47487523e-06, 4.29374685e-06, 5.07701536e-06, 6.11733177e-06, 7.23772604e-06, 8.35812031e-06, 9.02263800e-06, 8.94673380e-06, 8.87082960e-06, 8.79200601e-06, 8.71318241e-06, 9.21755493e-06, 9.84230460e-06,
                1.04670543e-05, 1.11133470e-05, 1.44498268e-05, 2.03410129e-05, 2.51823555e-05, 4.36245299e-05, 4.42384348e-05, 4.48523398e-05, 4.54837849e-05, 4.61327701e-05, 5.21108706e-05, 5.85443494e-05, 1.33772046e-04, 1.33477666e-04, 1.33183285e-04, 1.36899186e-04,
                1.59561829e-04, 1.83231701e-04, 2.17987831e-04, 2.64434481e-04, 3.10881130e-04, 3.32167506e-04, 3.46820440e-04, 3.61473373e-04, 3.76126307e-04, 3.90779240e-04, 4.05432174e-04, 4.39685266e-04, 4.91307737e-04, 5.14330882e-04, 5.00518021e-04, 4.86705160e-04,
                4.72892299e-04, 4.97701294e-04, 5.34823804e-04, 8.82965561e-04, 8.92801437e-04, 9.02637313e-04, 9.12473189e-04, 9.22309065e-04, 9.32144941e-04, 9.91518812e-04, 1.09499688e-03, 1.17835026e-03, 1.21100533e-03, 1.24366040e-03, 1.27631547e-03, 1.30897055e-03,
                1.34162562e-03, 1.37428069e-03, 1.40693576e-03, 1.43959083e-03, 1.44359535e-03, 1.44455927e-03, 1.44552319e-03, 1.44648711e-03, 1.44745103e-03, 1.44841495e-03, 1.44937887e-03, 1.48635680e-03, 1.53402442e-03, 1.58169204e-03, 1.62935966e-03, 1.67702728e-03,
                1.71214327e-03, 1.72092697e-03, 1.72971068e-03, 1.73849438e-03, 1.74727809e-03, 1.75606179e-03, 1.76484549e-03, 1.77362920e-03, 1.78241290e-03, 1.79119660e-03, 1.79998031e-03, 1.80876401e-03, 1.81754771e-03, 1.82652541e-03, 1.83896238e-03, 1.85139936e-03,
                1.86383633e-03, 1.87627331e-03, 1.88871028e-03, 1.90114726e-03, 1.91358423e-03, 1.92602121e-03, 1.94467667e-03, 1.96819971e-03, 1.94457836e-03, 1.92095701e-03, 1.89733566e-03, 1.89024531e-03, 1.88558104e-03, 1.88091677e-03, 1.87616882e-03, 1.86681802e-03,
                1.85746722e-03, 1.84811642e-03, 1.83876562e-03, 1.82941483e-03, 1.82006403e-03, 1.80058436e-03, 1.74433252e-03, 1.68808068e-03, 1.63182884e-03, 1.70518380e-03, 1.76223067e-03, 1.73409963e-03, 1.70596860e-03, 1.67783756e-03, 1.64970653e-03, 1.62157549e-03,
                1.59344446e-03, 1.56531342e-03, 1.54183538e-03, 1.51934577e-03, 1.49685615e-03, 1.47436653e-03, 1.45187691e-03, 1.42938729e-03, 1.40689767e-03, 1.37215461e-03, 1.11471955e-03, 1.05273917e-03, 8.70483535e-04, 7.72500854e-04, 6.31026696e-04, 4.86736409e-04,
                3.65524966e-04, 2.56184950e-04, 1.63893137e-04, 8.97030990e-05, 3.67897864e-05, 8.19351068e-06, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_negative_H, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end
    
    elseif parent_type == "HO2"
        if wvl_range == (1.0, 95000.0)
            flux_active = flux_quiet = (6.75306153e-10, 6.75306153e-10, 6.75306153e-10, 6.75306153e-10,
                6.75306153e-10, 6.75306153e-10, 2.48184662e-08, 6.47726476e-08, 7.78195684e-08, 8.35593865e-08, 9.43436919e-08, 1.16668955e-07, 1.02346101e-07, 5.32394072e-08, 4.42857252e-08, 9.54402336e-08, 5.34318243e-07, 7.93527136e-06, 4.31977994e-06, 4.28922853e-06,
                6.80343096e-06, 7.49568314e-06, 3.82924228e-05, 1.55987816e-05, 4.08014561e-06, 1.63716775e-05, 9.67891413e-07, 1.44605453e-06, 1.56423549e-06, 1.04877162e-06, 2.00461437e-06, 6.15243186e-06, 4.65404230e-06, 2.82123472e-06, 1.51902390e-06, 4.80564989e-06,
                9.02539996e-06, 1.44993255e-05, 6.22901301e-06, 2.60687846e-06, 1.55408115e-06, 1.20831587e-06, 3.63729441e-06, 8.60479446e-06, 1.21304736e-05, 1.21304736e-05, 1.51806772e-05, 6.49543275e-06, 2.46469680e-06, 4.69800425e-06, 6.92563514e-06, 4.54713174e-06,
                2.16862834e-06, 1.40009827e-05, 3.87511618e-05, 2.75432858e-06, 1.46165724e-05, 2.17750498e-05, 1.31045154e-05, 6.16808785e-06, 8.93581548e-07, 8.90874826e-07, 8.87942544e-07, 8.85686942e-07, 4.23850923e-06, 3.39458695e-06, 1.99107050e-06, 1.57178906e-06,
                3.91962630e-06, 2.59965687e-06, 1.27968745e-06, 1.32725172e-06, 2.00465280e-06, 2.79495406e-06, 2.52657836e-06, 2.12841451e-06, 1.73025066e-06, 3.26225597e-06, 6.62090513e-06, 1.60438678e-03, 1.86194250e-03, 1.13243552e-03, 2.98713248e-04, 1.36438555e-05,
                1.84271073e-05, 2.32103591e-05, 2.21283130e-05, 1.68991156e-05, 1.16699182e-05, 1.72110211e-05, 4.59495020e-05, 4.24169753e-05, 1.97158792e-05, 2.91748053e-05, 6.18290091e-05, 6.21544543e-05, 4.30299806e-05, 2.39055068e-05, 1.23911111e-05, 1.31457574e-05,
                1.39842532e-05, 1.55773954e-05, 1.72543872e-05, 2.31412822e-05, 2.49376883e-05, 2.67962118e-05, 2.87392136e-05, 3.32195724e-05, 4.33838053e-05, 5.39715479e-05, 5.65022048e-05, 1.12392156e-04, 1.50073455e-04, 1.60112206e-04, 1.67230391e-04, 1.70912210e-04,
                1.72744620e-04, 1.68072113e-04, 1.63399605e-04, 1.58727098e-04, 1.64237846e-04, 1.79989056e-04, 2.45973470e-04, 4.74335511e-04, 8.20806374e-04, 1.18663856e-03, 1.50248325e-03, 1.82822726e-03, 1.69187621e-03, 1.74208678e-03, 2.00868007e-03, 2.33250131e-03,
                2.93147997e-03, 3.65496290e-03, 4.47193590e-03, 9.01154241e-03, 1.14016837e-02, 1.07329542e-02, 1.19332485e-02, 1.30886915e-02, 1.44660158e-02, 1.37489894e-02, 1.29396678e-02, 1.37549276e-02, 1.11254185e-02, 1.06939421e-02, 6.41784111e-03, 5.85137532e-03,
                4.79562094e-03, 3.69526381e-03, 3.11009421e-03, 2.98854082e-03, 6.65207829e-03, 4.46648422e-03, 9.43830925e-03, 9.77169824e-03, 9.79200194e-03, 9.27069079e-03, 9.17302287e-03, 1.01584438e-02, 1.44976824e-02, 2.12032138e-02, 2.26166427e-02, 2.22438692e-02,
                2.22397112e-02, 2.54959525e-02, 2.53043050e-02, 2.55540541e-02, 2.84960389e-02, 3.21493467e-02, 3.57361822e-02, 3.46677851e-02, 3.35993880e-02, 3.24483575e-02, 3.10111674e-02, 2.95854286e-02, 2.82728131e-02, 2.89701194e-02, 2.95122550e-02, 2.77789301e-02,
                2.33427281e-02, 2.05828871e-02, 1.90827872e-02, 2.04227038e-02, 2.21884517e-02, 2.18493615e-02, 2.01623064e-02, 1.64896034e-02, 1.00869518e-02, 8.72747986e-03, 3.14749557e-03, 1.27999585e-03, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17,
                6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17, 6.60717588e-17)

        else
            solar_flux_ho2 = (1.02207988e-13, 1.02207988e-13, 1.02207988e-13, 1.02207988e-13,
                1.02207988e-13, 1.02207988e-13, 3.75628962e-12, 9.80337875e-12, 1.17780380e-11, 1.26467629e-11, 1.42789739e-11, 1.76579157e-11, 1.54901432e-11, 8.05781595e-12, 6.70267085e-12, 1.44449361e-11, 8.08693839e-11, 1.20100804e-09, 6.53801263e-10, 6.49177289e-10,
                1.02970332e-09, 1.13447610e-09, 5.79558097e-09, 2.36088488e-09, 6.17532465e-10, 2.47786313e-09, 1.46490941e-10, 2.18861213e-10, 2.36747972e-10, 1.58732208e-10, 3.03399577e-10, 9.31174221e-10, 7.04392071e-10, 4.26995553e-10, 2.29905170e-10, 7.27337969e-10,
                1.36599965e-09, 2.19448154e-09, 9.42764824e-10, 3.94552606e-10, 2.35211106e-10, 1.82879325e-10, 5.50506672e-10, 1.30234076e-09, 1.83595440e-09, 1.83595440e-09, 2.29760453e-09, 9.83087611e-10, 3.73033327e-10, 7.11045738e-10, 1.04819900e-09, 6.88211094e-10,
                3.28223189e-10, 2.11905706e-09, 5.86501139e-09, 4.16869270e-10, 2.21222692e-09, 3.29566675e-09, 1.98337620e-09, 9.33543765e-10, 1.35244099e-10, 1.34834435e-10, 1.34390632e-10, 1.34049246e-10, 6.41500894e-10, 5.13772754e-10, 3.01349705e-10, 2.37891209e-10,
                5.93237772e-10, 3.93459614e-10, 1.93681456e-10, 2.00880337e-10, 3.03405394e-10, 4.23017960e-10, 3.82399138e-10, 3.22136802e-10, 2.61874466e-10, 4.93744382e-10, 1.00207793e-09, 2.42824894e-07, 2.81806105e-07, 1.71394789e-07, 4.52104278e-08, 2.06500564e-09,
                2.78895365e-09, 3.51290166e-09, 3.34913333e-09, 2.55769120e-09, 1.76624907e-09, 2.60489828e-09, 6.95448447e-09, 6.41983445e-09, 2.98401004e-09, 4.41562413e-09, 9.35785731e-09, 9.40711364e-09, 6.51261315e-09, 3.61811267e-09, 1.87540203e-09, 1.98961820e-09,
                2.11652505e-09, 2.35764806e-09, 2.61146176e-09, 3.50244683e-09, 3.77433396e-09, 4.05562259e-09, 4.34969707e-09, 5.02780204e-09, 6.56616473e-09, 8.16862588e-09, 8.55164231e-09, 1.70106196e-08, 2.27137067e-08, 2.42330776e-08, 2.53104191e-08, 2.58676647e-08,
                2.61450010e-08, 2.54378142e-08, 2.47306274e-08, 2.40234407e-08, 2.48574957e-08, 2.72414506e-08, 3.72282311e-08, 7.17909617e-08, 1.24229533e-07, 1.79598452e-07, 2.27401734e-07, 2.76703284e-07, 2.56066470e-07, 2.63665871e-07, 3.04014924e-07, 3.53025461e-07,
                4.43681237e-07, 5.53180809e-07, 6.76830158e-07, 1.36390230e-06, 1.72565162e-06, 1.62443901e-06, 1.80610426e-06, 1.98098124e-06, 2.18944009e-06, 2.08091772e-06, 1.95842642e-06, 2.08181647e-06, 1.68383870e-06, 1.61853450e-06, 9.71344069e-07, 8.85609135e-07,
                7.25820082e-07, 5.59280376e-07, 4.70714608e-07, 4.52317431e-07, 1.00679601e-06, 6.76005043e-07, 1.42849372e-06, 1.47895234e-06, 1.48202532e-06, 1.40312457e-06, 1.38834247e-06, 1.53748651e-06, 2.19423286e-06, 3.20911902e-06, 3.42304233e-06, 3.36662283e-06,
                3.36599351e-06, 3.85882758e-06, 3.82982162e-06, 3.86762128e-06, 4.31289245e-06, 4.86582274e-06, 5.40869244e-06, 5.24698990e-06, 5.08528736e-06, 4.91107821e-06, 4.69355863e-06, 4.47777222e-06, 4.27910709e-06, 4.38464480e-06, 4.46669734e-06, 4.20435759e-06,
                3.53293579e-06, 3.11523220e-06, 2.88819120e-06, 3.09098838e-06, 3.35823537e-06, 3.30691386e-06, 3.05157707e-06, 2.49571128e-06, 1.52666616e-06, 1.32090927e-06, 4.76375327e-07, 1.93728134e-07, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_ho2, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end

    elseif parent_type == "H2O2"
        if wvl_range == (1.0, 95000.0)
            flux_active = flux_quiet = (1.90099439e-09, 2.10652520e-09, 2.59339160e-09, 3.08025800e-09,
                3.56712440e-09, 4.05399079e-09, 4.73934775e-07, 1.61211362e-06, 2.25785617e-06, 2.90359872e-06, 3.54934127e-06, 2.89984569e-06, 2.19838085e-06, 1.49691602e-06, 6.32482673e-06, 1.64089337e-05, 4.57266099e-05, 2.01252681e-04, 1.31568724e-04, 1.95852888e-04,
                1.59588052e-04, 5.86411355e-04, 9.76446594e-04, 2.74833756e-04, 1.22647588e-04, 2.41431952e-04, 3.38287582e-05, 4.21338908e-05, 3.47192564e-05, 7.03649514e-05, 1.25054581e-04, 1.78600765e-04, 9.23134948e-05, 1.06007800e-04, 5.22110551e-05, 2.96836383e-04,
                2.30837416e-04, 6.59013599e-04, 2.89131936e-04, 6.98855277e-05, 4.06130125e-05, 1.39504959e-04, 2.18300999e-04, 1.67034588e-04, 3.85839890e-04, 4.47058806e-04, 6.59526548e-04, 1.06516881e-04, 1.80621111e-04, 1.66744741e-04, 1.16111165e-04, 6.54775888e-05,
                4.09771223e-04, 1.11198594e-03, 1.08853259e-04, 5.57109432e-05, 3.25428031e-04, 5.68986079e-04, 4.22747568e-04, 3.05756760e-04, 1.59518249e-04, 3.78421025e-05, 9.84109389e-05, 1.33370293e-04, 9.10060923e-05, 4.86418913e-05, 5.95416965e-05, 1.10599635e-04,
                8.44525702e-05, 5.83055052e-05, 3.21584401e-05, 5.71332688e-05, 8.12233837e-05, 6.96484822e-05, 5.97271380e-05, 4.81522365e-05, 7.81070315e-05, 1.42031680e-04, 1.97965747e-04, 5.99288352e-02, 4.04951486e-02, 2.34906727e-02, 4.05698609e-03, 4.67569951e-04,
                6.34280494e-04, 6.98361298e-04, 5.09576391e-04, 3.20791483e-04, 5.50782996e-04, 1.13846256e-03, 1.54079007e-03, 1.10637198e-03, 6.17651626e-04, 1.48981625e-03, 1.88532654e-03, 1.52560049e-03, 1.16587444e-03, 8.06148394e-04, 4.06452785e-04, 4.09161150e-04,
                4.32406940e-04, 4.76573941e-04, 5.23065522e-04, 6.23623408e-04, 7.22075159e-04, 7.68118875e-04, 8.16255487e-04, 9.40571258e-04, 1.18565522e-03, 1.63388094e-03, 1.67128044e-03, 3.29235227e-03, 4.64552964e-03, 4.73390525e-03, 4.82543712e-03, 4.87278119e-03,
                4.87289886e-03, 4.76430039e-03, 4.65570192e-03, 4.54710344e-03, 4.90332089e-03, 5.31094697e-03, 5.17367375e-03, 5.01179762e-03, 4.84039936e-03, 5.42067527e-03, 6.74252019e-03, 6.45752527e-03, 5.38637746e-03, 5.91466660e-03, 6.56963942e-03, 7.22461223e-03,
                7.91233369e-03, 1.07231464e-02, 1.84366616e-02, 2.36374719e-02, 2.09506438e-02, 2.28531004e-02, 2.53806449e-02, 2.44195008e-02, 3.19135090e-02, 2.92518173e-02, 2.83229624e-02, 3.06706152e-02, 2.61475174e-02, 2.09942825e-02, 1.97982207e-02, 1.85594424e-02,
                1.73206641e-02, 1.60391693e-02, 1.46007239e-02, 1.62629780e-02, 2.17641669e-02, 1.18608602e-02, 2.46480104e-02, 2.39702459e-02, 1.71318530e-02, 1.59298818e-02, 1.47357898e-02, 1.35102743e-02, 1.45838404e-02, 1.74037467e-02, 1.40225849e-02, 1.06612167e-02,
                1.03858736e-02, 9.58598979e-03, 6.20228160e-03, 5.35193702e-03, 5.07006793e-03, 4.69879231e-03, 3.24809505e-03, 2.58615000e-03, 1.98538512e-03, 1.29755515e-03, 1.26144523e-03, 1.22533531e-03, 1.22430185e-03, 1.25479961e-03, 1.28529737e-03, 1.22659756e-03,
                1.13046765e-03, 1.06502530e-03, 1.10376721e-03, 1.36154827e-03, 1.65674485e-03, 1.66878646e-03, 1.68082808e-03, 1.69286969e-03, 1.63023958e-03, 1.46046651e-03, 1.46447222e-03, 1.51754446e-03, 1.67672465e-03, 1.63880909e-03, 1.59082056e-03, 1.54283203e-03,
                1.48952653e-03, 1.42540369e-03, 1.36128086e-03, 1.29226479e-03, 1.20391778e-03, 1.14480292e-03, 1.09427322e-03, 1.03810401e-03, 9.70035759e-04, 9.01967512e-04, 8.21247077e-04, 7.34405619e-04, 6.72729252e-04, 6.33898818e-04, 5.88030573e-04, 5.39092469e-04,
                4.78367462e-04, 4.05510073e-04, 3.29858288e-04, 2.63019793e-04, 1.95933090e-04, 9.29046076e-05, 2.20952286e-05, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15,
                1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15, 1.90780969e-15)

        else
            solar_flux_h2o2 = (9.96427684e-15, 1.10415898e-14, 1.35935550e-14, 1.61455202e-14,
                1.86974854e-14, 2.12494507e-14, 2.48418266e-12, 8.45007565e-12, 1.18348082e-11, 1.52195407e-11, 1.86042732e-11, 1.51998687e-11, 1.15230616e-11, 7.84625438e-12, 3.31522937e-11, 8.60092794e-11, 2.39681191e-10, 1.05488866e-09, 6.89632330e-10, 1.02658504e-09,
                8.36498799e-10, 3.07374135e-09, 5.11815512e-09, 1.44057217e-09, 6.42871185e-10, 1.26549285e-09, 1.77317257e-10, 2.20849548e-10, 1.81984904e-10, 3.68825841e-10, 6.55487709e-10, 9.36156084e-10, 4.83871610e-10, 5.55651856e-10, 2.73670143e-10, 1.55590143e-09,
                1.20996039e-09, 3.45429422e-09, 1.51551770e-09, 3.66312887e-10, 2.12877692e-10, 7.31231001e-10, 1.14424935e-09, 8.75530661e-10, 2.02242337e-09, 2.34330923e-09, 3.45698290e-09, 5.58320263e-10, 9.46745955e-10, 8.74011395e-10, 6.08609786e-10, 3.43208178e-10,
                2.14786215e-09, 5.82859992e-09, 5.70566651e-10, 2.92015202e-10, 1.70576778e-09, 2.98240480e-09, 2.21587913e-09, 1.60265859e-09, 8.36132920e-10, 1.98353654e-10, 5.15832052e-10, 6.99075457e-10, 4.77018712e-10, 2.54961967e-10, 3.12094527e-10, 5.79720481e-10,
                4.42667686e-10, 3.05614891e-10, 1.68562096e-10, 2.99470482e-10, 4.25741540e-10, 3.65070386e-10, 3.13066540e-10, 2.52395387e-10, 4.09406828e-10, 7.44475093e-10, 1.03765983e-09, 3.14123759e-07, 2.12259895e-07, 1.23129015e-07, 2.12651509e-08, 2.45082071e-09,
                3.32465285e-09, 3.66053962e-09, 2.67100221e-09, 1.68146479e-09, 2.88699128e-09, 5.96738008e-09, 8.07622516e-09, 5.79917368e-09, 3.23749077e-09, 7.80904013e-09, 9.88215199e-09, 7.99660728e-09, 6.11106257e-09, 4.22551786e-09, 2.13046818e-09, 2.14466438e-09,
                2.26650982e-09, 2.49801614e-09, 2.74170702e-09, 3.26879253e-09, 3.78483850e-09, 4.02618184e-09, 4.27849533e-09, 4.93011049e-09, 6.21474577e-09, 8.56417149e-09, 8.76020519e-09, 1.72572363e-08, 2.43500684e-08, 2.48132991e-08, 2.52930737e-08, 2.55412330e-08,
                2.55418498e-08, 2.49726186e-08, 2.44033875e-08, 2.38341563e-08, 2.57013103e-08, 2.78379285e-08, 2.71183953e-08, 2.62699033e-08, 2.53715000e-08, 2.84130817e-08, 3.53416812e-08, 3.38478481e-08, 2.82333059e-08, 3.10023931e-08, 3.44355071e-08, 3.78686211e-08,
                4.14733907e-08, 5.62065831e-08, 9.66378445e-08, 1.23898479e-07, 1.09815166e-07, 1.19787107e-07, 1.33035517e-07, 1.27997572e-07, 1.67278262e-07, 1.53326704e-07, 1.48458006e-07, 1.60763494e-07, 1.37055166e-07, 1.10043903e-07, 1.03774610e-07, 9.72814136e-08,
                9.07882172e-08, 8.40711174e-08, 7.65313438e-08, 8.52442359e-08, 1.14079339e-07, 6.21700383e-08, 1.29195330e-07, 1.25642752e-07, 8.97985426e-08, 8.34982747e-08, 7.72393065e-08, 7.08156287e-08, 7.64428469e-08, 9.12237040e-08, 7.35009625e-08, 5.58819716e-08,
                5.44387295e-08, 5.02460483e-08, 3.25099596e-08, 2.80527824e-08, 2.65753338e-08, 2.46292506e-08, 1.70252571e-08, 1.35555973e-08, 1.04066204e-08, 6.80128189e-09, 6.61200765e-09, 6.42273342e-09, 6.41731642e-09, 6.57717389e-09, 6.73703135e-09, 6.42934966e-09,
                5.92547385e-09, 5.58245039e-09, 5.78552053e-09, 7.13670903e-09, 8.68401528e-09, 8.74713275e-09, 8.81025021e-09, 8.87336768e-09, 8.54508492e-09, 7.65520020e-09, 7.67619658e-09, 7.95438072e-09, 8.78874164e-09, 8.59000295e-09, 8.33846566e-09, 8.08692836e-09,
                7.80752156e-09, 7.47141446e-09, 7.13530737e-09, 6.77355186e-09, 6.31047102e-09, 6.00061382e-09, 5.73575669e-09, 5.44133940e-09, 5.08455200e-09, 4.72776459e-09, 4.30465932e-09, 3.84947000e-09, 3.52618636e-09, 3.32265225e-09, 3.08222867e-09, 2.82571407e-09,
                2.50741708e-09, 2.12552685e-09, 1.72898947e-09, 1.37864795e-09, 1.02700542e-09, 4.86969994e-10, 1.15814637e-10, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20,
                1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20, 1.00000000e-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_h2o2, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end

    elseif parent_type == "He"
        if wvl_range == (1.0, 95000.0)
            flux_quiet  = (0.00000000e+00, 1.61451735e-15, 1.03149719e-12, 3.71697771e-11,
                5.42477828e-10, 2.28185118e-08, 1.41646989e-05, 4.69017289e-05, 1.12526477e-04, 1.68627367e-04, 3.16445400e-04, 3.58745754e-04, 2.66215971e-04, 1.50239809e-04, 8.86908196e-05, 2.64240161e-03, 1.15857765e-02, 6.45692129e-02, 3.36537171e-02, 8.15761798e-02,
                1.89705788e-02, 6.96179880e-02, 3.02768644e-01, 6.80465244e-02, 2.97071192e-02, 9.61158055e-02, 1.36851872e-02, 2.46569089e-02, 1.80669873e-02, 2.44538385e-02, 5.37828019e-02, 8.45777469e-02, 4.34125775e-23, 6.49394755e-23, 9.27450520e-24, 1.82978633e-22,
                9.90237306e-23, 2.15268980e-22, 2.06299439e-23, 6.08134867e-23, 2.85231398e-23, 9.31038337e-23, 2.29620245e-22, 1.44768389e-22, 1.88360357e-22, 6.69127745e-22, 5.99165326e-22, 1.68447976e-23, 4.19774510e-23, 1.04764237e-22, 1.06558145e-22, 1.86566449e-23,
                1.86566449e-23, 9.50771326e-22, 1.35619457e-22, 2.24238520e-23, 1.86566449e-23, 6.45806939e-22, 4.41301408e-22, 3.28285194e-22, 2.81643582e-23, 3.04964388e-23, 2.35001969e-23, 1.29340779e-22, 2.35001969e-23, 2.35001969e-23, 2.35001969e-23, 1.11401697e-22,
                2.35001969e-23, 2.35001969e-23, 1.64142597e-23, 1.40642400e-23, 1.84772541e-23, 4.77179571e-23, 2.00917714e-23, 2.22444612e-23, 3.26491286e-23, 3.40842551e-23, 1.32749204e-22, 5.41760265e-20, 6.58364296e-22, 2.43971510e-22, 2.88819214e-22, 2.36795878e-22,
                2.52941051e-22, 5.57905439e-22, 1.90154265e-22, 2.45765418e-22, 1.82978633e-22, 2.04505531e-22, 1.30775905e-21, 3.94659796e-22, 2.85231398e-22, 3.96453704e-22, 2.22444612e-22, 3.56987724e-22, 5.54317622e-22, 4.61034398e-22, 4.91530837e-22, 5.56111531e-22,
                1.36337020e-21, 1.81184724e-21, 2.33208061e-21, 3.26491286e-21, 2.38589786e-21, 2.97788755e-21, 5.20233367e-21, 6.45806939e-21, 8.52106377e-21, 1.14810122e-20, 9.84855581e-21, 2.13475071e-20, 3.15727837e-20, 4.16186694e-20, 2.58322775e-20, 3.28285194e-20,
                2.40383694e-20, 4.70003939e-20, 5.16645551e-20, 5.63287163e-20, 6.83479010e-20, 7.94701316e-20, 8.87984541e-20, 1.06558145e-19, 1.18218548e-19, 1.30237733e-19, 1.76699954e-19, 2.27826337e-19, 1.81184724e-19, 2.15268980e-19, 2.58322775e-19, 3.22903469e-19,
                3.73132898e-19, 4.39507500e-19, 9.13099255e-19, 1.27726261e-18, 1.65577723e-18, 1.51047067e-18, 2.15268980e-18, 2.18856796e-18, 3.17521745e-18, 2.87025306e-18, 3.51606000e-18, 4.30537959e-18, 4.03629337e-18, 3.96453704e-18, 4.16186694e-18, 4.48477041e-18,
                4.89736928e-18, 5.16645551e-18, 5.41760265e-18, 7.12181541e-18, 1.27905652e-17, 7.83937867e-18, 2.00917714e-17, 2.24238520e-17, 2.08093347e-17, 2.13475071e-17, 2.47559326e-17, 3.04964388e-17, 4.41301408e-17, 6.99624184e-17, 7.15769357e-17, 6.92448551e-17,
                9.11305347e-17, 1.06199363e-16, 1.08531444e-16, 1.24497227e-16, 1.45665343e-16, 1.74188483e-16, 1.60913562e-16, 1.69344931e-16, 1.81184724e-16, 1.84772541e-16, 1.84772541e-16, 1.86566449e-16, 2.11681163e-16, 2.20650704e-16, 2.22444612e-16, 2.09887255e-16,
                1.99123806e-16, 1.95535990e-16, 2.13475071e-16, 2.76261857e-16, 3.40842551e-16, 3.56987724e-16, 3.56987724e-16, 3.62369449e-16, 3.60575541e-16, 3.48018184e-16, 3.55193816e-16, 4.03629337e-16, 4.28744051e-16, 4.44889224e-16, 4.46683133e-16, 4.44889224e-16,
                4.48477041e-16, 4.57446582e-16, 4.68210031e-16, 4.64622214e-16, 4.41301408e-16, 4.37713592e-16, 4.53858765e-16, 4.44889224e-16, 4.46683133e-16, 4.48477041e-16, 4.35919684e-16, 4.35919684e-16, 4.52064857e-16, 4.62828306e-16, 4.73591755e-16, 4.78973480e-16,
                4.84355204e-16, 4.80767388e-16, 4.77179571e-16, 4.77179571e-16, 4.78973480e-16, 4.78973480e-16, 4.82561296e-16, 4.86149112e-16, 4.86149112e-16, 4.86149112e-16, 4.87943020e-16, 4.87943020e-16, 4.86149112e-16, 4.84355204e-16, 4.84355204e-16, 4.84355204e-16,
                4.82561296e-16, 4.80767388e-16, 4.78973480e-16, 4.77179571e-16, 4.75385663e-16, 7.08593724e-16, 9.36420061e-16, 9.29244428e-16, 9.22068796e-16, 9.13099255e-16, 9.04129714e-16, 8.95160173e-16, 8.86190632e-16, 8.79015000e-16, 8.66457643e-16, 8.61075918e-16,
                8.37755112e-16, 8.23403847e-16, 8.39549020e-16, 8.14434306e-16, 8.25197755e-16, 8.12640398e-16, 7.91113500e-16, 7.78556143e-16, 7.73174418e-16, 7.22944990e-16, 7.76762235e-16, 7.62410969e-16, 7.65998786e-16, 7.58823153e-16, 7.40884071e-16, 7.19357173e-16,
                6.97830275e-16, 6.96036367e-16, 6.78097286e-16, 6.74509469e-16, 6.67333837e-16, 6.67333837e-16, 6.79891194e-16, 6.79891194e-16, 1.34363721e-15, 3.78514622e-15, 3.01376571e-15, 2.87025306e-15, 2.69086224e-15, 2.65498408e-15, 2.56528867e-15, 2.36795878e-15,
                2.24238520e-15, 2.08093347e-15, 2.00917714e-15, 1.91948173e-15, 1.78493862e-15, 1.74367873e-15, 1.65039551e-15, 1.47818033e-15, 1.38130929e-15, 1.24497227e-15, 1.16783421e-15, 1.11042915e-15, 1.33825549e-15, 1.99123806e-15, 1.48535596e-15, 1.31493468e-15,
                1.22523928e-15, 1.08890225e-15, 9.86649490e-16, 8.89778449e-16, 8.09052581e-16, 7.33708439e-16, 6.70921653e-16, 6.09928775e-16, 5.70462796e-16, 5.14851643e-16, 4.84355204e-16, 4.43095316e-16, 4.14392786e-16, 3.83896347e-16, 3.60575541e-16, 3.35460826e-16,
                3.06758296e-16, 2.87025306e-16, 2.65498408e-16, 2.52941051e-16, 2.38589786e-16, 2.24238520e-16, 2.08093347e-16, 1.90154265e-16, 1.73470919e-16, 1.65936505e-16, 5.09469918e-16, 1.20909410e-15, 6.00959235e-16, 3.98247612e-16, 2.85231398e-16, 8.12640398e-16)

            flux_active = (0.00000000e+00, 3.41184681e-15, 2.17979102e-12, 7.85482955e-11,
                1.14638053e-09, 4.82207683e-08, 2.99332694e-05, 9.91141499e-05, 9.28699583e-05, 1.31037264e-04, 2.44944895e-04, 2.74921714e-04, 2.05382622e-04, 1.16681658e-04, 7.21634811e-05, 2.38691449e-03, 1.73344100e-02, 1.13734372e-01, 3.82458053e-02, 1.36988640e-01,
                1.71512326e-02, 5.15033622e-02, 2.81693103e-01, 5.82019420e-02, 2.15547204e-02, 9.12661202e-02, 9.78527010e-03, 1.87672125e-02, 1.43848175e-02, 1.94699868e-02, 4.25268728e-02, 6.37381202e-02, 3.21991776e-23, 4.40624223e-23, 5.99395133e-24, 1.14251163e-22,
                6.09452495e-23, 1.36484664e-22, 1.32743022e-23, 3.98337983e-23, 2.05034289e-23, 6.09389752e-23, 1.87468872e-22, 1.19267218e-22, 1.51432050e-22, 5.34974962e-22, 4.79039242e-22, 1.34676002e-23, 3.35614319e-23, 6.84009901e-23, 6.94803491e-23, 1.21488210e-23,
                1.21327324e-23, 7.37457539e-22, 1.05812440e-22, 1.75168484e-23, 1.45882652e-23, 5.05389392e-22, 2.62727975e-22, 1.87321281e-22, 1.60707328e-23, 1.74014305e-23, 1.34093376e-23, 7.89515517e-23, 1.43448728e-23, 1.43448728e-23, 1.43448728e-23, 6.80012671e-23,
                1.48091040e-23, 1.48440807e-23, 1.02689386e-23, 8.73920942e-24, 1.14143214e-23, 2.92757805e-23, 1.23578492e-23, 1.59324260e-23, 2.50750237e-23, 2.57425441e-23, 9.87790965e-23, 3.97080040e-20, 4.74148130e-22, 1.73834181e-22, 2.05145264e-22, 1.67731828e-22,
                1.78604326e-22, 3.92699400e-22, 1.33422276e-22, 1.66106496e-22, 1.13418913e-22, 1.26508573e-22, 8.07163594e-22, 2.44502023e-22, 1.77621548e-22, 2.64252326e-22, 1.50456261e-22, 2.36346776e-22, 3.59054148e-22, 3.00278665e-22, 3.22964142e-22, 3.54848490e-22,
                8.14226237e-22, 9.94966883e-22, 1.28807433e-21, 1.81421717e-21, 1.33374905e-21, 1.52776337e-21, 2.60929280e-21, 3.18573388e-21, 4.15613090e-21, 5.43892988e-21, 4.54529976e-21, 9.43497190e-21, 1.34919933e-20, 1.66543889e-20, 1.02113848e-20, 1.28942618e-20,
                9.38113895e-21, 1.82159227e-20, 1.98847715e-20, 2.16546591e-20, 2.62478052e-20, 3.04852095e-20, 3.40257385e-20, 4.07854419e-20, 4.51951123e-20, 4.97312527e-20, 6.71540385e-20, 8.52747791e-20, 6.72238660e-20, 7.91652851e-20, 9.41082519e-20, 1.16522702e-19,
                1.34187616e-19, 1.56643337e-19, 3.18064108e-19, 4.44914823e-19, 5.71059344e-19, 5.16127380e-19, 7.35573463e-19, 7.47833020e-19, 1.08497086e-18, 9.80764617e-19, 1.20143666e-18, 1.47114693e-18, 1.37920024e-18, 1.35468113e-18, 1.42210869e-18, 1.53244471e-18,
                1.67342963e-18, 1.75945728e-18, 1.81524772e-18, 2.38626117e-18, 4.28563826e-18, 2.62667224e-18, 6.73194939e-18, 7.51330822e-18, 6.97232317e-18, 7.15261354e-18, 8.29459373e-18, 1.02179351e-17, 1.47858899e-17, 2.34409395e-17, 2.39817765e-17, 2.32003061e-17,
                3.05328982e-17, 3.55814661e-17, 3.63626291e-17, 4.17116190e-17, 4.88035351e-17, 5.83595800e-17, 5.39117024e-17, 5.67362037e-17, 6.07026049e-17, 6.19043053e-17, 6.19039740e-17, 6.25046489e-17, 7.09183566e-17, 7.39229761e-17, 7.45235770e-17, 7.03162245e-17,
                6.67099072e-17, 6.55075762e-17, 7.15170628e-17, 9.25509976e-17, 1.14185685e-16, 1.19593840e-16, 1.19593200e-16, 1.21395463e-16, 1.20793848e-16, 1.16586473e-16, 1.18989681e-16, 1.35214823e-16, 1.43627421e-16, 1.49035187e-16, 1.49635334e-16, 1.49033592e-16,
                1.50234671e-16, 1.53238544e-16, 1.56843317e-16, 1.55640620e-16, 1.47827751e-16, 1.46625114e-16, 1.52032604e-16, 1.49027209e-16, 1.49627324e-16, 1.50227433e-16, 1.46020283e-16, 1.46019502e-16, 1.51426821e-16, 1.55031391e-16, 1.58635923e-16, 1.60437745e-16,
                1.62239548e-16, 1.61036911e-16, 1.59834288e-16, 1.59833432e-16, 1.60433451e-16, 1.60432592e-16, 1.61633469e-16, 1.62834333e-16, 1.62833461e-16, 1.62832589e-16, 1.63432572e-16, 1.63431697e-16, 1.62829974e-16, 1.62228257e-16, 1.62227388e-16, 1.62226520e-16,
                1.61624815e-16, 1.61023117e-16, 1.60421426e-16, 1.59819741e-16, 1.59218062e-16, 2.37323766e-16, 3.13625344e-16, 3.11218752e-16, 3.08812211e-16, 3.05804926e-16, 3.02797706e-16, 2.99790550e-16, 2.96783459e-16, 2.94377201e-16, 2.90168705e-16, 2.88363327e-16,
                2.80550482e-16, 2.75741525e-16, 2.81145210e-16, 2.72731963e-16, 2.76333390e-16, 2.72125403e-16, 2.64913945e-16, 2.60706170e-16, 2.58901280e-16, 2.42079115e-16, 2.60097107e-16, 2.55288883e-16, 2.56487495e-16, 2.54082081e-16, 2.48072755e-16, 2.40862250e-16,
                2.33651899e-16, 2.33048756e-16, 2.27039912e-16, 2.25836224e-16, 2.23431318e-16, 2.23428924e-16, 2.27630793e-16, 2.27628355e-16, 4.49846469e-16, 1.26723059e-15, 1.00891495e-15, 9.60819915e-16, 9.00720417e-16, 8.88663202e-16, 8.58594795e-16, 7.92506579e-16,
                7.50439503e-16, 6.96370543e-16, 6.72321737e-16, 6.42272953e-16, 5.97221813e-16, 5.83385417e-16, 5.52145902e-16, 4.94504171e-16, 4.62072574e-16, 4.16443086e-16, 3.90619474e-16, 3.71398604e-16, 4.47574320e-16, 6.65917155e-16, 4.96678272e-16, 4.39645079e-16,
                4.09611704e-16, 3.63993603e-16, 3.29777599e-16, 2.97367523e-16, 2.70359598e-16, 2.45155672e-16, 2.24152518e-16, 2.03753141e-16, 1.90548655e-16, 1.71954692e-16, 1.61751852e-16, 1.47957099e-16, 1.38357971e-16, 1.28162015e-16, 1.20363540e-16, 1.11967979e-16,
                1.02376829e-16, 9.57808909e-17, 8.85878021e-17, 8.43887668e-17, 7.95921948e-17, 7.47966521e-17, 6.94038300e-17, 6.34139214e-17, 5.78440257e-17, 5.53257176e-17, 1.69846634e-16, 4.02945798e-16, 2.00013188e-16, 1.32403223e-16, 9.47270386e-17, 2.69591245e-16)

        else

            solar_flux_He = (0.000000e+00, 9.000000e-23, 5.750000e-20, 2.072000e-18,
                3.024000e-17, 1.272000e-15, 7.896000e-13, 2.614500e-12, 6.272700e-12, 9.400000e-12, 1.764000e-11, 1.999800e-11, 1.484000e-11, 8.375000e-12, 4.944000e-12, 1.472986e-10, 6.458400e-10, 3.599360e-09, 1.876000e-09, 4.547400e-09,
                1.057500e-09, 3.880800e-09, 1.687760e-08, 3.793200e-09, 1.656000e-09, 5.357900e-09, 7.628700e-10, 1.374480e-09, 1.007130e-09, 1.363160e-09, 2.998080e-09, 4.714720e-09, 2.420000e-30, 3.620000e-30, 5.170000e-31, 1.020000e-29,
                5.520000e-30, 1.200000e-29, 1.150000e-30, 3.390000e-30, 1.590000e-30, 5.190000e-30, 1.280000e-29, 8.070000e-30, 1.050000e-29, 3.730000e-29, 3.340000e-29, 9.390000e-31, 2.340000e-30, 5.840000e-30, 5.940000e-30, 1.040000e-30,
                1.040000e-30, 5.300000e-29, 7.560000e-30, 1.250000e-30, 1.040000e-30, 3.600000e-29, 2.460000e-29, 1.830000e-29, 1.570000e-30, 1.700000e-30, 1.310000e-30, 7.210000e-30, 1.310000e-30, 1.310000e-30, 1.310000e-30, 6.210000e-30,
                1.310000e-30, 1.310000e-30, 9.150000e-31, 7.840000e-31, 1.030000e-30, 2.660000e-30, 1.120000e-30, 1.240000e-30, 1.820000e-30, 1.900000e-30, 7.400000e-30, 3.020000e-27, 3.670000e-29, 1.360000e-29, 1.610000e-29, 1.320000e-29,
                1.410000e-29, 3.110000e-29, 1.060000e-29, 1.370000e-29, 1.020000e-29, 1.140000e-29, 7.290000e-29, 2.200000e-29, 1.590000e-29, 2.210000e-29, 1.240000e-29, 1.990000e-29, 3.090000e-29, 2.570000e-29, 2.740000e-29, 3.100000e-29,
                7.600000e-29, 1.010000e-28, 1.300000e-28, 1.820000e-28, 1.330000e-28, 1.660000e-28, 2.900000e-28, 3.600000e-28, 4.750000e-28, 6.400000e-28, 5.490000e-28, 1.190000e-27, 1.760000e-27, 2.320000e-27, 1.440000e-27, 1.830000e-27,
                1.340000e-27, 2.620000e-27, 2.880000e-27, 3.140000e-27, 3.810000e-27, 4.430000e-27, 4.950000e-27, 5.940000e-27, 6.590000e-27, 7.260000e-27, 9.850000e-27, 1.270000e-26, 1.010000e-26, 1.200000e-26, 1.440000e-26, 1.800000e-26,
                2.080000e-26, 2.450000e-26, 5.090000e-26, 7.120000e-26, 9.230000e-26, 8.420000e-26, 1.200000e-25, 1.220000e-25, 1.770000e-25, 1.600000e-25, 1.960000e-25, 2.400000e-25, 2.250000e-25, 2.210000e-25, 2.320000e-25, 2.500000e-25,
                2.730000e-25, 2.880000e-25, 3.020000e-25, 3.970000e-25, 7.130000e-25, 4.370000e-25, 1.120000e-24, 1.250000e-24, 1.160000e-24, 1.190000e-24, 1.380000e-24, 1.700000e-24, 2.460000e-24, 3.900000e-24, 3.990000e-24, 3.860000e-24,
                5.080000e-24, 5.920000e-24, 6.050000e-24, 6.940000e-24, 8.120000e-24, 9.710000e-24, 8.970000e-24, 9.440000e-24, 1.010000e-23, 1.030000e-23, 1.030000e-23, 1.040000e-23, 1.180000e-23, 1.230000e-23, 1.240000e-23, 1.170000e-23,
                1.110000e-23, 1.090000e-23, 1.190000e-23, 1.540000e-23, 1.900000e-23, 1.990000e-23, 1.990000e-23, 2.020000e-23, 2.010000e-23, 1.940000e-23, 1.980000e-23, 2.250000e-23, 2.390000e-23, 2.480000e-23, 2.490000e-23, 2.480000e-23,
                2.500000e-23, 2.550000e-23, 2.610000e-23, 2.590000e-23, 2.460000e-23, 2.440000e-23, 2.530000e-23, 2.480000e-23, 2.490000e-23, 2.500000e-23, 2.430000e-23, 2.430000e-23, 2.520000e-23, 2.580000e-23, 2.640000e-23, 2.670000e-23,
                2.700000e-23, 2.680000e-23, 2.660000e-23, 2.660000e-23, 2.670000e-23, 2.670000e-23, 2.690000e-23, 2.710000e-23, 2.710000e-23, 2.710000e-23, 2.720000e-23, 2.720000e-23, 2.710000e-23, 2.700000e-23, 2.700000e-23, 2.700000e-23,
                2.690000e-23, 2.680000e-23, 2.670000e-23, 2.660000e-23, 2.650000e-23, 3.950000e-23, 5.220000e-23, 5.180000e-23, 5.140000e-23, 5.090000e-23, 5.040000e-23, 4.990000e-23, 4.940000e-23, 4.900000e-23, 4.830000e-23, 4.800000e-23,
                4.670000e-23, 4.590000e-23, 4.680000e-23, 4.540000e-23, 4.600000e-23, 4.530000e-23, 4.410000e-23, 4.340000e-23, 4.310000e-23, 4.030000e-23, 4.330000e-23, 4.250000e-23, 4.270000e-23, 4.230000e-23, 4.130000e-23, 4.010000e-23,
                3.890000e-23, 3.880000e-23, 3.780000e-23, 3.760000e-23, 3.720000e-23, 3.720000e-23, 3.790000e-23, 3.790000e-23, 7.490000e-23, 2.110000e-22, 1.680000e-22, 1.600000e-22, 1.500000e-22, 1.480000e-22, 1.430000e-22, 1.320000e-22,
                1.250000e-22, 1.160000e-22, 1.120000e-22, 1.070000e-22, 9.950000e-23, 9.720000e-23, 9.200000e-23, 8.240000e-23, 7.700000e-23, 6.940000e-23, 6.510000e-23, 6.190000e-23, 7.460000e-23, 1.110000e-22, 8.280000e-23, 7.330000e-23,
                6.830000e-23, 6.070000e-23, 5.500000e-23, 4.960000e-23, 4.510000e-23, 4.090000e-23, 3.740000e-23, 3.400000e-23, 3.180000e-23, 2.870000e-23, 2.700000e-23, 2.470000e-23, 2.310000e-23, 2.140000e-23, 2.010000e-23, 1.870000e-23,
                1.710000e-23, 1.600000e-23, 1.480000e-23, 1.410000e-23, 1.330000e-23, 1.250000e-23, 1.160000e-23, 1.060000e-23, 9.670000e-24, 9.250000e-24, 2.840000e-23, 6.740000e-23, 3.350000e-23, 2.220000e-23, 1.590000e-23, 4.530000e-23)

            solar_flux_He_active = (0.00000000e+00, 5.73300000e-22, 3.66275000e-19, 1.31986400e-17,
                1.92628800e-16, 8.10264000e-15, 5.02975200e-12, 1.66543650e-11, 1.56051400e-11, 2.20184750e-11, 4.11586205e-11, 4.61956903e-11, 3.45108863e-11, 1.96062713e-11, 1.21257858e-11, 4.01078405e-10, 2.91273840e-09, 1.91110325e-08, 6.42652539e-09, 2.30184974e-08,
                2.88195872e-09, 8.65422135e-09, 4.73335014e-08, 9.77979821e-09, 3.62188630e-09, 1.53356436e-08, 1.64424010e-09, 3.15349531e-09, 2.41711200e-09, 3.27158400e-09, 7.14588242e-09, 1.07100542e-08, 5.41049746e-30, 7.40390413e-30, 1.00717661e-30, 1.91978701e-29,
                1.02407621e-29, 2.29338134e-29, 2.23050971e-30, 6.69335930e-30, 3.44523552e-30, 1.02397078e-29, 3.15008000e-29, 2.00407286e-29, 2.54454549e-29, 8.98930000e-29, 8.04940000e-29, 2.26299000e-30, 5.63940000e-30, 1.14935663e-29, 1.16749334e-29, 2.04139267e-30,
                2.03868926e-30, 1.23916585e-28, 1.77798931e-29, 2.94339392e-30, 2.45129776e-30, 8.49216727e-29, 4.41467500e-29, 3.14760000e-29, 2.70040000e-30, 2.92400000e-30, 2.25320000e-30, 1.32664000e-29, 2.41040000e-30, 2.41040000e-30, 2.41040000e-30, 1.14264000e-29,
                2.48840577e-30, 2.49428298e-30, 1.72551196e-30, 1.46846826e-30, 1.91797311e-30, 4.91927273e-30, 2.07651613e-30, 2.67716000e-30, 4.21341047e-30, 4.32557537e-30, 1.65980653e-29, 6.67222180e-27, 7.96721358e-29, 2.92097334e-29, 3.44710025e-29, 2.81843418e-29,
                3.00112713e-29, 6.59861295e-29, 2.24192337e-29, 2.79112339e-29, 1.90580252e-29, 2.12575091e-29, 1.35629445e-28, 4.10842038e-29, 2.98461330e-29, 4.44028899e-29, 2.52814910e-29, 3.97138600e-29, 6.03326451e-29, 5.04564735e-29, 5.42683634e-29, 5.96259593e-29,
                1.36816196e-28, 1.67186438e-28, 2.16437915e-28, 3.04846835e-28, 2.24112737e-28, 2.56713383e-28, 4.38445113e-28, 5.35305755e-28, 6.98363665e-28, 9.13915152e-28, 7.63756550e-28, 1.58537874e-27, 2.26708881e-27, 2.79847299e-27, 1.71584107e-27, 2.16665070e-27,
                1.57633307e-27, 3.06086090e-27, 3.34128117e-27, 3.63867920e-27, 4.41047548e-27, 5.12249570e-27, 5.71741844e-27, 6.85326602e-27, 7.59423248e-27, 8.35644995e-27, 1.12840383e-26, 1.43289056e-26, 1.12957716e-26, 1.33023141e-26, 1.58132131e-26, 1.95795617e-26,
                2.25478353e-26, 2.63211187e-26, 5.34450000e-26, 7.47600000e-26, 9.59563367e-26, 8.67260000e-26, 1.23600000e-25, 1.25660000e-25, 1.82310000e-25, 1.64800000e-25, 2.01880000e-25, 2.47200000e-25, 2.31750000e-25, 2.27630000e-25, 2.38960000e-25, 2.57500000e-25,
                2.81190000e-25, 2.95645412e-25, 3.05020000e-25, 4.00968627e-25, 7.20125067e-25, 4.41365417e-25, 1.13118402e-24, 1.26247743e-24, 1.17157454e-24, 1.20186912e-24, 1.39375853e-24, 1.71694174e-24, 2.48450506e-24, 3.93883177e-24, 4.02970977e-24, 3.89839761e-24,
                5.13050893e-24, 5.97883072e-24, 6.11009122e-24, 7.00889357e-24, 8.20056357e-24, 9.80628646e-24, 9.05889997e-24, 9.53350703e-24, 1.01999900e-23, 1.04019143e-23, 1.04018586e-23, 1.05027914e-23, 1.19165649e-23, 1.24214376e-23, 1.25223578e-23, 1.18153873e-23,
                1.12094100e-23, 1.10073797e-23, 1.20171668e-23, 1.55515443e-23, 1.91868676e-23, 2.00956116e-23, 2.00955041e-23, 2.03983422e-23, 2.02972516e-23, 1.95902773e-23, 1.99940935e-23, 2.27204392e-23, 2.41340262e-23, 2.50427049e-23, 2.51435489e-23, 2.50424368e-23,
                2.52442568e-23, 2.57490041e-23, 2.63547219e-23, 2.61526300e-23, 2.48398168e-23, 2.46377351e-23, 2.55463673e-23, 2.50413643e-23, 2.51422030e-23, 2.52430405e-23, 2.45361041e-23, 2.45359727e-23, 2.54445762e-23, 2.60502600e-23, 2.66559373e-23, 2.69587014e-23,
                2.72614622e-23, 2.70593805e-23, 2.68573011e-23, 2.68571573e-23, 2.69579797e-23, 2.69578354e-23, 2.71596214e-23, 2.73614051e-23, 2.73612586e-23, 2.73611122e-23, 2.74619286e-23, 2.74617816e-23, 2.73606727e-23, 2.72595649e-23, 2.72594189e-23, 2.72592730e-23,
                2.71581673e-23, 2.70570627e-23, 2.69559592e-23, 2.68548568e-23, 2.67537554e-23, 3.98780257e-23, 5.26991449e-23, 5.22947600e-23, 5.18903838e-23, 5.13850632e-23, 5.08797535e-23, 5.03744546e-23, 4.98691665e-23, 4.94648378e-23, 4.87576751e-23, 4.84543135e-23,
                4.71415043e-23, 4.63334449e-23, 4.72414378e-23, 4.58277416e-23, 4.64328973e-23, 4.57258200e-23, 4.45140632e-23, 4.38070216e-23, 4.35037422e-23, 4.06770773e-23, 4.37046795e-23, 4.28967432e-23, 4.30981486e-23, 4.26939616e-23, 4.16842016e-23, 4.04726049e-23,
                3.92610341e-23, 3.91596865e-23, 3.81500076e-23, 3.79477492e-23, 3.75436476e-23, 3.75432454e-23, 3.82492946e-23, 3.82488849e-23, 7.55886751e-23, 2.12935497e-22, 1.69530162e-22, 1.61448649e-22, 1.51350000e-22, 1.49324000e-22, 1.44271541e-22, 1.33166595e-22,
                1.26097973e-22, 1.17012649e-22, 1.12971676e-22, 1.07922514e-22, 1.00352473e-22, 9.80275135e-23, 9.27782703e-23, 8.30926054e-23, 7.76430541e-23, 6.99758324e-23, 6.56366351e-23, 6.24069108e-23, 7.52068811e-23, 1.11895500e-22, 8.34579243e-23, 7.38745135e-23,
                6.88279405e-23, 6.11626324e-23, 5.54132432e-23, 4.99673081e-23, 4.54291081e-23, 4.11940378e-23, 3.76648324e-23, 3.42370811e-23, 3.20183027e-23, 2.88939189e-23, 2.71795135e-23, 2.48615514e-23, 2.32485892e-23, 2.15353405e-23, 2.02249459e-23, 1.88142216e-23,
                1.72026000e-23, 1.60942703e-23, 1.48856000e-23, 1.41800270e-23, 1.33740486e-23, 1.25682432e-23, 1.16620757e-23, 1.06555784e-23, 9.71965676e-24, 9.29650000e-24, 2.85396973e-23, 6.77078541e-23, 3.36086486e-23, 2.22480000e-23, 1.59171892e-23, 4.53000000e-23)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_He, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_He_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "Ne"
        if wvl_range == (1.0, 95000.0)
            flux_quiet = (0.00000000e+00, 3.21007477e-13, 1.75914424e-10, 5.95957359e-09,
                8.37410809e-08, 3.41942747e-06, 9.51159111e-05, 2.99258057e-04, 5.94189492e-04, 7.81699729e-04, 1.33985730e-03, 1.40475663e-03, 9.70466082e-04, 5.08843374e-04, 2.81230463e-04, 7.76611295e-03, 2.76240891e-02, 1.29746337e-01, 5.58506487e-02, 1.15148639e-01,
                2.14324829e-02, 7.46900658e-02, 2.91391048e-01, 5.91607475e-02, 2.32643190e-02, 6.81821044e-02, 9.22268438e-03, 1.43008831e-02, 8.97564819e-03, 1.03806374e-02, 2.04746943e-02, 2.87776225e-02, 1.05126459e-02, 1.48413620e-02, 1.97830162e-03, 5.93165990e-23,
                3.21007477e-23, 6.97842341e-23, 6.68765577e-24, 1.97140461e-23, 9.24641102e-24, 3.01816813e-23, 7.44365164e-23, 4.69298974e-23, 6.10612049e-23, 2.16912661e-22, 1.94232785e-22, 5.46061632e-24, 1.36079257e-23, 3.39616606e-23, 3.45431959e-23, 6.04796696e-24,
                6.04796696e-24, 3.08213701e-22, 4.39640675e-23, 7.26919105e-24, 6.04796696e-24, 2.09352702e-22, 1.43057680e-22, 1.06420957e-22, 9.13010396e-24, 9.88609983e-24, 7.61811222e-24, 4.19286940e-23, 7.61811222e-24, 7.61811222e-24, 7.61811222e-24, 3.61133412e-23,
                7.61811222e-24, 7.61811222e-24, 5.32104785e-24, 4.55923663e-24, 5.98981343e-24, 1.54688386e-23, 6.51319518e-24, 7.21103753e-24, 1.05839422e-23, 1.10491704e-23, 4.30336110e-23, 1.75623656e-20, 2.13423449e-22, 7.90887987e-23, 9.36271808e-23, 7.67626575e-23,
                8.19964751e-23, 1.80857473e-22, 6.16427401e-23, 7.96703339e-23, 5.93165990e-23, 6.62950224e-23, 4.23939222e-22, 1.27937763e-22, 9.24641102e-23, 1.28519298e-22, 7.21103753e-23, 1.15725522e-22, 1.79694403e-22, 1.49454568e-22, 1.59340668e-22, 1.80275938e-22,
                4.41966816e-22, 5.87350637e-22, 7.55995870e-22, 1.05839422e-21, 7.73441928e-22, 9.65348572e-22, 1.68645232e-21, 2.09352702e-21, 2.76229260e-21, 3.72182582e-21, 3.19262871e-21, 6.92026988e-21, 1.02350210e-20, 1.34916186e-20, 8.37410809e-21, 1.06420957e-20,
                7.79257281e-21, 1.52362244e-20, 1.67482162e-20, 1.82602079e-20, 2.21564943e-20, 2.57620131e-20, 2.87859966e-20, 3.45431959e-20, 3.83231752e-20, 4.22194616e-20, 5.72812255e-20, 7.38549811e-20, 5.87350637e-20, 6.97842341e-20, 8.37410809e-20, 1.04676351e-19,
                1.20959339e-19, 1.42476145e-19, 2.96001460e-19, 4.14053122e-19, 5.36757067e-19, 4.89652709e-19, 6.97842341e-19, 7.09473047e-19, 1.02931745e-18, 9.30456455e-19, 1.13980916e-18, 1.39568468e-18, 1.30845439e-18, 1.28519298e-18, 1.34916186e-18, 1.45383821e-18,
                1.58759133e-18, 1.67482162e-18, 1.75623656e-18, 2.30869508e-18, 4.14634658e-18, 2.54130919e-18, 6.51319518e-18, 7.26919105e-18, 6.74580930e-18, 6.92026988e-18, 8.02518692e-18, 9.88609983e-18, 1.43057680e-17, 2.26798761e-17, 2.32032578e-17, 2.24472620e-17,
                2.95419924e-17, 3.44268888e-17, 3.51828847e-17, 4.03585487e-17, 4.72206651e-17, 5.64670761e-17, 5.21637150e-17, 5.48969308e-17, 5.87350637e-17, 5.98981343e-17, 5.98981343e-17, 6.04796696e-17, 6.86211635e-17, 7.15288400e-17, 7.21103753e-17, 6.80396283e-17,
                6.45504166e-17, 6.33873460e-17, 6.92026988e-17, 8.95564338e-17, 1.10491704e-16, 1.15725522e-16, 1.15725522e-16, 1.17470127e-16, 1.16888592e-16, 1.12817845e-16, 1.15143986e-16, 1.30845439e-16, 1.38986933e-16, 1.44220751e-16, 1.44802286e-16, 1.44220751e-16,
                1.45383821e-16, 1.48291497e-16, 1.51780709e-16, 1.50617639e-16, 1.43057680e-16, 1.41894609e-16, 1.47128427e-16, 1.44220751e-16, 1.44802286e-16, 1.45383821e-16, 1.41313074e-16, 1.41313074e-16, 1.46546892e-16, 1.50036103e-16, 1.53525315e-16, 1.55269921e-16,
                1.57014527e-16, 1.55851456e-16, 1.54688386e-16, 1.54688386e-16, 1.55269921e-16, 1.55269921e-16, 1.56432991e-16, 1.57596062e-16, 1.57596062e-16, 1.57596062e-16, 1.58177597e-16, 1.58177597e-16, 1.57596062e-16, 1.57014527e-16, 1.57014527e-16, 1.57014527e-16,
                1.56432991e-16, 1.55851456e-16, 1.55269921e-16, 1.54688386e-16, 1.54106850e-16, 2.29706437e-16, 3.03561418e-16, 3.01235277e-16, 2.98909136e-16, 2.96001460e-16, 2.93093783e-16, 2.90186107e-16, 2.87278430e-16, 2.84952289e-16, 2.80881542e-16, 2.79136936e-16,
                2.71576978e-16, 2.66924695e-16, 2.72158513e-16, 2.64017019e-16, 2.67506231e-16, 2.63435484e-16, 2.56457060e-16, 2.52386313e-16, 2.50641708e-16, 2.34358720e-16, 2.51804778e-16, 2.47152496e-16, 2.48315566e-16, 2.45989425e-16, 2.40174072e-16, 2.33195649e-16,
                2.26217226e-16, 2.25635690e-16, 2.19820337e-16, 2.18657267e-16, 2.16331126e-16, 2.16331126e-16, 2.20401873e-16, 2.20401873e-16, 4.35569928e-16, 1.22703945e-15, 9.76979278e-16, 9.30456455e-16, 8.72302926e-16, 8.60672221e-16, 8.31595457e-16, 7.67626575e-16,
                7.26919105e-16, 6.74580930e-16, 6.51319518e-16, 6.22242754e-16, 5.78627608e-16, 5.65252296e-16, 5.35012462e-16, 4.79185074e-16, 4.47782169e-16, 4.03585487e-16, 3.78579470e-16, 3.59970341e-16, 4.33825322e-16, 6.45504166e-16, 4.81511215e-16, 4.26265363e-16,
                3.97188599e-16, 3.52991918e-16, 3.19844406e-16, 2.88441501e-16, 2.62272413e-16, 2.37847931e-16, 2.17494196e-16, 1.97721997e-16, 1.84928220e-16, 1.66900627e-16, 1.57014527e-16, 1.43639215e-16, 1.34334651e-16, 1.24448551e-16, 1.16888592e-16, 1.08747098e-16,
                9.94425336e-17, 9.30456455e-17, 8.60672221e-17, 8.19964751e-17, 7.73441928e-17, 7.26919105e-17, 6.74580930e-17, 6.16427401e-17, 5.62344620e-17, 5.37920138e-17, 1.65156021e-16, 3.91954782e-16, 1.94814320e-16, 1.29100833e-16, 9.24641102e-17, 2.63435484e-16)

            flux_active = (0.00000000e+00, 6.12780032e-13, 3.35807898e-10, 1.13763945e-08,
                1.59855661e-07, 6.52743947e-06, 1.81569388e-04, 5.71261965e-04, 4.42984104e-04, 5.48718204e-04, 9.36851593e-04, 9.72447161e-04, 6.76320572e-04, 3.56980375e-04, 2.06701590e-04, 6.33700993e-03, 3.73348604e-02, 2.06444823e-01, 5.73352407e-02, 1.74671740e-01,
                1.75037012e-02, 4.99136815e-02, 2.44897399e-01, 4.57096430e-02, 1.52480690e-02, 5.84827558e-02, 5.95692415e-03, 9.83256092e-03, 6.45545842e-03, 7.46595364e-03, 1.46244688e-02, 1.95902825e-02, 7.04342500e-03, 9.09653507e-03, 1.15493520e-03, 3.34563950e-23,
                1.78467185e-23, 3.99670753e-23, 3.88714028e-24, 1.16646103e-23, 6.00405982e-24, 1.78448811e-23, 5.48968820e-23, 3.49252563e-23, 4.43441479e-23, 1.56657781e-22, 1.40278013e-22, 3.94374413e-24, 9.82786076e-24, 2.00299978e-23, 2.03460686e-23, 3.55756338e-24,
                3.55285212e-24, 2.15951156e-22, 3.09852669e-23, 5.12949349e-24, 4.27191067e-24, 1.47994179e-22, 7.69351548e-23, 5.48536627e-23, 4.70602461e-24, 5.09569544e-24, 3.92668296e-24, 2.31195397e-23, 4.20063758e-24, 4.20063758e-24, 4.20063758e-24, 1.99129461e-23,
                4.33657933e-24, 4.34682162e-24, 3.00707368e-24, 2.55912005e-24, 3.34247840e-24, 8.57288496e-24, 3.61877352e-24, 4.66552394e-24, 7.34276899e-24, 7.53824031e-24, 2.89256790e-23, 1.16277737e-20, 1.38845738e-22, 5.09042083e-23, 6.00730952e-23, 4.91172442e-23,
                5.23010595e-23, 1.14994945e-22, 3.90703101e-23, 4.86412952e-23, 3.32126855e-23, 3.70457566e-23, 2.36363318e-22, 7.15980129e-23, 5.20132708e-23, 7.73815334e-23, 4.40584058e-23, 6.92098958e-23, 1.05142539e-22, 8.79311977e-23, 9.45742312e-23, 1.03910988e-22,
                2.38431486e-22, 2.91358128e-22, 3.77189363e-22, 5.31260816e-22, 3.90564382e-22, 4.47377981e-22, 7.64084392e-22, 9.32884780e-22, 1.21704807e-21, 1.59269264e-21, 1.33100915e-21, 2.76286156e-21, 3.95088718e-21, 4.87693777e-21, 2.99022008e-21, 3.77585229e-21,
                2.74709755e-21, 5.33420483e-21, 5.82289713e-21, 6.34117682e-21, 7.68619691e-21, 8.92704445e-21, 9.96382459e-21, 1.19432819e-20, 1.32345745e-20, 1.45629015e-20, 1.96648505e-20, 2.49711829e-20, 1.96852982e-20, 2.31821276e-20, 2.75579063e-20, 3.41215743e-20,
                3.92944260e-20, 4.58701794e-20, 9.31393443e-20, 1.30285291e-19, 1.67224442e-19, 1.51138606e-19, 2.15399438e-19, 2.18989429e-19, 3.17714171e-19, 2.87199251e-19, 3.51819082e-19, 4.30798876e-19, 4.03873946e-19, 3.96693965e-19, 4.16438913e-19, 4.48748829e-19,
                4.90033721e-19, 5.15225369e-19, 5.31562593e-19, 6.98773599e-19, 1.25497196e-18, 7.69173647e-19, 1.97133011e-18, 2.20013697e-18, 2.04171924e-18, 2.09451403e-18, 2.42892235e-18, 2.99213824e-18, 4.32978150e-18, 6.86425688e-18, 7.02263123e-18, 6.79379170e-18, 
                8.94100922e-18, 1.04193914e-17, 1.06481409e-17, 1.22144962e-17, 1.42912361e-17, 1.70895517e-17, 1.57870709e-17, 1.66141752e-17, 1.77756643e-17, 1.81275607e-17, 1.81274636e-17, 1.83033605e-17, 2.07671632e-17, 2.16470119e-17, 2.18228871e-17, 2.05908397e-17, 
                1.95347946e-17, 1.91827136e-17, 2.09424835e-17, 2.71018924e-17, 3.34372208e-17, 3.50209017e-17, 3.50207142e-17, 3.55484744e-17, 3.53723025e-17, 3.41402485e-17, 3.48439847e-17, 3.95952252e-17, 4.20587029e-17, 4.36422698e-17, 4.38180122e-17, 4.36418026e-17, 
                4.39935171e-17, 4.48731473e-17, 4.59287401e-17, 4.55765518e-17, 4.32886939e-17, 4.29365235e-17, 4.45200094e-17, 4.36399337e-17, 4.38156666e-17, 4.39913976e-17, 4.27594096e-17, 4.27591807e-17, 4.43426166e-17, 4.53981502e-17, 4.64536724e-17, 4.69813035e-17, 
                4.75089290e-17, 4.71567586e-17, 4.68045919e-17, 4.68043413e-17, 4.69800460e-17, 4.69797945e-17, 4.73314496e-17, 4.76831010e-17, 4.76828457e-17, 4.76825905e-17, 4.78582848e-17, 4.78580285e-17, 4.76818246e-17, 4.75056226e-17, 4.75053682e-17, 4.75051139e-17, 
                4.73289156e-17, 4.71527192e-17, 4.69765247e-17, 4.68003321e-17, 4.66241414e-17, 6.94959896e-17, 9.18395322e-17, 9.11348051e-17, 9.04300930e-17, 8.95494639e-17, 8.86688536e-17, 8.77882622e-17, 8.69076896e-17, 8.62030604e-17, 8.49706781e-17, 8.44420056e-17, 
                8.21541548e-17, 8.07459384e-17, 8.23283103e-17, 7.98646423e-17, 8.09192555e-17, 7.96870221e-17, 7.75752767e-17, 7.63431055e-17, 7.58145761e-17, 7.08885080e-17, 7.61647523e-17, 7.47567507e-17, 7.51077427e-17, 7.44033603e-17, 7.26436375e-17, 7.05321710e-17, 
                6.84207497e-17, 6.82441299e-17, 6.64845484e-17, 6.61320700e-17, 6.54278364e-17, 6.54271356e-17, 6.66575773e-17, 6.66568633e-17, 1.31729435e-16, 3.71085651e-16, 2.95442570e-16, 2.81358804e-16, 2.63759749e-16, 2.60229010e-16, 2.51424019e-16, 2.32071275e-16, 
                2.19752690e-16, 2.03919569e-16, 1.96877309e-16, 1.88078064e-16, 1.74885649e-16, 1.70833910e-16, 1.61685981e-16, 1.44806638e-16, 1.35309629e-16, 1.21947856e-16, 1.14385876e-16, 1.08757391e-16, 1.31064077e-16, 1.95001843e-16, 1.45443285e-16, 1.28742141e-16, 
                1.19947409e-16, 1.06588970e-16, 9.65694292e-17, 8.70787223e-17, 7.91699381e-17, 7.17894223e-17, 6.56390270e-17, 5.96654371e-17, 5.57987411e-17, 5.03538341e-17, 4.73661160e-17, 4.33265711e-17, 4.05156395e-17, 3.75299373e-17, 3.52462944e-17, 3.27878055e-17, 
                2.99792101e-17, 2.80477085e-17, 2.59413420e-17, 2.47117302e-17, 2.33071405e-17, 2.19028522e-17, 2.03236614e-17, 1.85696245e-17, 1.69385809e-17, 1.62011398e-17, 4.97365272e-17, 1.17995418e-16, 5.85702591e-17, 3.87718988e-17, 2.77391068e-17, 7.89449396e-17)

        else

            solar_flux_Ne = (0.00000e+00, 5.52000e-20, 3.02500e-17, 1.02480e-15, 1.44000e-14,
                5.88000e-13, 1.63560e-11, 5.14600e-11, 1.02176e-10, 1.34420e-10, 2.30400e-10, 2.41560e-10, 1.66880e-10, 8.75000e-11, 4.83600e-11, 1.33545e-09, 4.75020e-09, 2.23110e-08, 9.60400e-09, 1.98008e-08, 3.68550e-09, 1.28436e-08, 5.01072e-08, 1.01732e-08, 4.00050e-09,
                1.17245e-08, 1.58592e-09, 2.45916e-09, 1.54344e-09, 1.78504e-09, 3.52080e-09, 4.94856e-09, 1.80774e-09, 2.55210e-09, 3.40186e-10, 1.02000e-29, 5.52000e-30, 1.20000e-29, 1.15000e-30, 3.39000e-30, 1.59000e-30, 5.19000e-30, 1.28000e-29, 8.07000e-30, 1.05000e-29,
                3.73000e-29, 3.34000e-29, 9.39000e-31, 2.34000e-30, 5.84000e-30, 5.94000e-30, 1.04000e-30, 1.04000e-30, 5.30000e-29, 7.56000e-30, 1.25000e-30, 1.04000e-30, 3.60000e-29, 2.46000e-29, 1.83000e-29, 1.57000e-30, 1.70000e-30, 1.31000e-30, 7.21000e-30, 1.31000e-30,
                1.31000e-30, 1.31000e-30, 6.21000e-30, 1.31000e-30, 1.31000e-30, 9.15000e-31, 7.84000e-31, 1.03000e-30, 2.66000e-30, 1.12000e-30, 1.24000e-30, 1.82000e-30, 1.90000e-30, 7.40000e-30, 3.02000e-27, 3.67000e-29, 1.36000e-29, 1.61000e-29, 1.32000e-29, 1.41000e-29,
                3.11000e-29, 1.06000e-29, 1.37000e-29, 1.02000e-29, 1.14000e-29, 7.29000e-29, 2.20000e-29, 1.59000e-29, 2.21000e-29, 1.24000e-29, 1.99000e-29, 3.09000e-29, 2.57000e-29, 2.74000e-29, 3.10000e-29, 7.60000e-29, 1.01000e-28, 1.30000e-28, 1.82000e-28, 1.33000e-28,
                1.66000e-28, 2.90000e-28, 3.60000e-28, 4.75000e-28, 6.40000e-28, 5.49000e-28, 1.19000e-27, 1.76000e-27, 2.32000e-27, 1.44000e-27, 1.83000e-27, 1.34000e-27, 2.62000e-27, 2.88000e-27, 3.14000e-27, 3.81000e-27, 4.43000e-27, 4.95000e-27, 5.94000e-27, 6.59000e-27,
                7.26000e-27, 9.85000e-27, 1.27000e-26, 1.01000e-26, 1.20000e-26, 1.44000e-26, 1.80000e-26, 2.08000e-26, 2.45000e-26, 5.09000e-26, 7.12000e-26, 9.23000e-26, 8.42000e-26, 1.20000e-25, 1.22000e-25, 1.77000e-25, 1.60000e-25, 1.96000e-25, 2.40000e-25, 2.25000e-25,
                2.21000e-25, 2.32000e-25, 2.50000e-25, 2.73000e-25, 2.88000e-25, 3.02000e-25, 3.97000e-25, 7.13000e-25, 4.37000e-25, 1.12000e-24, 1.25000e-24, 1.16000e-24, 1.19000e-24, 1.38000e-24, 1.70000e-24, 2.46000e-24, 3.90000e-24, 3.99000e-24, 3.86000e-24, 5.08000e-24,
                5.92000e-24, 6.05000e-24, 6.94000e-24, 8.12000e-24, 9.71000e-24, 8.97000e-24, 9.44000e-24, 1.01000e-23, 1.03000e-23, 1.03000e-23, 1.04000e-23, 1.18000e-23, 1.23000e-23, 1.24000e-23, 1.17000e-23, 1.11000e-23, 1.09000e-23, 1.19000e-23, 1.54000e-23, 1.90000e-23,
                1.99000e-23, 1.99000e-23, 2.02000e-23, 2.01000e-23, 1.94000e-23, 1.98000e-23, 2.25000e-23, 2.39000e-23, 2.48000e-23, 2.49000e-23, 2.48000e-23, 2.50000e-23, 2.55000e-23, 2.61000e-23, 2.59000e-23, 2.46000e-23, 2.44000e-23, 2.53000e-23, 2.48000e-23, 2.49000e-23, 
                2.50000e-23, 2.43000e-23, 2.43000e-23, 2.52000e-23, 2.58000e-23, 2.64000e-23, 2.67000e-23, 2.70000e-23, 2.68000e-23, 2.66000e-23, 2.66000e-23, 2.67000e-23, 2.67000e-23, 2.69000e-23, 2.71000e-23, 2.71000e-23, 2.71000e-23, 2.72000e-23, 2.72000e-23, 2.71000e-23,
                2.70000e-23, 2.70000e-23, 2.70000e-23, 2.69000e-23, 2.68000e-23, 2.67000e-23, 2.66000e-23, 2.65000e-23, 3.95000e-23, 5.22000e-23, 5.18000e-23, 5.14000e-23, 5.09000e-23, 5.04000e-23, 4.99000e-23, 4.94000e-23, 4.90000e-23, 4.83000e-23, 4.80000e-23, 4.67000e-23,
                4.59000e-23, 4.68000e-23, 4.54000e-23, 4.60000e-23, 4.53000e-23, 4.41000e-23, 4.34000e-23, 4.31000e-23, 4.03000e-23, 4.33000e-23, 4.25000e-23, 4.27000e-23, 4.23000e-23, 4.13000e-23, 4.01000e-23, 3.89000e-23, 3.88000e-23, 3.78000e-23, 3.76000e-23, 3.72000e-23,
                3.72000e-23, 3.79000e-23, 3.79000e-23, 7.49000e-23, 2.11000e-22, 1.68000e-22, 1.60000e-22, 1.50000e-22, 1.48000e-22, 1.43000e-22, 1.32000e-22, 1.25000e-22, 1.16000e-22, 1.12000e-22, 1.07000e-22, 9.95000e-23, 9.72000e-23, 9.20000e-23, 8.24000e-23, 7.70000e-23,
                6.94000e-23, 6.51000e-23, 6.19000e-23, 7.46000e-23, 1.11000e-22, 8.28000e-23, 7.33000e-23, 6.83000e-23, 6.07000e-23, 5.50000e-23, 4.96000e-23, 4.51000e-23, 4.09000e-23, 3.74000e-23, 3.40000e-23, 3.18000e-23, 2.87000e-23, 2.70000e-23, 2.47000e-23, 2.31000e-23,
                2.14000e-23, 2.01000e-23, 1.87000e-23, 1.71000e-23, 1.60000e-23, 1.48000e-23, 1.41000e-23, 1.33000e-23, 1.25000e-23, 1.16000e-23, 1.06000e-23, 9.67000e-24, 9.25000e-24, 2.84000e-23, 6.74000e-23, 3.35000e-23, 2.22000e-23, 1.59000e-23, 4.53000e-23)


            solar_flux_Ne_active = (0.00000000e+00, 3.51624000e-19, 1.92692500e-16, 6.52797600e-15,
                9.17280000e-14, 3.74556000e-12, 1.04187720e-10, 3.27800200e-10, 2.54192099e-10, 3.14864192e-10, 5.37581982e-10, 5.58007348e-10, 3.88084683e-10, 2.04841641e-10, 1.18609022e-10, 3.63628817e-09, 2.14234020e-08, 1.18461684e-07, 3.28999733e-08, 1.00229728e-07,
                1.00439327e-08, 2.86413516e-08, 1.40526451e-07, 2.62290001e-08, 8.74961119e-09, 3.35584377e-08, 3.41818824e-09, 5.64209703e-09, 3.70425600e-09, 4.28409600e-09, 8.39177835e-09, 1.12412499e-08, 4.04164161e-09, 5.21975241e-09, 6.62722208e-10, 1.91978701e-29,
                1.02407621e-29, 2.29338134e-29, 2.23050971e-30, 6.69335930e-30, 3.44523552e-30, 1.02397078e-29, 3.15008000e-29, 2.00407286e-29, 2.54454549e-29, 8.98930000e-29, 8.04940000e-29, 2.26299000e-30, 5.63940000e-30, 1.14935663e-29, 1.16749334e-29, 2.04139267e-30, 
                2.03868926e-30, 1.23916585e-28, 1.77798931e-29, 2.94339392e-30, 2.45129776e-30, 8.49216727e-29, 4.41467500e-29, 3.14760000e-29, 2.70040000e-30, 2.92400000e-30, 2.25320000e-30, 1.32664000e-29, 2.41040000e-30, 2.41040000e-30, 2.41040000e-30, 1.14264000e-29,
                2.48840577e-30, 2.49428298e-30, 1.72551196e-30, 1.46846826e-30, 1.91797311e-30, 4.91927273e-30, 2.07651613e-30, 2.67716000e-30, 4.21341047e-30, 4.32557537e-30, 1.65980653e-29, 6.67222180e-27, 7.96721358e-29, 2.92097334e-29, 3.44710025e-29, 2.81843418e-29,
                3.00112713e-29, 6.59861295e-29, 2.24192337e-29, 2.79112339e-29, 1.90580252e-29, 2.12575091e-29, 1.35629445e-28, 4.10842038e-29, 2.98461330e-29, 4.44028899e-29, 2.52814910e-29, 3.97138600e-29, 6.03326451e-29, 5.04564735e-29, 5.42683634e-29, 5.96259593e-29,
                1.36816196e-28, 1.67186438e-28, 2.16437915e-28, 3.04846835e-28, 2.24112737e-28, 2.56713383e-28, 4.38445113e-28, 5.35305755e-28, 6.98363665e-28, 9.13915152e-28, 7.63756550e-28, 1.58537874e-27, 2.26708881e-27, 2.79847299e-27, 1.71584107e-27, 2.16665070e-27,
                1.57633307e-27, 3.06086090e-27, 3.34128117e-27, 3.63867920e-27, 4.41047548e-27, 5.12249570e-27, 5.71741844e-27, 6.85326602e-27, 7.59423248e-27, 8.35644995e-27, 1.12840383e-26, 1.43289056e-26, 1.12957716e-26, 1.33023141e-26, 1.58132131e-26, 1.95795617e-26,
                2.25478353e-26, 2.63211187e-26, 5.34450000e-26, 7.47600000e-26, 9.59563367e-26, 8.67260000e-26, 1.23600000e-25, 1.25660000e-25, 1.82310000e-25, 1.64800000e-25, 2.01880000e-25, 2.47200000e-25, 2.31750000e-25, 2.27630000e-25, 2.38960000e-25, 2.57500000e-25,
                2.81190000e-25, 2.95645412e-25, 3.05020000e-25, 4.00968627e-25, 7.20125067e-25, 4.41365417e-25, 1.13118402e-24, 1.26247743e-24, 1.17157454e-24, 1.20186912e-24, 1.39375853e-24, 1.71694174e-24, 2.48450506e-24, 3.93883177e-24, 4.02970977e-24, 3.89839761e-24,
                5.13050893e-24, 5.97883072e-24, 6.11009122e-24, 7.00889357e-24, 8.20056357e-24, 9.80628646e-24, 9.05889997e-24, 9.53350703e-24, 1.01999900e-23, 1.04019143e-23, 1.04018586e-23, 1.05027914e-23, 1.19165649e-23, 1.24214376e-23, 1.25223578e-23, 1.18153873e-23,
                1.12094100e-23, 1.10073797e-23, 1.20171668e-23, 1.55515443e-23, 1.91868676e-23, 2.00956116e-23, 2.00955041e-23, 2.03983422e-23, 2.02972516e-23, 1.95902773e-23, 1.99940935e-23, 2.27204392e-23, 2.41340262e-23, 2.50427049e-23, 2.51435489e-23, 2.50424368e-23,
                2.52442568e-23, 2.57490041e-23, 2.63547219e-23, 2.61526300e-23, 2.48398168e-23, 2.46377351e-23, 2.55463673e-23, 2.50413643e-23, 2.51422030e-23, 2.52430405e-23, 2.45361041e-23, 2.45359727e-23, 2.54445762e-23, 2.60502600e-23, 2.66559373e-23, 2.69587014e-23,
                2.72614622e-23, 2.70593805e-23, 2.68573011e-23, 2.68571573e-23, 2.69579797e-23, 2.69578354e-23, 2.71596214e-23, 2.73614051e-23, 2.73612586e-23, 2.73611122e-23, 2.74619286e-23, 2.74617816e-23, 2.73606727e-23, 2.72595649e-23, 2.72594189e-23, 2.72592730e-23,
                2.71581673e-23, 2.70570627e-23, 2.69559592e-23, 2.68548568e-23, 2.67537554e-23, 3.98780257e-23, 5.26991449e-23, 5.22947600e-23, 5.18903838e-23, 5.13850632e-23, 5.08797535e-23, 5.03744546e-23, 4.98691665e-23, 4.94648378e-23, 4.87576751e-23, 4.84543135e-23,
                4.71415043e-23, 4.63334449e-23, 4.72414378e-23, 4.58277416e-23, 4.64328973e-23, 4.57258200e-23, 4.45140632e-23, 4.38070216e-23, 4.35037422e-23, 4.06770773e-23, 4.37046795e-23, 4.28967432e-23, 4.30981486e-23, 4.26939616e-23, 4.16842016e-23, 4.04726049e-23,
                3.92610341e-23, 3.91596865e-23, 3.81500076e-23, 3.79477492e-23, 3.75436476e-23, 3.75432454e-23, 3.82492946e-23, 3.82488849e-23, 7.55886751e-23, 2.12935497e-22, 1.69530162e-22, 1.61448649e-22, 1.51350000e-22, 1.49324000e-22, 1.44271541e-22, 1.33166595e-22,
                1.26097973e-22, 1.17012649e-22, 1.12971676e-22, 1.07922514e-22, 1.00352473e-22, 9.80275135e-23, 9.27782703e-23, 8.30926054e-23, 7.76430541e-23, 6.99758324e-23, 6.56366351e-23, 6.24069108e-23, 7.52068811e-23, 1.11895500e-22, 8.34579243e-23, 7.38745135e-23,
                6.88279405e-23, 6.11626324e-23, 5.54132432e-23, 4.99673081e-23, 4.54291081e-23, 4.11940378e-23, 3.76648324e-23, 3.42370811e-23, 3.20183027e-23, 2.88939189e-23, 2.71795135e-23, 2.48615514e-23, 2.32485892e-23, 2.15353405e-23, 2.02249459e-23, 1.88142216e-23,
                1.72026000e-23, 1.60942703e-23, 1.48856000e-23, 1.41800270e-23, 1.33740486e-23, 1.25682432e-23, 1.16620757e-23, 1.06555784e-23, 9.71965676e-24, 9.29650000e-24, 2.85396973e-23, 6.77078541e-23, 3.36086486e-23, 2.22480000e-23, 1.59171892e-23, 4.53000000e-23)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_Ne, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_Ne_active, wvl_range[1], wvl_range[2])
        end

    else
        error("Unknown parent_type: $parent_type")
    end

    # Interpolate between quiet and active
    normalized_fluxes = (1 - sun_mode) .* flux_quiet .+ sun_mode .* flux_active

    # Generate photon energy and wavelength vectors (size 1 if num_reactions is 1, vector otherwise)
    photon_wvl, photon_energy = generate_energy_vector(wavelengths, normalized_fluxes, num_reactions)
    return photon_energy, photon_wvl

end

end