module solar_spectrum

using Interpolations

export flux_outputs

const c = 299792458 # Speed of light in m/s
const h  = 6.62607015f-34 # m2 kg / s

# Wavelength in Angstroms (A) from Huebner (2015)
solar_wavelength = 
    Tuple(map(Int32, 
    (1, 2, 4, 6, 8, 10, 40, 50, 60, 70, 80, 90, 100, 110, 120, 128, 153, 176, 205, 231, 270, 280, 300, 320, 340, 360, 370, 400, 430, 460, 480, 500, 
    520, 540, 560, 580, 600, 620, 630, 680, 710, 740, 770, 800, 830, 860, 890, 911, 920, 930, 940, 950, 960, 970, 980, 995, 1007, 1017, 1027, 1035, 1045, 1057, 1070, 1080, 
    1090, 1100, 1110, 1120, 1130, 1140, 1150, 1157, 1163, 1170, 1176, 1183, 1190, 1198, 1205, 1212, 1220, 1227, 1235, 1242, 1250, 1258, 1266, 1274, 1282, 1290, 1299, 1307, 1316, 1324, 1333, 1342,
    1351, 1360, 1370, 1379, 1389, 1408, 1428, 1449, 1470, 1492, 1515, 1538, 1562, 1587, 1613, 1639, 1667, 1695, 1724, 1739, 1754, 1770, 1786, 1802, 1818, 1835, 1852, 1869, 1887, 1905, 1923, 1942, 
    1961, 1980, 2000, 2020, 2041, 2062, 2083, 2105, 2128, 2150, 2174, 2198, 2222, 2247, 2273, 2299, 2326, 2353, 2381, 2410, 2439, 2469, 2500, 2532, 2564, 2597, 2632, 2667, 2703, 2740, 2778, 2817,
    2857, 2899, 2941, 2985, 3030, 3077, 3125, 3175, 3225, 3275, 3325, 3375, 3425, 3475, 3525, 3575, 3625, 3675, 3725, 3775, 3825, 3875, 3925, 3975, 4025, 4075, 4125, 4175, 4225, 4275, 4325, 4375, 4425, 
    4475, 4525, 4575, 4625, 4675, 4725, 4775, 4825, 4875, 4925, 4975, 5025, 5075, 5125, 5175, 5225, 5275, 5325, 5375, 5425, 5475, 5525, 5575, 5625, 5675, 5725, 5775, 5825, 5875, 5925, 5975, 6025, 6075, 
    6125, 6175, 6225, 6275, 6325, 6375, 6425, 6475, 6550, 6650, 6750, 6850, 6950, 7050, 7150, 7250, 7350, 7450, 7550, 7650, 7750, 7850, 7950, 8050, 8150, 8250, 8350, 8450, 8550, 8650, 8750, 8850, 8950, 
    9050, 9150, 9250, 9350, 9450, 9550, 9650, 9750, 9850, 9950, 10150, 10750, 11250, 11750, 12250, 12750, 13250, 13750, 14250, 14750, 15250, 15750, 16250, 16750, 17250, 17750, 18250, 18750, 19250, 19750, 20375, 21500, 22500, 
    23500, 24500, 25500, 26500, 27500, 28500, 29500, 30500, 31500, 32500, 33500, 34500, 35500, 36500, 37500, 38500, 39500, 40500, 41500, 42500, 43500, 44500, 45500, 46500, 47500, 48500, 49500, 52750, 65000, 75000, 85000, 95000)
    ))

function normalize_flux_distribution(wavelengths::NTuple{N, Int32}, solar_fluxes::NTuple{N, Float32}, min_wavelength::Float32, max_wavelength::Float32)  where {N}

    """ 
    OBJECTIVE: For a certain wavelength range other than  1A - 95e3 A (Huebner Data), determine the weighted probabiulities of a photon having a certain energy/wvl
    
    INPUTS: 
    - wavelengths::  solar_wavelength data from Huebner (2015)
    - solar_fluxes::  Solar fluxes in photons/s (already includes cross section dependency)
    - min_wavelength:: Lower bound for wavelength interval to study
    - max_wavelength:: Upper bound for wavelength interval to study

    OUTPUTS:
    - filtered_wavelengths:: new wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector
    """

    # Convert tuples to vectors for indexing
    wl_vec = collect(wavelengths)
    flux_vec = collect(solar_fluxes)

    # Filter data to get wavelengths within the specified range
    filtered_indices = (wl_vec .>= min_wavelength) .& (wl_vec .<= max_wavelength)
    filtered_wavelengths = wl_vec[filtered_indices]
    filtered_fluxes = flux_vec[filtered_indices]

    # Exclude Lyman-alpha if the condition holds
    if min_wavelength != 1.0f0 && max_wavelength != 95000.0f0
        if min_wavelength < 1208.0f0 && max_wavelength > 1220.0f0
            exclude_indices = findall(x -> x != 1212, filtered_wavelengths)  # Indices excluding 1212
            filtered_wavelengths = filtered_wavelengths[exclude_indices]
            filtered_fluxes = filtered_fluxes[exclude_indices]
        end
    end

    # Normalize the fluxes
    total_flux = sum(filtered_fluxes)
    normalized_fluxes = filtered_fluxes / total_flux

    return Tuple(filtered_wavelengths), Tuple(normalized_fluxes)
end


function generate_weighted_random_wvl(wavelengths::NTuple{N,Int32}, normalized_fluxes::NTuple{N,Float32}) where {N}
    """ 
    OBJECTIVE: Generate random wavelength according to the given weights derived from the species dependent photon flux in photons/s
    
    INPUTS: 
    - wavelengths::  wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector

    OUTPUTS:
    - wavelength vector / value
    """
    cumulative_distribution = Base.cumsum(collect(normalized_fluxes))
    random_value = rand(Float32)
    selected_index = findfirst(x -> x >= random_value, cumulative_distribution)
    return wavelengths[selected_index] * 1f-10
end


function generate_energy_vector(wavelengths::NTuple{N,Int32}, normalized_fluxes::NTuple{N,Float32}, num_reactions::Int32) where {N}
    
    """ 
    OBJECTIVE: Generate vector of size num_reactions with random energies and wavelengths according to the given weights derived from the species dependent photon flux in photons/s
    
    INPUTS: 
    - wavelengths::  wavelength tuple
    - normalized_fluxes:: weighted probabilities for new wavelength vector
    - num_reactions:: number of photons to be simulated at once (usually 1)

    OUTPUTS:
    - wvl_vector, e_vector
    """

    if num_reactions == 1
        photon_wvl_m = generate_weighted_random_wvl(wavelengths, normalized_fluxes)
        photon_wvl = Int(round(photon_wvl_m / 1f-10))
        photon_energy = h * c / photon_wvl_m
        return photon_wvl, photon_energy
    else
        e_vector = Float32[]
        wvl_vector = Int32[]
        for i in 1:num_reactions
            photon_wvl_m = generate_weighted_random_wvl(wavelengths, normalized_fluxes)
            push!(wvl_vector, Int(round(photon_wvl_m / 1f-10)))
            push!(e_vector, h * c / photon_wvl_m)
        end
        return wvl_vector, e_vector
    end
end



function flux_outputs(parent_type::String, wvl_range, sun_mode::Float32, num_reactions::Int32)

    """ 
    OBJECTIVE: Get photon energy and wavelength for a certain parent species and degree of solar activity
    INPUTS: 
    - parent_type:: Parent species to be photodissociated/ionized
    - wvl_range::  2D Tuple
    - sun_mode:: decimal degree of solar activity (0.0 -> quiet sun, 1.0 -> active sun, or in between)
    - num_reactions:: number of photons to be simulated at once (usually 1)

    OUTPUTS:
    - Final wavelength and energy vector / value
    """

    wavelengths = solar_wavelength
    flux_quiet, flux_active = nothing, nothing

    if parent_type == "H2O"
        if wvl_range == (1.0f0, 95000.0f0)
            # H2O normalized fluxes when USING full solar spectrum. QUIET SUN
            flux_quiet = (1.18120617f-06, 1.18120617f-06, 1.18120617f-06, 1.18120617f-06,
                1.18120617f-06, 1.18120617f-06, 1.18120617f-06, 3.19146662f-06, 5.66225583f-06, 7.85996108f-06, 9.97710403f-06, 9.02078020f-06, 8.06445637f-06, 4.99705787f-06, 1.14640725f-05, 2.62273287f-05, 1.30221759f-04, 5.39093310f-04, 3.50904270f-04, 4.62114957f-04,
                4.79624634f-04, 6.19263942f-04, 2.47389193f-03, 6.16344331f-04, 3.13395048f-04, 1.30524352f-03, 1.36427711f-04, 1.23162209f-04, 1.03494487f-04, 1.85827087f-04, 3.53299276f-04, 4.89484917f-04, 2.61448417f-04, 3.04365371f-04, 2.45233979f-04, 7.24442622f-04,
                6.39187211f-04, 1.90277996f-03, 1.05773541f-04, 2.12279093f-04, 1.13191802f-04, 2.87239923f-04, 6.63352054f-04, 5.17702751f-04, 1.15200828f-03, 1.72585583f-03, 2.95867055f-03, 3.23922912f-04, 5.96760773f-04, 1.00491525f-03, 5.75754577f-04, 5.84783594f-04,
                1.34146901f-03, 5.00991238f-03, 5.53092894f-04, 1.52291707f-04, 2.69384282f-04, 1.30198387f-03, 1.07526604f-03, 5.16180881f-04, 3.25445628f-05, 5.55467505f-05, 2.42560834f-04, 2.75425269f-04, 8.66411882f-05, 1.25142234f-04, 4.38747699f-04, 3.51747787f-04,
                1.15192510f-04, 3.70302579f-05, 3.81370890f-05, 3.31420899f-05, 1.40566900f-04, 2.03086591f-04, 7.51485653f-05, 1.31906073f-04, 1.72783405f-04, 1.58369137f-04, 2.03409840f-01, 3.73740180f-01, 6.51981613f-02, 1.70562926f-03, 2.13071805f-03, 2.17702269f-03,
                2.22994229f-03, 2.28286189f-03, 1.07639476f-03, 9.96094426f-04, 8.95238033f-04, 2.50222580f-03, 4.13855813f-03, 2.69605540f-03, 1.20541866f-03, 3.35378131f-03, 3.06450301f-03, 1.46607562f-03, 9.14655708f-04, 7.06665676f-04, 5.70130808f-04, 4.88280800f-04,
                4.10991934f-04, 3.20106595f-04, 2.95426317f-04, 4.96598684f-04, 8.32024244f-04, 1.15020549f-03, 1.89257396f-03, 3.34426830f-03, 5.34069892f-03, 8.56320184f-03, 8.91920772f-03, 1.86713674f-02, 2.73406574f-02, 2.94558390f-02, 3.25335932f-02, 3.42707408f-02,
                3.38931860f-02, 2.99406071f-02, 2.05711295f-02, 1.35124461f-02, 1.00848863f-02, 4.25857067f-03, 3.43738287f-04, 5.44393923f-09, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12,
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12,
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 
                2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12, 2.29398075f-12)

            # H2O normalized fluxes when USING full solar spectrum. QUIET SUN
            flux_active = (3.89495910f-06, 3.89495910f-06, 3.89495910f-06, 3.89495910f-06,
                3.89495910f-06, 3.89495910f-06, 3.89495910f-06, 1.05236768f-05, 7.29189491f-06, 9.53054069f-06, 1.20504841f-05, 1.07869027f-05, 9.70811854f-06, 6.05567186f-06, 1.45548629f-05, 3.69677043f-05, 3.04016995f-04, 1.48170098f-03, 6.22257026f-04, 1.21088138f-03,
                6.76622792f-04, 7.14858841f-04, 3.59150460f-03, 8.22593588f-04, 3.54816961f-04, 1.93391201f-03, 1.52214160f-04, 1.46274626f-04, 1.28577868f-04, 2.30864960f-04, 4.35906313f-04, 5.75589469f-04, 3.02583757f-04, 3.22244280f-04, 2.47305340f-04, 7.05821093f-04,
                6.13845447f-04, 1.88244094f-03, 1.06199161f-04, 2.16964873f-04, 1.26962226f-04, 2.93361265f-04, 8.45071497f-04, 6.65515549f-04, 1.44515451f-03, 2.15307579f-03, 3.69106263f-03, 4.04107093f-04, 7.44483493f-04, 1.02378593f-03, 5.85791582f-04, 5.94191116f-04,
                1.36124440f-03, 6.06347317f-03, 6.73353607f-04, 1.85631807f-04, 3.28679594f-04, 1.58986191f-03, 9.98889215f-04, 4.59587410f-04, 2.89764148f-05, 4.94566695f-05, 2.15966747f-04, 2.62336891f-04, 8.25239458f-05, 1.19195398f-04, 4.17898139f-04, 3.35032516f-04,
                1.13269220f-04, 3.64979882f-05, 3.72290696f-05, 3.21341011f-05, 1.35495889f-04, 1.94418808f-04, 7.21233253f-05, 1.47419589f-04, 2.07062843f-04, 1.86637365f-04, 2.36175840f-01, 4.27435987f-01, 7.32678598f-02, 1.89631764f-03, 2.36152085f-03, 2.40621641f-03,
                2.45695197f-03, 2.50731943f-03, 1.17848548f-03, 1.05050166f-03, 8.65872632f-04, 2.41530390f-03, 3.98577957f-03, 2.60626618f-03, 1.17129589f-03, 3.48812039f-03, 3.23428892f-03, 1.51454840f-03, 9.24462498f-04, 7.18183677f-04, 5.84532191f-04, 4.86162095f-04,
                3.82996654f-04, 2.74291314f-04, 2.54610865f-04, 4.30579777f-04, 7.25752670f-04, 9.20775213f-04, 1.48118006f-03, 2.57417629f-03, 4.06465682f-03, 6.32994369f-03, 6.42312899f-03, 1.28765629f-02, 1.82306679f-02, 1.83925648f-02, 2.00670883f-02, 2.10038576f-02,
                2.06392231f-02, 1.81067567f-02, 1.23542514f-02, 8.10561289f-03, 6.04323112f-03, 2.54905670f-03, 2.05523009f-04, 3.25133842f-09, 1.36844077f-12, 1.36682441f-12, 1.36036627f-12, 1.33979031f-12, 1.32807334f-12, 1.31635638f-12, 1.30402274f-12, 1.29168909f-12,
                1.28726823f-12, 1.27575063f-12, 1.24685752f-12, 1.24685752f-12, 1.23452387f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12, 1.22310786f-12,
                1.22310786f-12, 1.21900697f-12, 1.19935819f-12, 1.19935408f-12, 1.19934997f-12, 1.19934574f-12, 1.19934124f-12, 1.19933675f-12, 1.19933213f-12, 1.19932738f-12, 1.19932250f-12, 1.19931749f-12, 1.19931236f-12, 1.19930697f-12, 1.19930158f-12, 1.19929593f-12,
                1.19929015f-12, 1.19928412f-12, 1.19927795f-12, 1.19927154f-12, 1.19926512f-12, 1.19925870f-12, 1.19925228f-12, 1.19924586f-12, 1.19923944f-12, 1.19923302f-12, 1.19922660f-12, 1.19922019f-12, 1.19921377f-12, 1.19920735f-12, 1.19920093f-12, 1.19919451f-12,
                1.19918809f-12, 1.19918167f-12, 1.19917525f-12, 1.19916883f-12, 1.19916242f-12, 1.19915600f-12, 1.19914958f-12, 1.19914316f-12, 1.19913674f-12, 1.19913032f-12, 1.19912390f-12, 1.19911748f-12, 1.19911107f-12, 1.19910465f-12, 1.19909823f-12, 1.19909181f-12,
                1.19908539f-12, 1.19907897f-12, 1.19907255f-12, 1.19906613f-12, 1.19905971f-12, 1.19905330f-12, 1.19904688f-12, 1.19904046f-12, 1.19903404f-12, 1.19902762f-12, 1.19902120f-12, 1.19901478f-12, 1.19900836f-12, 1.19900195f-12, 1.19899553f-12, 1.19898911f-12,
                1.19898269f-12, 1.19897627f-12, 1.19896985f-12, 1.19896343f-12, 1.19895701f-12, 1.19895059f-12, 1.19894418f-12, 1.19893776f-12, 1.19893134f-12, 1.19892492f-12, 1.19891850f-12, 1.19891208f-12, 1.19890566f-12, 1.19889924f-12, 1.19889283f-12, 1.19888641f-12,
                1.19887999f-12, 1.19887357f-12, 1.19886715f-12, 1.19886073f-12, 1.19885431f-12, 1.19884789f-12, 1.19883827f-12, 1.19882543f-12, 1.19881259f-12, 1.19879975f-12, 1.19878691f-12, 1.19877408f-12, 1.19876124f-12, 1.19874840f-12, 1.19873556f-12, 1.19872273f-12,
                1.19870989f-12, 1.19869705f-12, 1.19868421f-12, 1.19867138f-12, 1.19865854f-12, 1.19864570f-12, 1.19863286f-12, 1.19862002f-12, 1.19860719f-12, 1.19859435f-12, 1.19858151f-12, 1.19856867f-12, 1.19855584f-12, 1.19854300f-12, 1.19853016f-12, 1.19851732f-12,
                1.19850449f-12, 1.19849165f-12, 1.19847881f-12, 1.19846597f-12, 1.19845314f-12, 1.19844030f-12, 1.19842746f-12, 1.19841462f-12, 1.19840178f-12, 1.19837611f-12, 1.19829908f-12, 1.19823490f-12, 1.19817071f-12, 1.19810652f-12, 1.19804233f-12, 1.19797814f-12,
                1.19791395f-12, 1.19784977f-12, 1.19778558f-12, 1.19772139f-12, 1.19765720f-12, 1.19759301f-12, 1.19752882f-12, 1.19746464f-12, 1.19740045f-12, 1.19733626f-12, 1.19727207f-12, 1.19720788f-12, 1.19714369f-12, 1.19706346f-12, 1.19691904f-12, 1.19679066f-12,
                1.19666228f-12, 1.19653391f-12, 1.19640553f-12, 1.19627715f-12, 1.19614878f-12, 1.19602040f-12, 1.19589202f-12, 1.19576365f-12, 1.19563527f-12, 1.19550689f-12, 1.19537852f-12, 1.19525014f-12, 1.19512176f-12, 1.19499339f-12, 1.19486501f-12, 1.19473663f-12,
                1.19460826f-12, 1.19447988f-12, 1.19435150f-12, 1.19422313f-12, 1.19409475f-12, 1.19396637f-12, 1.19383800f-12, 1.19370962f-12, 1.19358124f-12, 1.19345287f-12, 1.19332449f-12, 1.19290727f-12, 1.19133465f-12, 1.19005089f-12, 1.18876712f-12, 1.18748336f-12)

        else

            # H2O Flux already multiplied by cross_section!!! Photons per second!!! QUIET SUN
            solar_flux_water = (1.32708816f-12, 1.32708816f-12, 1.32708816f-12, 1.32708816f-12,
                1.32708816f-12, 1.32708816f-12, 1.32708816f-12, 3.58562091f-12, 6.36155891f-12, 8.83068638f-12, 1.12093019f-11, 1.01348696f-11, 9.06043737f-12, 5.61420730f-12, 1.28799148f-11, 2.94664709f-11, 1.46304479f-10, 6.05672713f-10, 3.94241845f-10, 5.19187337f-10,
                5.38859503f-10, 6.95744623f-10, 2.77942391f-09, 6.92464433f-10, 3.52100138f-10, 1.46644443f-09, 1.53276883f-10, 1.38373056f-10, 1.16276321f-10, 2.08777208f-10, 3.96932640f-10, 5.49937556f-10, 2.93737966f-10, 3.41955273f-10, 2.75521002f-10, 8.13913140f-10,
                7.18128466f-10, 2.13777815f-09, 1.18836844f-10, 2.38496105f-10, 1.27171280f-10, 3.22714788f-10, 7.45277729f-10, 5.81640365f-10, 1.29428425f-09, 1.93900344f-09, 3.32407394f-09, 3.63928221f-10, 6.70462256f-10, 1.12902485f-09, 6.46861741f-10, 6.57005864f-10,
                1.50714387f-09, 5.62864937f-09, 6.21401281f-10, 1.71100123f-10, 3.02653930f-10, 1.46278221f-09, 1.20806415f-09, 5.79930540f-10, 3.65638995f-11, 6.24069163f-11, 2.72517718f-10, 3.09440994f-10, 9.73415966f-11, 1.40597620f-10, 4.92934162f-10, 3.95189539f-10,
                1.29419080f-10, 4.16035895f-11, 4.28471170f-11, 3.72352228f-11, 1.57927271f-10, 2.28168304f-10, 8.44296053f-11, 1.48196811f-10, 1.94122597f-10, 1.77928130f-10, 2.28531476f-07, 4.19898048f-07, 7.32503010f-08, 1.91627884f-09, 2.39386718f-09, 2.44589057f-09,
                2.50534587f-09, 2.56480117f-09, 1.20933227f-09, 1.11911464f-09, 1.00580222f-09, 2.81125709f-09, 4.64968065f-09, 3.02902514f-09, 1.35429095f-09, 3.76798188f-09, 3.44297697f-09, 1.64713970f-09, 1.02761803f-09, 7.93940695f-10, 6.40543422f-10, 5.48584728f-10,
                4.61750490f-10, 3.59640579f-10, 3.31912223f-10, 5.57929892f-10, 9.34781367f-10, 1.29225881f-09, 2.12631168f-09, 3.75729399f-09, 6.00028890f-09, 9.62077918f-09, 1.00207527f-08, 2.09773290f-08, 3.07172985f-08, 3.30937105f-08, 3.65515752f-08, 3.85032649f-08, 
                3.80790812f-08, 3.36383487f-08, 2.31117166f-08, 1.51812678f-08, 1.13303956f-08, 4.78451504f-09, 3.86190845f-10, 6.11627965f-15, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18,
                2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18, 2.57729324f-18)


            # H2O Flux already multiplied by cross_section!!! Photons per second!!! ACTIVE SUN
            solar_flux_water_active = (8.45355155f-12, 8.45355155f-12, 8.45355155f-12, 8.45355155f-12,
                8.45355155f-12, 8.45355155f-12, 8.45355155f-12, 2.28404052f-11, 1.58262020f-11, 2.06849199f-11, 2.61541612f-11, 2.34117061f-11, 2.10703318f-11, 1.31431250f-11, 3.15896215f-11, 8.02340630f-11, 6.59833202f-10, 3.21585807f-09, 1.35053584f-09, 2.62807591f-09,
                1.46853035f-09, 1.55151721f-09, 7.79493918f-09, 1.78534283f-09, 7.70088566f-10, 4.19732903f-09, 3.30362967f-10, 3.17471906f-10, 2.79063170f-10, 5.01065298f-10, 9.46083486f-10, 1.24924938f-09, 6.56722528f-10, 6.99393386f-10, 5.36747212f-10, 1.53190183f-09,
                1.33227949f-09, 4.08561709f-09, 2.30492813f-10, 4.70896790f-10, 2.75556609f-10, 6.36706192f-10, 1.83412849f-09, 1.44442338f-09, 3.13653824f-09, 4.67299828f-09, 8.01101819f-09, 8.77067012f-10, 1.61581404f-09, 2.22200719f-09, 1.27139187f-09, 1.28962207f-09,
                2.95442118f-09, 1.31600568f-08, 1.46143497f-09, 4.02892049f-10, 7.13360480f-10, 3.45060866f-09, 2.16797179f-09, 9.97480529f-10, 6.28899072f-11, 1.07339896f-10, 4.68730475f-10, 5.69371429f-10, 1.79108538f-10, 2.58699621f-10, 9.06998859f-10, 7.27148751f-10,
                2.45837547f-10, 7.92145994f-11, 8.08013256f-11, 6.97432945f-11, 2.94077923f-10, 4.21963201f-10, 1.56535212f-10, 3.19956915f-10, 4.49405595f-10, 4.05074493f-10, 5.12591939f-07, 9.27699639f-07, 1.59019290f-07, 4.11573485f-09, 5.12540382f-09, 5.22241028f-09,
                5.33252585f-09, 5.44184253f-09, 2.55776440f-09, 2.27999054f-09, 1.87927491f-09, 5.24213362f-09, 8.65066672f-09, 5.65659482f-09, 2.54216024f-09, 7.57055587f-09, 7.01964447f-09, 3.28714953f-09, 2.00643734f-09, 1.55873337f-09, 1.26865851f-09, 1.05515776f-09,
                8.31249281f-10, 5.95317101f-10, 5.52602997f-10, 9.34522865f-10, 1.57516098f-09, 1.99843452f-09, 3.21472746f-09, 5.58694749f-09, 8.82186053f-09, 1.37383998f-08, 1.39406475f-08, 2.79470684f-08, 3.95675248f-08, 3.99189030f-08, 4.35532596f-08, 4.55864075f-08,
                4.47950112f-08, 3.92985901f-08, 2.68134526f-08, 1.75922814f-08, 1.31161238f-08, 5.53242837f-09, 4.46063567f-10, 7.05664840f-15, 2.97004007f-18, 2.96653195f-18, 2.95251531f-18, 2.90785760f-18, 2.88242731f-18, 2.85699702f-18, 2.83022829f-18, 2.80345956f-18,
                2.79386460f-18, 2.76886700f-18, 2.70615790f-18, 2.70615790f-18, 2.67938914f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18, 2.65461204f-18,
                2.65461204f-18, 2.64571154f-18, 2.60306617f-18, 2.60305726f-18, 2.60304834f-18, 2.60303915f-18, 2.60302940f-18, 2.60301964f-18, 2.60300961f-18, 2.60299930f-18, 2.60298872f-18, 2.60297785f-18, 2.60296670f-18, 2.60295500f-18, 2.60294330f-18, 2.60293104f-18,
                2.60291850f-18, 2.60290541f-18, 2.60289203f-18, 2.60287810f-18, 2.60286417f-18, 2.60285024f-18, 2.60283631f-18, 2.60282238f-18, 2.60280844f-18, 2.60279451f-18, 2.60278058f-18, 2.60276665f-18, 2.60275272f-18, 2.60273879f-18, 2.60272486f-18, 2.60271093f-18,
                2.60269699f-18, 2.60268306f-18, 2.60266913f-18, 2.60265520f-18, 2.60264127f-18, 2.60262734f-18, 2.60261341f-18, 2.60259947f-18, 2.60258554f-18, 2.60257161f-18, 2.60255768f-18, 2.60254375f-18, 2.60252982f-18, 2.60251589f-18, 2.60250196f-18, 2.60248802f-18,
                2.60247409f-18, 2.60246016f-18, 2.60244623f-18, 2.60243230f-18, 2.60241837f-18, 2.60240444f-18, 2.60239050f-18, 2.60237657f-18, 2.60236264f-18, 2.60234871f-18, 2.60233478f-18, 2.60232085f-18, 2.60230692f-18, 2.60229299f-18, 2.60227905f-18, 2.60226512f-18,
                2.60225119f-18, 2.60223726f-18, 2.60222333f-18, 2.60220940f-18, 2.60219547f-18, 2.60218154f-18, 2.60216760f-18, 2.60215367f-18, 2.60213974f-18, 2.60212581f-18, 2.60211188f-18, 2.60209795f-18, 2.60208402f-18, 2.60207008f-18, 2.60205615f-18, 2.60204222f-18,
                2.60202829f-18, 2.60201436f-18, 2.60200043f-18, 2.60198650f-18, 2.60197257f-18, 2.60195863f-18, 2.60193774f-18, 2.60190987f-18, 2.60188201f-18, 2.60185415f-18, 2.60182629f-18, 2.60179842f-18, 2.60177056f-18, 2.60174270f-18, 2.60171484f-18, 2.60168697f-18,
                2.60165911f-18, 2.60163125f-18, 2.60160339f-18, 2.60157552f-18, 2.60154766f-18, 2.60151980f-18, 2.60149194f-18, 2.60146407f-18, 2.60143621f-18, 2.60140835f-18, 2.60138048f-18, 2.60135262f-18, 2.60132476f-18, 2.60129690f-18, 2.60126903f-18, 2.60124117f-18,
                2.60121331f-18, 2.60118545f-18, 2.60115758f-18, 2.60112972f-18, 2.60110186f-18, 2.60107400f-18, 2.60104613f-18, 2.60101827f-18, 2.60099041f-18, 2.60093468f-18, 2.60076751f-18, 2.60062819f-18, 2.60048888f-18, 2.60034957f-18, 2.60021025f-18, 2.60007094f-18,
                2.59993163f-18, 2.59979231f-18, 2.59965300f-18, 2.59951369f-18, 2.59937438f-18, 2.59923506f-18, 2.59909575f-18, 2.59895644f-18, 2.59881712f-18, 2.59867781f-18, 2.59853850f-18, 2.59839918f-18, 2.59825987f-18, 2.59808573f-18, 2.59777227f-18, 2.59749365f-18,
                2.59721502f-18, 2.59693640f-18, 2.59665777f-18, 2.59637914f-18, 2.59610052f-18, 2.59582189f-18, 2.59554326f-18, 2.59526464f-18, 2.59498601f-18, 2.59470738f-18, 2.59442876f-18, 2.59415013f-18, 2.59387151f-18, 2.59359288f-18, 2.59331425f-18, 2.59303563f-18,
                2.59275700f-18, 2.59247837f-18, 2.59219975f-18, 2.59192112f-18, 2.59164250f-18, 2.59136387f-18, 2.59108524f-18, 2.59080662f-18, 2.59052799f-18, 2.59024936f-18, 2.58997074f-18, 2.58906520f-18, 2.58565203f-18, 2.58286577f-18, 2.58007950f-18, 2.57729324f-18)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_water, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_water_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "OH"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_quiet =  (0.00000000f+00, 2.30878048f-14, 4.65592554f-12, 8.27441142f-11,
                7.28626258f-10, 2.05628015f-08, 1.20814948f-06, 3.40872351f-06, 5.81255861f-06, 6.74884823f-06, 1.04591889f-05, 1.01498322f-05, 6.60168362f-06, 3.33127144f-06, 1.78337409f-06, 4.93979662f-05, 1.79383097f-04, 8.68208503f-04, 3.90887744f-04, 8.45750206f-04,
                1.70581165f-04, 6.07426675f-04, 2.48293560f-03, 5.28829506f-04, 2.18976662f-04, 6.77718158f-04, 9.42889186f-05, 1.59747891f-04, 1.10605115f-04, 1.42247464f-04, 3.03136951f-04, 4.62897785f-04, 1.84684842f-04, 2.87387385f-04, 4.26326008f-05, 8.72449251f-04,
                4.89110476f-04, 1.04323852f-03, 9.67501582f-05, 2.37641426f-04, 9.80756545f-05, 2.76444766f-04, 5.74041261f-04, 2.93982510f-04, 2.94117027f-04, 7.30827532f-04, 3.73255600f-04, 4.96052812f-06, 6.45232382f-06, 4.65390792f-06, 1.93939438f-05, 5.96236718f-06,
                8.52916171f-06, 5.65467001f-04, 9.93176883f-05, 2.10492098f-05, 2.05930960f-05, 8.01688518f-04, 6.08535050f-04, 4.88823277f-04, 4.58121701f-05, 5.46404007f-05, 4.63083760f-05, 2.72667614f-04, 5.27747237f-05, 5.60078976f-05, 5.92410715f-05, 2.96156537f-04,
                6.57074192f-05, 6.89405931f-05, 5.04114479f-05, 4.45485490f-05, 6.00520609f-05, 1.59681454f-04, 6.88928407f-05, 7.84165027f-05, 1.18239513f-04, 1.26103363f-04, 4.93604096f-04, 2.01443834f-01, 7.01762724f-03, 2.49272766f-03, 2.80508913f-03, 2.19518555f-03,
                2.21711609f-03, 4.60847935f-03, 1.47470333f-03, 1.78186715f-03, 1.23423708f-03, 1.27616132f-03, 7.41771041f-03, 2.03922834f-03, 1.31175127f-03, 1.62303327f-03, 7.84278944f-04, 1.05581807f-03, 1.32449966f-03, 8.53601525f-04, 8.65316001f-04, 9.33441121f-04,
                2.16431377f-03, 2.64049363f-03, 3.22386977f-03, 4.25648314f-03, 2.92274706f-03, 3.40243368f-03, 5.49561887f-03, 6.26552330f-03, 7.50064317f-03, 1.18458440f-02, 1.22068881f-02, 3.08928836f-02, 5.27518314f-02, 7.75733135f-02, 3.75035547f-02, 4.06632533f-02,
                2.46514156f-02, 3.75128509f-02, 2.94888536f-02, 2.12589537f-02, 2.88443736f-02, 3.73052822f-02, 4.58934901f-02, 1.74663228f-03, 1.87307963f-03, 1.99225546f-03, 2.60631108f-03, 3.22884261f-03, 2.46317832f-03, 2.80222208f-03, 3.20562261f-03, 3.81072341f-03,
                4.16531937f-03, 4.62571325f-03, 9.02729343f-03, 1.17734253f-02, 1.41048612f-02, 1.18569589f-02, 1.53278399f-02, 1.39866910f-02, 1.79757692f-02, 1.40681178f-02, 1.44546399f-02, 1.42969415f-02, 1.00907381f-02, 6.65759420f-03, 3.44675553f-03, 7.40935678f-07,
                7.93098649f-07, 1.78664446f-02, 7.83985059f-07, 9.18324848f-07, 1.44763572f-06, 7.59807721f-07, 1.60088346f-06, 1.77038084f-06, 1.62019130f-06, 1.63813554f-06, 1.87115335f-06, 2.26896934f-06, 3.22979147f-06, 5.03127553f-06, 5.05619957f-06, 4.79904923f-06,
                6.19146313f-06, 7.06385460f-06, 7.06096285f-06, 7.91087609f-06, 9.03504346f-06, 1.05400542f-05, 9.49276141f-06, 9.73333153f-06, 1.01390632f-05, 1.00596190f-05, 9.77940122f-06, 9.59140853f-06, 1.05615335f-05, 1.06744271f-05, 1.04238615f-05, 9.51711211f-06,
                8.72707282f-06, 8.27328713f-06, 8.70855756f-06, 1.08509316f-05, 1.28706065f-05, 1.29388752f-05, 1.23974836f-05, 1.20348270f-05, 1.14284159f-05, 1.05026226f-05, 1.01805005f-05, 1.09566243f-05, 1.09881558f-05, 1.07272366f-05, 1.00930720f-05, 9.37783844f-06,
                8.77332595f-06, 8.25504945f-06, 7.73921952f-06, 6.97528990f-06, 5.95592085f-06, 5.24368187f-06, 4.74879447f-06, 3.98024568f-06, 3.31887540f-06, 2.65206400f-06, 1.91670992f-06, 1.25561363f-06, 6.16536500f-07, 1.40124906f-15, 1.43358817f-15, 1.44962804f-15,
                1.46566228f-15, 1.45455368f-15, 1.44344884f-15, 1.44319888f-15, 1.44837354f-15, 1.44812264f-15, 1.45871722f-15, 1.46930805f-15, 1.46905339f-15, 1.46879873f-15, 1.47396305f-15, 1.47370745f-15, 1.46803475f-15, 1.46236393f-15, 1.46211021f-15, 1.46185649f-15,
                1.45618943f-15, 1.45052425f-15, 1.44486094f-15, 1.43919952f-15, 1.43353997f-15, 2.13641481f-15, 2.82257695f-15, 2.79997448f-15, 2.77738704f-15, 2.74941305f-15, 2.72145784f-15, 2.69352143f-15, 2.66560381f-15, 2.64309907f-15, 2.60443276f-15, 2.58735404f-15,
                2.51640219f-15, 2.47243201f-15, 2.52003151f-15, 2.44379271f-15, 2.47522500f-15, 2.43670717f-15, 2.37132981f-15, 2.33287400f-15, 2.31593812f-15, 2.16472534f-15, 2.32505737f-15, 2.28130144f-15, 2.29123448f-15, 2.26897593f-15, 2.21455965f-15, 2.14946045f-15,
                2.08440636f-15, 2.07831878f-15, 2.02404345f-15, 2.01262757f-15, 1.99051750f-15, 1.98981836f-15, 2.02654888f-15, 2.02583659f-15, 4.00215857f-15, 1.12665076f-14, 8.95154511f-15, 8.51024584f-15, 7.96425996f-15, 7.84416225f-15, 7.56571905f-15, 6.97133661f-15,
                6.58989825f-15, 6.10452505f-15, 5.88349953f-15, 5.61078850f-15, 5.20815891f-15, 5.07863541f-15, 4.79829362f-15, 4.28985897f-15, 4.00149174f-15, 3.60001779f-15, 3.37084447f-15, 3.19933337f-15, 3.84872924f-15, 5.71362312f-15, 4.24454738f-15, 3.74377619f-15,
                3.47556633f-15, 3.07741891f-15, 2.77809888f-15, 2.49601824f-15, 2.26108887f-15, 2.04283508f-15, 1.86099138f-15, 1.68542038f-15, 1.57038727f-15, 1.41190532f-15, 1.32319891f-15, 1.20583984f-15, 1.12338734f-15, 1.03669189f-15, 9.69937686f-16, 8.98865356f-16,
                8.18743313f-16, 7.63068571f-16, 7.03056913f-16, 6.67154265f-16, 6.26801936f-16, 5.86750311f-16, 5.42324182f-16, 4.93579932f-16, 4.48457896f-16, 4.27241443f-16, 1.30640920f-15, 3.05925353f-15, 1.45887642f-15, 9.66777806f-16, 6.92421942f-16, 1.97274931f-15)


            flux_active = (0.00000000f+00, 1.01156619f-13, 2.03994139f-11, 3.62534027f-10,
                3.19239398f-09, 9.00936014f-08, 5.29337103f-06, 1.49349386f-05, 9.94609787f-06, 1.08732976f-05, 1.67854299f-05, 1.61267180f-05, 1.05596409f-05, 5.36404541f-06, 3.00847298f-06, 9.25149590f-05, 5.56455310f-04, 3.17069985f-03, 9.21017070f-04, 2.94461254f-03,
                3.19750100f-04, 9.31692994f-04, 4.78956013f-03, 9.37803962f-04, 3.29415890f-04, 1.33422403f-03, 1.39780821f-04, 2.52093199f-04, 1.82582305f-04, 2.34816174f-04, 4.96962660f-04, 7.23257753f-04, 2.84004562f-04, 4.04289208f-04, 5.71253860f-05, 1.12944551f-03,
                6.24126175f-04, 1.37135810f-03, 1.29071452f-04, 3.22729617f-04, 1.46168988f-04, 3.75146424f-04, 9.71688260f-04, 5.02150267f-04, 4.90245166f-04, 1.21144632f-03, 6.18722070f-04, 8.22275198f-06, 1.06956068f-05, 6.29987565f-06, 2.62184087f-05, 8.04978278f-06,
                1.14999586f-05, 9.09354176f-04, 1.60659416f-04, 3.40915231f-05, 3.33854016f-05, 1.30075030f-03, 7.51140986f-04, 5.78299155f-04, 5.41977857f-05, 6.46419657f-05, 5.47848188f-05, 3.45083038f-04, 6.67907044f-05, 7.08825488f-05, 7.49743933f-05, 3.74810180f-04,
                8.58492581f-05, 9.02862625f-05, 6.53880346f-05, 5.73923882f-05, 7.69140073f-05, 2.03116861f-04, 8.78544190f-05, 1.16448083f-04, 1.88276990f-04, 1.97464569f-04, 7.61511971f-04, 3.06118617f-01, 1.04785918f-02, 3.68244059f-03, 4.13092144f-03, 3.22386935f-03,
                3.24583131f-03, 6.72546232f-03, 2.14531856f-03, 2.49692801f-03, 1.58616568f-03, 1.63676124f-03, 9.49223675f-03, 2.61933041f-03, 1.69361492f-03, 2.24294497f-03, 1.09982550f-03, 1.44927348f-03, 1.77876252f-03, 1.15268644f-03, 1.17880815f-03, 1.23490300f-03,
                2.67988633f-03, 3.00633260f-03, 3.69181314f-03, 4.90380793f-03, 3.38749266f-03, 3.61911450f-03, 5.71486629f-03, 6.40809577f-03, 7.58505550f-03, 1.16349399f-02, 1.16804560f-02, 2.83084928f-02, 4.67375173f-02, 6.43602480f-02, 3.07368411f-02, 3.31140397f-02,
                1.99460675f-02, 3.01435644f-02, 2.35315566f-02, 1.69444797f-02, 2.29664452f-02, 2.96701976f-02, 3.64601204f-02, 1.38606903f-03, 1.48465979f-03, 1.57725697f-03, 2.05365178f-03, 2.50569616f-03, 1.89479667f-03, 2.13658776f-03, 2.42126463f-03, 2.85108470f-03,
                3.10571828f-03, 3.41813490f-03, 6.51957207f-03, 8.50284701f-03, 1.00858617f-02, 8.40006745f-03, 1.08590145f-02, 9.90887703f-03, 1.27349411f-02, 9.96656382f-03, 1.02403956f-02, 1.01286741f-02, 7.14878759f-03, 4.71657535f-03, 2.44185537f-03, 5.24916186f-07,
                5.61871064f-07, 1.26150515f-02, 5.44629789f-07, 6.37952662f-07, 1.00565710f-06, 5.27828455f-07, 1.11210857f-06, 1.22985113f-06, 1.12551287f-06, 1.13797385f-06, 1.29984050f-06, 1.57618611f-06, 2.24363132f-06, 3.49504812f-06, 3.51234617f-06, 3.33369808f-06,
                4.30092886f-06, 4.90691499f-06, 4.90488103f-06, 5.49524182f-06, 6.27610424f-06, 7.32150601f-06, 6.59398293f-06, 6.76105463f-06, 7.04284995f-06, 6.98762857f-06, 6.79294690f-06, 6.66232816f-06, 7.33615142f-06, 7.41452882f-06, 7.24044553f-06, 6.61057927f-06,
                6.06178610f-06, 5.74655782f-06, 6.04886073f-06, 7.53688800f-06, 8.93967482f-06, 8.98704484f-06, 8.61096059f-06, 8.35902430f-06, 7.93778714f-06, 7.29472368f-06, 7.07095200f-06, 7.60997461f-06, 7.63183408f-06, 7.45057254f-06, 7.01007770f-06, 6.51328203f-06,
                6.09339143f-06, 5.73339900f-06, 5.37510965f-06, 4.84451271f-06, 4.13651335f-06, 3.64182878f-06, 3.29810317f-06, 2.76432065f-06, 2.30498000f-06, 1.84186540f-06, 1.33115294f-06, 8.72017619f-07, 4.28179338f-07, 9.73150306f-16, 9.95604090f-16, 1.00673814f-15,
                1.01786815f-15, 1.01014808f-15, 1.00243070f-15, 1.00225175f-15, 1.00583999f-15, 1.00566036f-15, 1.01301243f-15, 1.02036181f-15, 1.02017950f-15, 1.01999719f-15, 1.02357804f-15, 1.02339506f-15, 1.01945028f-15, 1.01550684f-15, 1.01532522f-15, 1.01514359f-15,
                1.01120285f-15, 1.00726346f-15, 1.00332541f-15, 9.99388713f-16, 9.95453361f-16, 1.48352328f-15, 1.95997751f-15, 1.94426170f-15, 1.92855665f-15, 1.90911168f-15, 1.88968017f-15, 1.87026212f-15, 1.85085754f-15, 1.83521176f-15, 1.80834479f-15, 1.79646723f-15,
                1.74718480f-15, 1.71663711f-15, 1.74966723f-15, 1.69671617f-15, 1.71852109f-15, 1.69176047f-15, 1.64635256f-15, 1.61963634f-15, 1.60786110f-15, 1.50286416f-15, 1.61415765f-15, 1.58376339f-15, 1.59064223f-15, 1.57517282f-15, 1.53737938f-15, 1.49217059f-15,
                1.44699408f-15, 1.44275263f-15, 1.40506007f-15, 1.39712037f-15, 1.38175726f-15, 1.38125715f-15, 1.40673903f-15, 1.40622952f-15, 2.77805884f-15, 7.82036743f-15, 6.21309412f-15, 5.90648044f-15, 5.52724640f-15, 5.44360620f-15, 5.25009393f-15, 4.83737380f-15,
                4.57245072f-15, 4.23544389f-15, 4.08187314f-15, 3.89246220f-15, 3.61294589f-15, 3.52290548f-15, 3.32826192f-15, 2.97543462f-15, 2.77527512f-15, 2.49669494f-15, 2.33763267f-15, 2.21857321f-15, 2.66875277f-15, 3.96162593f-15, 2.94266525f-15, 2.59521157f-15,
                2.40902820f-15, 2.13283043f-15, 1.92517765f-15, 1.72951473f-15, 1.56656181f-15, 1.41519601f-15, 1.28908345f-15, 1.16734247f-15, 1.08755238f-15, 9.77692671f-16, 9.16168345f-16, 8.34820555f-16, 7.77653949f-16, 7.17562783f-16, 6.71285673f-16, 6.22030276f-16,
                5.66523564f-16, 5.27943085f-16, 4.86370633f-16, 4.61483784f-16, 4.33524673f-16, 4.05779521f-16, 3.75015371f-16, 3.41272181f-16, 3.10040452f-16, 2.95340732f-16, 9.02989051f-16, 2.11381441f-15, 1.00669284f-15, 6.66402941f-16, 4.76773719f-16, 1.35688841f-15)

        else

            solar_flux_hydroxyde = (0.00000000f+00, 5.19190654f-19, 1.04700860f-16, 1.86072133f-15,
                1.63850980f-14, 4.62409244f-13, 2.71684521f-11, 7.66542079f-11, 1.30710829f-10, 1.51765790f-10, 2.35202661f-10, 2.28245953f-10, 1.48456402f-10, 7.49124921f-11, 4.01039062f-11, 1.11084456f-09, 4.03390570f-09, 1.95239757f-08, 8.79014983f-09, 1.90189412f-08,
                3.83597087f-09, 1.36596032f-08, 5.58354061f-08, 1.18921370f-08, 4.92427225f-09, 1.52402940f-08, 2.12033694f-09, 3.59235590f-09, 2.48724997f-09, 3.19881230f-09, 6.81684001f-09, 1.04094870f-08, 4.15312952f-09, 6.46266917f-09, 9.58707339f-10, 1.96193402f-08,
                1.09989490f-08, 2.34599909f-08, 2.17568445f-09, 5.34399907f-09, 2.20549176f-09, 6.21659531f-09, 1.29088434f-08, 6.61097809f-09, 6.61400306f-09, 1.64345994f-08, 8.39364421f-09, 1.11550659f-10, 1.45097650f-10, 1.04655489f-10, 4.36124371f-10, 1.34079673f-10,
                1.91800870f-10, 1.27160284f-08, 2.23342219f-09, 4.73347427f-10, 4.63090496f-10, 1.80280971f-08, 1.36845280f-08, 1.09924906f-08, 1.03020840f-09, 1.22873463f-09, 1.04136691f-09, 6.13165600f-09, 1.18677993f-09, 1.25948644f-09, 1.33219294f-09, 6.65986686f-09,
                1.47760596f-09, 1.55031247f-09, 1.13363539f-09, 1.00179252f-09, 1.35043020f-09, 3.59086190f-09, 1.54923863f-09, 1.76340348f-09, 2.65892970f-09, 2.83576927f-09, 1.11000000f-08, 4.53000000f-06, 1.57810000f-07, 5.60556066f-08, 6.30798844f-08, 4.93645815f-08,
                4.98577479f-08, 1.03633906f-07, 3.31626238f-08, 4.00700186f-08, 2.77551011f-08, 2.86978790f-08, 1.66806933f-07, 4.58574691f-08, 2.94982136f-08, 3.64982168f-08, 1.76365965f-08, 2.37428754f-08, 2.97848951f-08, 1.91954990f-08, 1.94589301f-08, 2.09909045f-08,
                4.86703474f-08, 5.93785171f-08, 7.24972801f-08, 9.57183363f-08, 6.57257357f-08, 7.65127642f-08, 1.23583597f-07, 1.40896944f-07, 1.68671897f-07, 2.66385286f-07, 2.74504322f-07, 6.94708595f-07, 1.18626513f-06, 1.74444213f-06, 8.43367104f-07, 9.14421325f-07,
                5.54352598f-07, 8.43576155f-07, 6.63135249f-07, 4.78064075f-07, 6.48642403f-07, 8.38908421f-07, 1.03203710f-06, 3.92776691f-08, 4.21211737f-08, 4.48011591f-08, 5.86098317f-08, 7.26091077f-08, 5.53911111f-08, 6.30154113f-08, 7.20869443f-08, 8.56942439f-08,
                9.36682767f-08, 1.04021457f-07, 2.03002685f-07, 2.64756760f-07, 3.17185293f-07, 2.66635235f-07, 3.44687219f-07, 3.14527922f-07, 4.04232946f-07, 3.16359018f-07, 3.25050996f-07, 3.21504728f-07, 2.26917066f-07, 1.49713700f-07, 7.75094589f-08, 1.66619080f-11,
                1.78349310f-11, 4.01774493f-07, 1.76299877f-11, 2.06509749f-11, 3.25539368f-11, 1.70862960f-11, 3.60001193f-11, 3.98117185f-11, 3.64343075f-11, 3.68378314f-11, 4.20778562f-11, 5.10238061f-11, 7.26304453f-11, 1.13141602f-10, 1.13702086f-10, 1.07919377f-10,
                1.39231504f-10, 1.58849545f-10, 1.58784516f-10, 1.77897074f-10, 2.03176965f-10, 2.37021133f-10, 2.13469970f-10, 2.18879829f-10, 2.28003784f-10, 2.26217269f-10, 2.19915828f-10, 2.15688313f-10, 2.37504151f-10, 2.40042864f-10, 2.34408231f-10, 2.14017560f-10,
                1.96251427f-10, 1.86046850f-10, 1.95835062f-10, 2.44012038f-10, 2.89429795f-10, 2.90964998f-10, 2.78790368f-10, 2.70635072f-10, 2.56998307f-10, 2.36179383f-10, 2.28935611f-10, 2.46388819f-10, 2.47097887f-10, 2.41230426f-10, 2.26969548f-10, 2.10885622f-10,
                1.97291552f-10, 1.85636727f-10, 1.74036920f-10, 1.56857932f-10, 1.33934710f-10, 1.17918124f-10, 1.06789265f-10, 8.95064028f-11, 7.46337344f-11, 5.96387078f-11, 4.31023168f-11, 2.82358096f-11, 1.38644618f-11, 3.15108094f-20, 3.22380402f-20, 3.25987394f-20,
                3.29593118f-20, 3.27095055f-20, 3.24597837f-20, 3.24541626f-20, 3.25705286f-20, 3.25648865f-20, 3.28031338f-20, 3.30412966f-20, 3.30355699f-20, 3.30298432f-20, 3.31459767f-20, 3.31402289f-20, 3.30126631f-20, 3.28851396f-20, 3.28794341f-20, 3.28737285f-20,
                3.27462896f-20, 3.26188929f-20, 3.24915384f-20, 3.23642262f-20, 3.22369563f-20, 4.80429652f-20, 6.34731447f-20, 6.29648680f-20, 6.24569294f-20, 6.18278597f-20, 6.11992126f-20, 6.05709882f-20, 5.99431863f-20, 5.94371074f-20, 5.85675926f-20, 5.81835324f-20,
                5.65879914f-20, 5.55992051f-20, 5.66696063f-20, 5.49551741f-20, 5.56620128f-20, 5.47958369f-20, 5.33256534f-20, 5.24608722f-20, 5.20800239f-20, 4.86796028f-20, 5.22850945f-20, 5.13011262f-20, 5.15244968f-20, 5.10239543f-20, 4.98002595f-20, 4.83363310f-20,
                4.68734168f-20, 4.67365214f-20, 4.55159964f-20, 4.52592800f-20, 4.47620763f-20, 4.47463543f-20, 4.55723378f-20, 4.55563200f-20, 8.99991724f-20, 2.53357368f-19, 2.01299283f-19, 1.91375496f-19, 1.79097553f-19, 1.76396836f-19, 1.70135301f-19, 1.56769032f-19,
                1.48191377f-19, 1.37276470f-19, 1.32306124f-19, 1.26173492f-19, 1.17119295f-19, 1.14206615f-19, 1.07902385f-19, 9.64688806f-20, 8.99841770f-20, 8.09559680f-20, 7.58023970f-20, 7.19455141f-20, 8.65489062f-20, 1.28486002f-19, 9.54499289f-20, 8.41887578f-20,
                7.81573462f-20, 6.92039434f-20, 6.24729369f-20, 5.61296041f-20, 5.08465928f-20, 4.59385763f-20, 4.18493374f-20, 3.79011568f-20, 3.53143315f-20, 3.17504437f-20, 2.97556443f-20, 2.71165138f-20, 2.52623501f-20, 2.33127726f-20, 2.18116268f-20, 2.02133765f-20,
                1.84116194f-20, 1.71596249f-20, 1.58101033f-20, 1.50027368f-20, 1.40953074f-20, 1.31946402f-20, 1.21956006f-20, 1.10994566f-20, 1.00847677f-20, 9.60765937f-21, 2.93780830f-20, 6.87954465f-20, 3.28067137f-20, 2.17405685f-20, 1.55709477f-20, 4.43625113f-20)

            solar_flux_hydroxyde_active = (0.00000000f+00, 3.30724447f-18, 6.66944480f-16, 1.18527948f-14,
                1.04373074f-13, 2.94554688f-12, 1.73063040f-10, 4.88287304f-10, 3.25180669f-10, 3.55494813f-10, 5.48787817f-10, 5.27251694f-10, 3.45240028f-10, 1.75373689f-10, 9.83599065f-11, 3.02471146f-09, 1.81929147f-08, 1.03663800f-07, 3.01120048f-08, 9.62720345f-08,
                1.04540044f-08, 3.04610466f-08, 1.56591297f-07, 3.06608404f-08, 1.07700206f-08, 4.36215154f-08, 4.57003555f-09, 8.24200969f-09, 5.96939994f-09, 7.67714951f-09, 1.62478444f-08, 2.36464031f-08, 9.28532924f-09, 1.32179511f-08, 1.86767428f-09, 3.69264259f-08,
                2.04053660f-08, 4.48355878f-08, 4.21990026f-09, 1.05514176f-08, 4.77889216f-09, 1.22651483f-08, 3.17686637f-08, 1.64174495f-08, 1.60282206f-08, 3.96073847f-08, 2.02286826f-08, 2.68837088f-10, 3.49685337f-10, 2.05970000f-10, 8.57192419f-10, 2.63181982f-10,
                3.75983052f-10, 2.97306947f-08, 5.25264653f-09, 1.11459835f-09, 1.09151220f-09, 4.25271155f-08, 2.45580258f-08, 1.89070838f-08, 1.77195845f-09, 2.11342357f-09, 1.79115109f-09, 1.12822470f-08, 2.18367507f-09, 2.31745504f-09, 2.45123501f-09, 1.22541550f-08,
                2.80678107f-09, 2.95184580f-09, 2.13781577f-09, 1.87640373f-09, 2.51464933f-09, 6.64076279f-09, 2.87233839f-09, 3.80718811f-09, 6.15558365f-09, 6.45596510f-09, 2.48970979f-08, 1.00083327f-05, 3.42590184f-07, 1.20394803f-07, 1.35057569f-07, 1.05402139f-07,
                1.06120170f-07, 2.19884257f-07, 7.01396804f-08, 8.16353038f-08, 5.18585703f-08, 5.35127565f-08, 3.10341999f-07, 8.56371639f-08, 5.53715476f-08, 7.33315069f-08, 3.59580207f-08, 4.73829764f-08, 5.81553886f-08, 3.76862718f-08, 3.85403026f-08, 4.03742845f-08,
                8.76169971f-08, 9.82899282f-08, 1.20701232f-07, 1.60326548f-07, 1.10751688f-07, 1.18324401f-07, 1.86843531f-07, 2.09508180f-07, 2.47988051f-07, 3.80396171f-07, 3.81884287f-07, 9.25526247f-07, 1.52805023f-06, 2.10421300f-06, 1.00491938f-06, 1.08264022f-06,
                6.52122636f-07, 9.85522620f-07, 7.69347680f-07, 5.53987837f-07, 7.50871761f-07, 9.70046225f-07, 1.19203797f-06, 4.53165513f-08, 4.85399067f-08, 5.15673063f-08, 6.71426993f-08, 8.19219723f-08, 6.19490435f-08, 6.98542328f-08, 7.91615427f-08, 9.32142075f-08,
                1.01539273f-07, 1.11753515f-07, 2.13152820f-07, 2.77994598f-07, 3.29750149f-07, 2.74634292f-07, 3.55027835f-07, 3.23963760f-07, 4.16359934f-07, 3.25849789f-07, 3.34802526f-07, 3.31149870f-07, 2.33724578f-07, 1.54205111f-07, 7.98347427f-08, 1.71617652f-11,
                1.83699789f-11, 4.12440228f-07, 1.78062876f-11, 2.08574132f-11, 3.28792509f-11, 1.72569798f-11, 3.63596068f-11, 4.02091170f-11, 3.67978509f-11, 3.72052539f-11, 4.24973701f-11, 5.15322956f-11, 7.33539466f-11, 1.14268138f-10, 1.14833686f-10, 1.08992912f-10, 
                1.40615842f-10, 1.60428132f-10, 1.60361633f-10, 1.79663063f-10, 2.05192810f-10, 2.39371485f-10, 2.15585631f-10, 2.21047922f-10, 2.30261022f-10, 2.28455598f-10, 2.22090617f-10, 2.17820129f-10, 2.39850307f-10, 2.42412801f-10, 2.36721270f-10, 2.16128236f-10, 
                1.98185830f-10, 1.87879663f-10, 1.97763244f-10, 2.46413248f-10, 2.92276376f-10, 2.93825105f-10, 2.81529295f-10, 2.73292416f-10, 2.59520363f-10, 2.38495856f-10, 2.31179798f-10, 2.48802763f-10, 2.49517443f-10, 2.43591225f-10, 2.29189556f-10, 2.12947171f-10, 
                1.99219144f-10, 1.87449445f-10, 1.75735427f-10, 1.58387933f-10, 1.35240392f-10, 1.19067029f-10, 1.07829162f-10, 9.03775179f-11, 7.53596987f-11, 6.02184927f-11, 4.35211082f-11, 2.85100023f-11, 1.39990221f-11, 3.18164643f-20, 3.25505749f-20, 3.29145947f-20, 
                3.32784827f-20, 3.30260804f-20, 3.27737663f-20, 3.27679154f-20, 3.28852303f-20, 3.28793576f-20, 3.31197283f-20, 3.33600111f-20, 3.33540506f-20, 3.33480902f-20, 3.34651635f-20, 3.34591812f-20, 3.33302093f-20, 3.32012814f-20, 3.31953432f-20, 3.31894052f-20, 
                3.30605654f-20, 3.29317697f-20, 3.28030181f-20, 3.26743105f-20, 3.25456470f-20, 4.85027494f-20, 6.40800852f-20, 6.35662676f-20, 6.30528023f-20, 6.24170625f-20, 6.17817630f-20, 6.11469037f-20, 6.05124846f-20, 6.00009567f-20, 5.91225602f-20, 5.87342316f-20, 
                5.71229773f-20, 5.61242419f-20, 5.72041385f-20, 5.54729410f-20, 5.61858375f-20, 5.53109178f-20, 5.38263381f-20, 5.29528701f-20, 5.25678870f-20, 4.91350860f-20, 5.27737482f-20, 5.17800291f-20, 5.20049279f-20, 5.14991666f-20, 5.02635365f-20, 4.87854670f-20, 
                4.73084528f-20, 4.71697816f-20, 4.59374499f-20, 4.56778671f-20, 4.51755811f-20, 4.51592302f-20, 4.59923423f-20, 4.59756844f-20, 9.08266783f-20, 2.55681408f-19, 2.03132739f-19, 1.93108220f-19, 1.80709431f-19, 1.77974873f-19, 1.71648126f-19, 1.58154531f-19, 
                1.49493058f-19, 1.38474857f-19, 1.33453969f-19, 1.27261312f-19, 1.18122723f-19, 1.15178915f-19, 1.08815181f-19, 9.72797407f-20, 9.07356665f-20, 8.16276838f-20, 7.64272546f-20, 7.25346895f-20, 8.72529932f-20, 1.29522571f-19, 9.62083689f-20, 8.48486157f-20, 
                7.87614814f-20, 6.97313897f-20, 6.29423281f-20, 5.65452666f-20, 5.12176355f-20, 4.62688374f-20, 4.21456759f-20, 3.81654405f-20, 3.55567597f-20, 3.19649737f-20, 2.99534791f-20, 2.72938704f-20, 2.54248485f-20, 2.34602101f-20, 2.19472126f-20, 2.03368420f-20, 
                1.85220892f-20, 1.72607276f-20, 1.59015455f-20, 1.50878875f-20, 1.41737840f-20, 1.32666758f-20, 1.22608636f-20, 1.11576538f-20, 1.01365543f-20, 9.65595733f-21, 2.95225914f-20, 6.91096744f-20, 3.29131138f-20, 2.17875751f-20, 1.55877811f-20, 4.43625113f-20)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_hydroxyde, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_hydroxyde_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "H2"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_quiet = (0.00000000f+00, 2.69662313f-17, 6.60110870f-15, 1.22696352f-13,
                1.10224470f-12, 3.14606032f-11, 5.44683883f-07, 1.28230048f-06, 4.16628273f-06, 6.15223331f-06, 1.08539081f-05, 1.14294686f-05, 7.86515079f-06, 6.07442449f-06, 4.14605806f-06, 1.31250827f-04, 6.15462094f-04, 3.40274513f-03, 2.16059075f-03, 7.15576710f-03,
                2.11947523f-03, 8.20902250f-03, 4.01901749f-02, 9.60110193f-03, 4.53001084f-03, 1.63812354f-02, 2.43415883f-03, 4.75143508f-03, 3.63111632f-03, 5.10215106f-03, 1.08411020f-02, 1.65100751f-02, 7.32796099f-03, 1.24666011f-02, 2.02459887f-03, 4.53369763f-02,
                2.79100494f-02, 6.77526561f-02, 6.83214750f-03, 2.31395545f-02, 1.19026417f-02, 4.60684354f-02, 7.69436466f-02, 4.22016794f-02, 1.30743724f-01, 2.61937611f-19, 2.03089055f-01, 1.19871696f-02, 3.65766590f-02, 1.09877055f-01, 4.17133890f-20, 7.30335431f-21,
                7.30335431f-21, 3.72190171f-19, 5.30897678f-20, 8.77807008f-21, 7.30335431f-21, 2.52808418f-19, 1.72752419f-19, 1.28510946f-19, 1.10252560f-20, 1.19381753f-20, 9.19941744f-21, 5.06319082f-20, 9.19941744f-21, 9.19941744f-21, 9.19941744f-21, 4.36094522f-20,
                9.19941744f-21, 9.19941744f-21, 6.42554730f-21, 5.50560555f-21, 7.23312975f-21, 1.86797331f-20, 7.86515079f-21, 8.70784552f-21, 1.27808700f-20, 1.33426665f-20, 5.19661749f-20, 2.12078173f-17, 2.57724138f-19, 9.55054025f-20, 1.13061543f-19, 9.26964200f-20,
                9.90166305f-20, 2.18398384f-19, 7.44380343f-20, 9.62076481f-20, 7.16290518f-20, 8.00559991f-20, 5.11937047f-19, 1.54494033f-19, 1.11657051f-19, 1.55196279f-19, 8.70784552f-20, 1.39746876f-19, 2.16993892f-19, 1.80477121f-19, 1.92415296f-19, 2.17696138f-19,
                5.33706661f-19, 7.09268062f-19, 9.12919288f-19, 1.27808700f-18, 9.33986656f-19, 1.16572771f-18, 2.03651226f-18, 2.52808418f-18, 3.33566663f-18, 4.49437188f-18, 3.85532838f-18, 8.35672272f-18, 1.23595227f-17, 1.62920981f-17, 1.01123367f-17, 1.28510946f-17,
                9.41009112f-18, 1.83988349f-17, 2.02246735f-17, 2.20505120f-17, 2.67555576f-17, 3.11094804f-17, 3.47611575f-17, 4.17133890f-17, 4.62779855f-17, 5.09830310f-17, 6.91711922f-17, 8.91851920f-17, 7.09268062f-17, 8.42694728f-17, 1.01123367f-16, 1.26404209f-16,
                1.46067086f-16, 1.72050174f-16, 3.57443014f-16, 4.99998872f-16, 6.48172695f-16, 5.91290801f-16, 8.42694728f-16, 8.56739640f-16, 1.24297472f-15, 1.12359297f-15, 1.37640139f-15, 1.68538946f-15, 1.58005261f-15, 1.55196279f-15, 1.62920981f-15, 1.75561402f-15,
                1.91713051f-15, 2.02246735f-15, 2.12078173f-15, 2.78791506f-15, 5.00701117f-15, 3.06881330f-15, 7.86515079f-15, 8.77807008f-15, 8.14604903f-15, 8.35672272f-15, 9.69098937f-15, 1.19381753f-14, 1.72752419f-14, 2.73875786f-14, 2.80195997f-14, 2.71066804f-14,
                3.56740768f-14, 4.15729399f-14, 4.24858592f-14, 4.87358451f-14, 5.70223432f-14, 6.81880484f-14, 6.29914309f-14, 6.62919852f-14, 7.09268062f-14, 7.23312975f-14, 7.23312975f-14, 7.30335431f-14, 8.28649815f-14, 8.63762096f-14, 8.70784552f-14, 8.21627359f-14,
                7.79492623f-14, 7.65447711f-14, 8.35672272f-14, 1.08145823f-13, 1.33426665f-13, 1.39746876f-13, 1.39746876f-13, 1.41853612f-13, 1.41151367f-13, 1.36235648f-13, 1.39044630f-13, 1.58005261f-13, 1.67836700f-13, 1.74156910f-13, 1.74859156f-13, 1.74156910f-13,
                1.75561402f-13, 1.79072630f-13, 1.83286103f-13, 1.81881612f-13, 1.72752419f-13, 1.71347928f-13, 1.77668138f-13, 1.74156910f-13, 1.74859156f-13, 1.75561402f-13, 1.70645682f-13, 1.70645682f-13, 1.76965893f-13, 1.81179366f-13, 1.85392840f-13, 1.87499577f-13,
                1.89606314f-13, 1.88201822f-13, 1.86797331f-13, 1.86797331f-13, 1.87499577f-13, 1.87499577f-13, 1.88904068f-13, 1.90308559f-13, 1.90308559f-13, 1.90308559f-13, 1.91010805f-13, 1.91010805f-13, 1.90308559f-13, 1.89606314f-13, 1.89606314f-13, 1.89606314f-13,
                1.88904068f-13, 1.88201822f-13, 1.87499577f-13, 1.86797331f-13, 1.86095086f-13, 2.77387014f-13, 3.66572206f-13, 3.63763224f-13, 3.60954242f-13, 3.57443014f-13, 3.53931786f-13, 3.50420558f-13, 3.46909330f-13, 3.44100347f-13, 3.39184628f-13, 3.37077891f-13,
                3.27948698f-13, 3.22330733f-13, 3.28650944f-13, 3.18819505f-13, 3.23032979f-13, 3.18117260f-13, 3.09690312f-13, 3.04774593f-13, 3.02667856f-13, 2.83004979f-13, 3.04072348f-13, 2.98454383f-13, 2.99858874f-13, 2.97049891f-13, 2.90027435f-13, 2.81600488f-13,
                2.73173541f-13, 2.72471295f-13, 2.65448839f-13, 2.64044348f-13, 2.61235366f-13, 2.61235366f-13, 2.66151085f-13, 2.66151085f-13, 5.25981959f-13, 1.48173823f-12, 1.17977262f-12, 1.12359297f-12, 1.05336841f-12, 1.03932350f-12, 1.00421122f-12, 9.26964200f-13,
                8.77807008f-13, 8.14604903f-13, 7.86515079f-13, 7.51402799f-13, 6.98734378f-13, 6.82582729f-13, 6.46065958f-13, 5.78650380f-13, 5.40729117f-13, 4.87358451f-13, 4.57161890f-13, 4.34690030f-13, 5.23875222f-13, 7.79492623f-13, 5.81459362f-13, 5.14746029f-13,
                4.79633749f-13, 4.26263083f-13, 3.86235083f-13, 3.48313821f-13, 3.16712768f-13, 2.87218453f-13, 2.62639857f-13, 2.38763506f-13, 2.23314103f-13, 2.01544489f-13, 1.89606314f-13, 1.73454665f-13, 1.62218735f-13, 1.50280560f-13, 1.41151367f-13, 1.31319928f-13,
                1.20083999f-13, 1.12359297f-13, 1.03932350f-13, 9.90166305f-14, 9.33986656f-14, 8.77807008f-14, 8.14604903f-14, 7.44380343f-14, 6.79071501f-14, 6.49577186f-14, 1.99437752f-13, 4.73313539f-13, 2.35252278f-13, 1.55898525f-13, 1.11657051f-13, 3.18117260f-13)

            flux_active = (0.00000000f+00, 7.45057629f-17, 1.82383899f-14, 3.39001221f-13,
                3.04542306f-12, 8.69233901f-11, 1.50492250f-06, 3.54290425f-06, 4.49564561f-06, 6.25060935f-06, 1.09844559f-05, 1.14517304f-05, 7.93340168f-06, 6.16801626f-06, 4.41059305f-06, 1.55011132f-04, 1.20394884f-03, 7.83643372f-03, 3.21030345f-03, 1.57108683f-02,
                2.50533556f-03, 7.94014370f-03, 4.88886468f-02, 1.07368135f-02, 4.29738140f-03, 2.03368756f-02, 2.27558882f-03, 4.72834050f-03, 3.77991107f-03, 5.31122540f-03, 1.12076938f-02, 1.62672818f-02, 7.10616291f-03, 1.10593718f-02, 1.71074097f-03, 3.70114081f-02,
                2.24586674f-02, 5.61631596f-02, 5.74769469f-03, 1.98166214f-02, 1.11865284f-02, 3.94233792f-02, 8.21324083f-02, 4.54569072f-02, 1.37426963f-01, 2.73807339f-19, 2.12292054f-01, 1.25303693f-02, 3.82341338f-02, 9.37948838f-02, 3.55609717f-20, 6.21792902f-21,
                6.20969465f-21, 3.77440629f-19, 5.41562214f-20, 8.96535720f-21, 7.46646918f-21, 2.58665048f-19, 1.34467691f-19, 9.58735362f-20, 8.22521595f-21, 8.90628478f-21, 6.86307827f-21, 4.04084598f-20, 7.34189769f-21, 7.34189769f-21, 7.34189769f-21, 3.48039577f-20,
                7.57949742f-21, 7.59739896f-21, 5.25578007f-21, 4.47284423f-21, 5.84200231f-21, 1.49837359f-20, 6.32491245f-21, 8.15442865f-21, 1.28337324f-20, 1.31753783f-20, 5.05564624f-20, 2.03230874f-17, 2.42675352f-19, 8.89706579f-20, 1.04996089f-19, 8.58473921f-20,
                9.14120822f-20, 2.00988803f-19, 6.82873050f-20, 8.50155258f-20, 5.80493161f-20, 6.47487790f-20, 4.13117120f-19, 1.25139404f-19, 9.09090834f-20, 1.35247874f-19, 7.70055263f-20, 1.20965440f-19, 1.83768714f-19, 1.53686636f-19, 1.65297366f-19, 1.81616202f-19,
                4.16731875f-19, 5.09237354f-19, 6.59253663f-19, 9.28540603f-19, 6.82630595f-19, 7.81929720f-19, 1.33547094f-18, 1.63050120f-18, 2.12716337f-18, 2.78371703f-18, 2.32634519f-18, 4.82894477f-18, 6.90538254f-18, 8.52393890f-18, 5.22632326f-18, 6.59945559f-18,
                4.80139235f-18, 9.32315281f-18, 1.01772919f-17, 1.10831441f-17, 1.34339776f-17, 1.56027378f-17, 1.74148279f-17, 2.08745345f-17, 2.31314628f-17, 2.54531201f-17, 3.43703348f-17, 4.36447722f-17, 3.44060734f-17, 4.05178514f-17, 4.81658616f-17, 5.96378770f-17,
                6.86790159f-17, 8.01721543f-17, 1.62789463f-16, 2.27713355f-16, 2.92275808f-16, 2.64160894f-16, 3.76476333f-16, 3.82750939f-16, 5.55302592f-16, 5.01968445f-16, 6.14911345f-16, 7.52952667f-16, 7.05893125f-16, 6.93343914f-16, 7.27854245f-16, 7.84325695f-16,
                8.56483659f-16, 9.00513761f-16, 9.29068052f-16, 1.22132038f-15, 2.19344696f-15, 1.34436597f-15, 3.44550171f-15, 3.84541161f-15, 3.56852822f-15, 3.66080325f-15, 4.24528398f-15, 5.22967582f-15, 7.56761614f-15, 1.19973863f-14, 1.22741939f-14, 1.18742269f-14,
                1.56271456f-14, 1.82110701f-14, 1.86108798f-14, 2.13485643f-14, 2.49783018f-14, 2.98692134f-14, 2.75927302f-14, 2.90383477f-14, 3.10684048f-14, 3.16834512f-14, 3.16832816f-14, 3.19907150f-14, 3.62969632f-14, 3.78347676f-14, 3.81421631f-14, 3.59887839f-14,
                3.41430225f-14, 3.35276534f-14, 3.66033890f-14, 4.73688381f-14, 5.84417601f-14, 6.12097264f-14, 6.12093987f-14, 6.21318209f-14, 6.18239067f-14, 5.96705159f-14, 6.09005098f-14, 6.92047544f-14, 7.35104345f-14, 7.62782015f-14, 7.65853649f-14, 7.62773849f-14,
                7.68921135f-14, 7.84295359f-14, 8.02745070f-14, 7.96589503f-14, 7.56602195f-14, 7.50446941f-14, 7.78123195f-14, 7.62741183f-14, 7.65812653f-14, 7.68884090f-14, 7.47351334f-14, 7.47347333f-14, 7.75022715f-14, 7.93471389f-14, 8.11919866f-14, 8.21141832f-14,
                8.30363699f-14, 8.24208444f-14, 8.18053255f-14, 8.18048876f-14, 8.21119852f-14, 8.21115456f-14, 8.27261704f-14, 8.33407887f-14, 8.33403425f-14, 8.33398963f-14, 8.36469758f-14, 8.36465279f-14, 8.33385578f-14, 8.30305909f-14, 8.30301463f-14, 8.30297018f-14,
                8.27217415f-14, 8.24137845f-14, 8.21058307f-14, 8.17978803f-14, 8.14899332f-14, 1.21465476f-13, 1.60517644f-13, 1.59285918f-13, 1.58054219f-13, 1.56515050f-13, 1.54975915f-13, 1.53436812f-13, 1.51897742f-13, 1.50666188f-13, 1.48512223f-13, 1.47588206f-13,
                1.43589488f-13, 1.41128199f-13, 1.43893878f-13, 1.39587865f-13, 1.41431124f-13, 1.39277420f-13, 1.35586499f-13, 1.33432904f-13, 1.32509137f-13, 1.23899328f-13, 1.33121177f-13, 1.30660264f-13, 1.31273730f-13, 1.30042606f-13, 1.26966953f-13, 1.23276520f-13,
                1.19586166f-13, 1.19277469f-13, 1.16202063f-13, 1.15585999f-13, 1.14355136f-13, 1.14353911f-13, 1.16504484f-13, 1.16503236f-13, 2.30237437f-13, 6.48585561f-13, 5.16376164f-13, 4.91760480f-13, 4.61000753f-13, 4.54829709f-13, 4.39440296f-13, 4.05615463f-13,
                3.84084972f-13, 3.56411755f-13, 3.44103254f-13, 3.28723885f-13, 3.05666109f-13, 2.98584457f-13, 2.82595655f-13, 2.53093846f-13, 2.36494922f-13, 2.13141139f-13, 1.99924270f-13, 1.90086772f-13, 2.29074521f-13, 3.40825304f-13, 2.54206580f-13, 2.25016230f-13,
                2.09644747f-13, 1.86296793f-13, 1.68784584f-13, 1.52196674f-13, 1.38373657f-13, 1.25473951f-13, 1.14724256f-13, 1.04283582f-13, 9.75253495f-14, 8.80087108f-14, 8.27867605f-14, 7.57264215f-14, 7.08134597f-14, 6.55950327f-14, 6.16036690f-14, 5.73067085f-14,
                5.23978299f-14, 4.90219406f-14, 4.53404216f-14, 4.31912992f-14, 4.07363495f-14, 3.82819267f-14, 3.55218082f-14, 3.24560929f-14, 2.96053458f-14, 2.83164420f-14, 8.69297783f-14, 2.06233047f-13, 1.02369424f-13, 6.77657400f-14, 4.84825649f-14, 1.37980404f-13)

        else

            solar_flux_hydrogen = (0.00000000f+00, 3.84000000f-24, 9.40000000f-22, 1.74720000f-20,
                1.56960000f-19, 4.48000000f-18, 7.75631600f-14, 1.82600000f-13, 5.93280000f-13, 8.76080000f-13, 1.54560000f-12, 1.62756000f-12, 1.12000000f-12, 8.65000000f-13, 5.90400000f-13, 1.86901600f-11, 8.76420000f-11, 4.84552000f-10, 3.07668817f-10, 1.01898353f-09,
                3.01813953f-10, 1.16896744f-09, 5.72309382f-09, 1.36720000f-09, 6.45075000f-10, 2.33269318f-09, 3.46625000f-10, 6.76605882f-10, 5.17072131f-10, 7.26547950f-10, 1.54377640f-09, 2.35104000f-09, 1.04350400f-09, 1.77524800f-09, 2.88303529f-10, 6.45600000f-09,
                3.97440000f-09, 9.64800000f-09, 9.72900000f-10, 3.29508000f-09, 1.69494000f-09, 6.56016000f-09, 1.09568000f-08, 6.00953270f-09, 1.86179483f-08, 3.73000000f-26, 2.89199467f-08, 1.70697680f-09, 5.20852800f-09, 1.56465280f-08, 5.94000000f-27, 1.04000000f-27,
                1.04000000f-27, 5.30000000f-26, 7.56000000f-27, 1.25000000f-27, 1.04000000f-27, 3.60000000f-26, 2.46000000f-26, 1.83000000f-26, 1.57000000f-27, 1.70000000f-27, 1.31000000f-27, 7.21000000f-27, 1.31000000f-27, 1.31000000f-27, 1.31000000f-27, 6.21000000f-27,
                1.31000000f-27, 1.31000000f-27, 9.15000000f-28, 7.84000000f-28, 1.03000000f-27, 2.66000000f-27, 1.12000000f-27, 1.24000000f-27, 1.82000000f-27, 1.90000000f-27, 7.40000000f-27, 3.02000000f-24, 3.67000000f-26, 1.36000000f-26, 1.61000000f-26, 1.32000000f-26,
                1.41000000f-26, 3.11000000f-26, 1.06000000f-26, 1.37000000f-26, 1.02000000f-26, 1.14000000f-26, 7.29000000f-26, 2.20000000f-26, 1.59000000f-26, 2.21000000f-26, 1.24000000f-26, 1.99000000f-26, 3.09000000f-26, 2.57000000f-26, 2.74000000f-26, 3.10000000f-26,
                7.60000000f-26, 1.01000000f-25, 1.30000000f-25, 1.82000000f-25, 1.33000000f-25, 1.66000000f-25, 2.90000000f-25, 3.60000000f-25, 4.75000000f-25, 6.40000000f-25, 5.49000000f-25, 1.19000000f-24, 1.76000000f-24, 2.32000000f-24, 1.44000000f-24, 1.83000000f-24,
                1.34000000f-24, 2.62000000f-24, 2.88000000f-24, 3.14000000f-24, 3.81000000f-24, 4.43000000f-24, 4.95000000f-24, 5.94000000f-24, 6.59000000f-24, 7.26000000f-24, 9.85000000f-24, 1.27000000f-23, 1.01000000f-23, 1.20000000f-23, 1.44000000f-23, 1.80000000f-23,
                2.08000000f-23, 2.45000000f-23, 5.09000000f-23, 7.12000000f-23, 9.23000000f-23, 8.42000000f-23, 1.20000000f-22, 1.22000000f-22, 1.77000000f-22, 1.60000000f-22, 1.96000000f-22, 2.40000000f-22, 2.25000000f-22, 2.21000000f-22, 2.32000000f-22, 2.50000000f-22,
                2.73000000f-22, 2.88000000f-22, 3.02000000f-22, 3.97000000f-22, 7.13000000f-22, 4.37000000f-22, 1.12000000f-21, 1.25000000f-21, 1.16000000f-21, 1.19000000f-21, 1.38000000f-21, 1.70000000f-21, 2.46000000f-21, 3.90000000f-21, 3.99000000f-21, 3.86000000f-21,
                5.08000000f-21, 5.92000000f-21, 6.05000000f-21, 6.94000000f-21, 8.12000000f-21, 9.71000000f-21, 8.97000000f-21, 9.44000000f-21, 1.01000000f-20, 1.03000000f-20, 1.03000000f-20, 1.04000000f-20, 1.18000000f-20, 1.23000000f-20, 1.24000000f-20, 1.17000000f-20,
                1.11000000f-20, 1.09000000f-20, 1.19000000f-20, 1.54000000f-20, 1.90000000f-20, 1.99000000f-20, 1.99000000f-20, 2.02000000f-20, 2.01000000f-20, 1.94000000f-20, 1.98000000f-20, 2.25000000f-20, 2.39000000f-20, 2.48000000f-20, 2.49000000f-20, 2.48000000f-20,
                2.50000000f-20, 2.55000000f-20, 2.61000000f-20, 2.59000000f-20, 2.46000000f-20, 2.44000000f-20, 2.53000000f-20, 2.48000000f-20, 2.49000000f-20, 2.50000000f-20, 2.43000000f-20, 2.43000000f-20, 2.52000000f-20, 2.58000000f-20, 2.64000000f-20, 2.67000000f-20,
                2.70000000f-20, 2.68000000f-20, 2.66000000f-20, 2.66000000f-20, 2.67000000f-20, 2.67000000f-20, 2.69000000f-20, 2.71000000f-20, 2.71000000f-20, 2.71000000f-20, 2.72000000f-20, 2.72000000f-20, 2.71000000f-20, 2.70000000f-20, 2.70000000f-20, 2.70000000f-20,
                2.69000000f-20, 2.68000000f-20, 2.67000000f-20, 2.66000000f-20, 2.65000000f-20, 3.95000000f-20, 5.22000000f-20, 5.18000000f-20, 5.14000000f-20, 5.09000000f-20, 5.04000000f-20, 4.99000000f-20, 4.94000000f-20, 4.90000000f-20, 4.83000000f-20, 4.80000000f-20,
                4.67000000f-20, 4.59000000f-20, 4.68000000f-20, 4.54000000f-20, 4.60000000f-20, 4.53000000f-20, 4.41000000f-20, 4.34000000f-20, 4.31000000f-20, 4.03000000f-20, 4.33000000f-20, 4.25000000f-20, 4.27000000f-20, 4.23000000f-20, 4.13000000f-20, 4.01000000f-20,
                3.89000000f-20, 3.88000000f-20, 3.78000000f-20, 3.76000000f-20, 3.72000000f-20, 3.72000000f-20, 3.79000000f-20, 3.79000000f-20, 7.49000000f-20, 2.11000000f-19, 1.68000000f-19, 1.60000000f-19, 1.50000000f-19, 1.48000000f-19, 1.43000000f-19, 1.32000000f-19,
                1.25000000f-19, 1.16000000f-19, 1.12000000f-19, 1.07000000f-19, 9.95000000f-20, 9.72000000f-20, 9.20000000f-20, 8.24000000f-20, 7.70000000f-20, 6.94000000f-20, 6.51000000f-20, 6.19000000f-20, 7.46000000f-20, 1.11000000f-19, 8.28000000f-20, 7.33000000f-20,
                6.83000000f-20, 6.07000000f-20, 5.50000000f-20, 4.96000000f-20, 4.51000000f-20, 4.09000000f-20, 3.74000000f-20, 3.40000000f-20, 3.18000000f-20, 2.87000000f-20, 2.70000000f-20, 2.47000000f-20, 2.31000000f-20, 2.14000000f-20, 2.01000000f-20, 1.87000000f-20,
                1.71000000f-20, 1.60000000f-20, 1.48000000f-20, 1.41000000f-20, 1.33000000f-20, 1.25000000f-20, 1.16000000f-20, 1.06000000f-20, 9.67000000f-21, 9.25000000f-21, 2.84000000f-20, 6.74000000f-20, 3.35000000f-20, 2.22000000f-20, 1.59000000f-20, 4.53000000f-20)

            solar_flux_hydrogen_active = (0.00000000f+00, 2.44608000f-23, 5.98780000f-21, 1.11296640f-19,
                9.99835200f-19, 2.85376000f-17, 4.94077329f-13, 1.16316200f-12, 1.47595412f-12, 2.05212187f-12, 3.60627913f-12, 3.75968885f-12, 2.60459519f-12, 2.02500593f-12, 1.44803073f-12, 5.08913157f-11, 3.95265420f-10, 2.57275988f-09, 1.05396667f-09, 5.15799574f-09,
                8.22520430f-10, 2.60680865f-09, 1.60505089f-08, 3.52497630f-09, 1.41086250f-09, 6.67674859f-09, 7.47092853f-10, 1.55234960f-09, 1.24097311f-09, 1.74371508f-09, 3.67956981f-09, 5.34067046f-09, 2.33300651f-09, 3.63087458f-09, 5.61649073f-10, 1.21511225f-08,
                7.37334872f-09, 1.84387859f-08, 1.88701122f-09, 6.50594524f-09, 3.67262106f-09, 1.29429907f-08, 2.69646848f-08, 1.49238431f-08, 4.51183012f-08, 8.98930000f-26, 6.96970715f-08, 4.11381409f-09, 1.25525525f-08, 3.07935629f-08, 1.16749334f-26, 2.04139267f-27,
                2.03868926f-27, 1.23916585f-25, 1.77798931f-26, 2.94339392f-27, 2.45129776f-27, 8.49216727f-26, 4.41467500f-26, 3.14760000f-26, 2.70040000f-27, 2.92400000f-27, 2.25320000f-27, 1.32664000f-26, 2.41040000f-27, 2.41040000f-27, 2.41040000f-27, 1.14264000f-26,
                2.48840577f-27, 2.49428298f-27, 1.72551196f-27, 1.46846826f-27, 1.91797311f-27, 4.91927273f-27, 2.07651613f-27, 2.67716000f-27, 4.21341047f-27, 4.32557537f-27, 1.65980653f-26, 6.67222180f-24, 7.96721358f-26, 2.92097334f-26, 3.44710025f-26, 2.81843418f-26,
                3.00112713f-26, 6.59861295f-26, 2.24192337f-26, 2.79112339f-26, 1.90580252f-26, 2.12575091f-26, 1.35629445f-25, 4.10842038f-26, 2.98461330f-26, 4.44028899f-26, 2.52814910f-26, 3.97138600f-26, 6.03326451f-26, 5.04564735f-26, 5.42683634f-26, 5.96259593f-26,
                1.36816196f-25, 1.67186438f-25, 2.16437915f-25, 3.04846835f-25, 2.24112737f-25, 2.56713383f-25, 4.38445113f-25, 5.35305755f-25, 6.98363665f-25, 9.13915152f-25, 7.63756550f-25, 1.58537874f-24, 2.26708881f-24, 2.79847299f-24, 1.71584107f-24, 2.16665070f-24,
                1.57633307f-24, 3.06086090f-24, 3.34128117f-24, 3.63867920f-24, 4.41047548f-24, 5.12249570f-24, 5.71741844f-24, 6.85326602f-24, 7.59423248f-24, 8.35644995f-24, 1.12840383f-23, 1.43289056f-23, 1.12957716f-23, 1.33023141f-23, 1.58132131f-23, 1.95795617f-23,
                2.25478353f-23, 2.63211187f-23, 5.34450000f-23, 7.47600000f-23, 9.59563367f-23, 8.67260000f-23, 1.23600000f-22, 1.25660000f-22, 1.82310000f-22, 1.64800000f-22, 2.01880000f-22, 2.47200000f-22, 2.31750000f-22, 2.27630000f-22, 2.38960000f-22, 2.57500000f-22,
                2.81190000f-22, 2.95645412f-22, 3.05020000f-22, 4.00968627f-22, 7.20125067f-22, 4.41365417f-22, 1.13118402f-21, 1.26247743f-21, 1.17157454f-21, 1.20186912f-21, 1.39375853f-21, 1.71694174f-21, 2.48450506f-21, 3.93883177f-21, 4.02970977f-21, 3.89839761f-21,
                5.13050893f-21, 5.97883072f-21, 6.11009122f-21, 7.00889357f-21, 8.20056357f-21, 9.80628646f-21, 9.05889997f-21, 9.53350703f-21, 1.01999900f-20, 1.04019143f-20, 1.04018586f-20, 1.05027914f-20, 1.19165649f-20, 1.24214376f-20, 1.25223578f-20, 1.18153873f-20,
                1.12094100f-20, 1.10073797f-20, 1.20171668f-20, 1.55515443f-20, 1.91868676f-20, 2.00956116f-20, 2.00955041f-20, 2.03983422f-20, 2.02972516f-20, 1.95902773f-20, 1.99940935f-20, 2.27204392f-20, 2.41340262f-20, 2.50427049f-20, 2.51435489f-20, 2.50424368f-20,
                2.52442568f-20, 2.57490041f-20, 2.63547219f-20, 2.61526300f-20, 2.48398168f-20, 2.46377351f-20, 2.55463673f-20, 2.50413643f-20, 2.51422030f-20, 2.52430405f-20, 2.45361041f-20, 2.45359727f-20, 2.54445762f-20, 2.60502600f-20, 2.66559373f-20, 2.69587014f-20,
                2.72614622f-20, 2.70593805f-20, 2.68573011f-20, 2.68571573f-20, 2.69579797f-20, 2.69578354f-20, 2.71596214f-20, 2.73614051f-20, 2.73612586f-20, 2.73611122f-20, 2.74619286f-20, 2.74617816f-20, 2.73606727f-20, 2.72595649f-20, 2.72594189f-20, 2.72592730f-20,
                2.71581673f-20, 2.70570627f-20, 2.69559592f-20, 2.68548568f-20, 2.67537554f-20, 3.98780257f-20, 5.26991449f-20, 5.22947600f-20, 5.18903838f-20, 5.13850632f-20, 5.08797535f-20, 5.03744546f-20, 4.98691665f-20, 4.94648378f-20, 4.87576751f-20, 4.84543135f-20,
                4.71415043f-20, 4.63334449f-20, 4.72414378f-20, 4.58277416f-20, 4.64328973f-20, 4.57258200f-20, 4.45140632f-20, 4.38070216f-20, 4.35037422f-20, 4.06770773f-20, 4.37046795f-20, 4.28967432f-20, 4.30981486f-20, 4.26939616f-20, 4.16842016f-20, 4.04726049f-20,
                3.92610341f-20, 3.91596865f-20, 3.81500076f-20, 3.79477492f-20, 3.75436476f-20, 3.75432454f-20, 3.82492946f-20, 3.82488849f-20, 7.55886751f-20, 2.12935497f-19, 1.69530162f-19, 1.61448649f-19, 1.51350000f-19, 1.49324000f-19, 1.44271541f-19, 1.33166595f-19,
                1.26097973f-19, 1.17012649f-19, 1.12971676f-19, 1.07922514f-19, 1.00352473f-19, 9.80275135f-20, 9.27782703f-20, 8.30926054f-20, 7.76430541f-20, 6.99758324f-20, 6.56366351f-20, 6.24069108f-20, 7.52068811f-20, 1.11895500f-19, 8.34579243f-20, 7.38745135f-20,
                6.88279405f-20, 6.11626324f-20, 5.54132432f-20, 4.99673081f-20, 4.54291081f-20, 4.11940378f-20, 3.76648324f-20, 3.42370811f-20, 3.20183027f-20, 2.88939189f-20, 2.71795135f-20, 2.48615514f-20, 2.32485892f-20, 2.15353405f-20, 2.02249459f-20, 1.88142216f-20,
                1.72026000f-20, 1.60942703f-20, 1.48856000f-20, 1.41800270f-20, 1.33740486f-20, 1.25682432f-20, 1.16620757f-20, 1.06555784f-20, 9.71965676f-21, 9.29650000f-21, 2.85396973f-20, 6.77078541f-20, 3.36086486f-20, 2.22480000f-20, 1.59171892f-20, 4.53000000f-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_hydrogen, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_hydrogen_active, wvl_range[1], wvl_range[2])
        end
    
    elseif parent_type == "H"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_quiet = (7.59663731f-09, 7.59533215f-09, 7.59272183f-09, 7.59011150f-09,
                7.58750118f-09, 7.58489085f-09, 7.59706858f-06, 9.04774653f-06, 1.26558707f-05, 2.40973856f-05, 2.88308310f-05, 2.23913973f-05, 1.32301306f-05, 1.00977998f-05, 1.17860154f-04, 1.18387785f-04, 5.96234036f-04, 3.05222668f-03, 1.99667102f-03, 3.67994457f-03,
                6.45242840f-03, 6.49626276f-03, 2.93819154f-02, 7.03588616f-03, 3.33964754f-03, 1.15667868f-03, 1.15467841f-03, 2.15487875f-03, 1.74209391f-03, 3.64184024f-03, 8.21173365f-03, 1.32083984f-02, 5.81872647f-03, 9.38414985f-03, 1.50481881f-03, 3.22306246f-02,
                1.94167227f-02, 9.05517879f-02, 1.98499583f-03, 1.13232681f-02, 6.08934371f-03, 2.14580808f-02, 5.90271855f-02, 4.13904286f-02, 1.14773530f-01, 1.70830316f-01, 3.18747416f-01, 1.80284485f-03, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12,
                3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12, 3.39594420f-12)


            flux_active = (2.15613201f-08, 2.15799442f-08, 2.16171926f-08, 2.16544409f-08,
                2.16916892f-08, 2.17289375f-08, 1.00577718f-05, 1.42137075f-05, 2.54375674f-05, 2.54249388f-05, 2.09575118f-05, 2.09575118f-05, 1.36666073f-05, 1.11972101f-05, 1.90600417f-04, 1.91016976f-04, 1.23092629f-03, 7.38921736f-03, 4.77940482f-03, 3.54796104f-03,
                7.47355604f-03, 7.47355604f-03, 3.95590571f-02, 9.38287060f-03, 3.17901909f-03, 1.51204652f-03, 1.50194954f-03, 2.86174951f-03, 1.87520231f-03, 3.88750398f-03, 8.62222608f-03, 1.40394101f-02, 5.84575679f-03, 8.89710961f-03, 1.41797780f-03, 2.74507797f-02,
                1.58861883f-02, 1.79174433f-03, 1.78718967f-03, 1.05488579f-02, 6.22598971f-03, 1.88331598f-02, 6.58328993f-02, 4.75962678f-02, 1.27596916f-01, 1.91041362f-01, 3.48389390f-01, 2.01909394f-03, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12,
                1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12, 1.49543240f-12)

        else

            solar_flux_atomic_H_quiet = (2.23697354f-17, 2.23658921f-17, 2.23582055f-17, 2.23505189f-17,
                2.23428323f-17, 2.23351457f-17, 2.23710053f-14, 2.66428009f-14, 3.72676051f-14, 7.09593096f-14, 8.48978349f-14, 6.59357045f-14, 3.89586218f-14, 2.97348815f-14, 3.47061515f-13, 3.48615224f-13, 1.75572389f-12, 8.98785875f-12, 5.87957547f-12, 1.08362928f-11,
                1.90003958f-11, 1.91294744f-11, 8.65206073f-11, 2.07184976f-11, 9.83422384f-12, 3.40605916f-12, 3.40016899f-12, 6.34544806f-12, 5.12992501f-12, 1.07240874f-11, 2.41810029f-11, 3.88946273f-11, 1.71343406f-11, 2.76334041f-11, 4.43122360f-12, 9.49091702f-11,
                5.71762123f-11, 2.66646867f-10, 5.84519565f-12, 3.33435046f-11, 1.79312243f-11, 6.31873773f-11, 1.73816712f-10, 1.21881946f-10, 3.37972366f-10, 5.03042176f-10, 9.38612053f-10, 5.30881765f-12, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20)

            solar_flux_atomic_H_active = (1.44181175f-16, 1.44305715f-16, 1.44554796f-16, 1.44803876f-16,
                1.45052957f-16, 1.45302038f-16, 6.72566125f-14, 9.50474755f-14, 1.70101754f-13, 1.70017305f-13, 1.40143491f-13, 1.40143491f-13, 9.13890005f-14, 7.48760700f-14, 1.27455053f-12, 1.27733608f-12, 8.23123994f-12, 4.94119115f-11, 3.19600191f-11, 2.37253188f-11,
                4.99758868f-11, 4.99758868f-11, 2.64532566f-10, 6.27435287f-11, 2.12581932f-11, 1.01110991f-11, 1.00435803f-11, 1.91366023f-11, 1.25395324f-11, 2.59958522f-11, 5.76570767f-11, 9.38819438f-11, 3.90907458f-11, 5.94952309f-11, 9.48205883f-12, 1.83564163f-10,
                1.06231404f-10, 1.19814465f-11, 1.19509893f-11, 7.05405194f-11, 4.16333744f-11, 1.25937888f-10, 4.40226513f-10, 3.18277628f-10, 8.53244292f-10, 1.27749915f-09, 2.32968999f-09, 1.35017399f-11, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_atomic_H_quiet, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_atomic_H_active, wvl_range[1], wvl_range[2])
        end
    
    elseif parent_type == "H(-)"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_active = flux_quiet = (6.60089163f-10, 6.60102502f-10, 6.60129178f-10, 6.60155855f-10,
                6.60182532f-10, 6.60209209f-10, 6.60609360f-10, 6.60742744f-10, 6.60876127f-10, 6.61009511f-10, 6.61142895f-10, 6.61276279f-10, 6.61409662f-10, 6.61543046f-10, 6.61676430f-10, 6.61783137f-10, 6.62116596f-10, 6.62423379f-10, 6.62810192f-10, 6.63156990f-10, 
                6.63677186f-10, 6.63810570f-10, 6.64077337f-10, 6.64344105f-10, 6.64610872f-10, 6.64877640f-10, 6.65011024f-10, 6.65411175f-10, 6.65811326f-10, 6.66211477f-10, 6.66478245f-10, 6.66745012f-10, 6.67011780f-10, 8.61165727f-10, 1.17261150f-09, 1.48405728f-09, 
                1.79550306f-09, 1.42772531f-09, 1.22677513f-09, 6.82343994f-10, 7.11334198f-10, 7.40324402f-10, 7.69314606f-10, 6.89283664f-10, 1.45583131f-09, 2.59649783f-09, 4.47919049f-09, 6.36112671f-09, 7.16767080f-09, 8.06383090f-09, 8.95999101f-09, 9.85615111f-09, 
                1.07523112f-08, 1.10091405f-08, 1.03202931f-08, 9.28702198f-09, 8.70621955f-09, 8.46627039f-09, 8.22632124f-09, 8.03436192f-09, 6.86486971f-09, 1.98064919f-09, 1.91587751f-09, 1.86605313f-09, 1.81622876f-09, 1.76640439f-09, 1.71658002f-09, 1.66675565f-09, 
                3.66647057f-08, 2.63798229f-07, 4.90931752f-07, 6.49925218f-07, 7.86205332f-07, 9.45198798f-07, 1.08147891f-06, 1.24047238f-06, 1.31993827f-06, 1.08131970f-06, 8.72528445f-07, 6.63737193f-07, 4.25118620f-07, 2.16327368f-07, 1.98532602f-08, 2.18950891f-08, 
                2.42286080f-08, 2.65621268f-08, 2.88956456f-08, 3.12291644f-08, 3.35626832f-08, 3.60473300f-08, 3.89024578f-08, 4.14403491f-08, 4.42954769f-08, 4.68333683f-08, 4.96884961f-08, 4.73899180f-08, 1.86598708f-08, 1.65663713f-08, 1.70924917f-08, 1.75660001f-08, 
                1.80921205f-08, 1.90917494f-08, 2.01439903f-08, 2.63181574f-08, 3.38556492f-08, 4.17520693f-08, 5.05737800f-08, 6.77801788f-08, 8.41416894f-08, 9.46531817f-08, 1.05585134f-07, 3.32327584f-07, 4.29109844f-07, 5.25892103f-07, 6.26130872f-07, 6.96886997f-07, 
                7.78163577f-07, 8.64858595f-07, 9.51553613f-07, 1.03824863f-06, 1.12494365f-06, 1.28560923f-06, 1.59305808f-06, 1.90050692f-06, 2.22604100f-06, 2.55157507f-06, 2.93675859f-06, 3.42493866f-06, 3.91311873f-06, 4.43896559f-06, 5.56287922f-06, 6.68679285f-06,
                9.00028852f-06, 1.30442339f-05, 1.75669589f-05, 2.26790154f-05, 2.80234382f-05, 3.31354947f-05, 3.99251923f-05, 4.72375236f-05, 5.45498549f-05, 5.88868759f-05, 5.83914818f-05, 5.78960878f-05, 5.73816401f-05, 5.68671924f-05, 6.01590148f-05, 6.42364871f-05,
                6.83139593f-05, 7.25320341f-05, 9.43078018f-05, 1.32757039f-04, 1.64354398f-04, 2.84718535f-04, 2.88725229f-04, 2.92731922f-04, 2.96853093f-04, 3.01088740f-04, 3.40105229f-04, 3.82093777f-04, 8.73072586f-04, 8.71151289f-04, 8.69229992f-04, 8.93482081f-04,
                1.04139140f-03, 1.19587447f-03, 1.42271277f-03, 1.72585007f-03, 2.02898737f-03, 2.16791439f-03, 2.26354778f-03, 2.35918117f-03, 2.45481456f-03, 2.55044795f-03, 2.64608135f-03, 2.86963654f-03, 3.20655419f-03, 3.35681636f-03, 3.26666576f-03, 3.17651516f-03,
                3.08636456f-03, 3.24828219f-03, 3.49056484f-03, 5.76273629f-03, 5.82693082f-03, 5.89112535f-03, 5.95531988f-03, 6.01951441f-03, 6.08370894f-03, 6.47121665f-03, 7.14657350f-03, 7.69058512f-03, 7.90371072f-03, 8.11683632f-03, 8.32996192f-03, 8.54308752f-03,
                8.75621312f-03, 8.96933871f-03, 9.18246431f-03, 9.39558991f-03, 9.42172569f-03, 9.42801678f-03, 9.43430786f-03, 9.44059895f-03, 9.44689004f-03, 9.45318112f-03, 9.45947221f-03, 9.70081124f-03, 1.00119173f-02, 1.03230233f-02, 1.06341294f-02, 1.09452354f-02,
                1.11744224f-02, 1.12317499f-02, 1.12890773f-02, 1.13464048f-02, 1.14037322f-02, 1.14610597f-02, 1.15183871f-02, 1.15757146f-02, 1.16330420f-02, 1.16903695f-02, 1.17476969f-02, 1.18050244f-02, 1.18623519f-02, 1.19209454f-02, 1.20021162f-02, 1.20832870f-02,
                1.21644577f-02, 1.22456285f-02, 1.23267993f-02, 1.24079701f-02, 1.24891409f-02, 1.25703117f-02, 1.26920678f-02, 1.28455926f-02, 1.26914263f-02, 1.25372599f-02, 1.23830935f-02, 1.23368178f-02, 1.23063761f-02, 1.22759344f-02, 1.22449466f-02, 1.21839179f-02,
                1.21228893f-02, 1.20618607f-02, 1.20008320f-02, 1.19398034f-02, 1.18787748f-02, 1.17516393f-02, 1.13845078f-02, 1.10173762f-02, 1.06502447f-02, 1.11290009f-02, 1.15013213f-02, 1.13177221f-02, 1.11341230f-02, 1.09505238f-02, 1.07669247f-02, 1.05833255f-02,
                1.03997263f-02, 1.02161272f-02, 1.00628961f-02, 9.91611605f-03, 9.76933599f-03, 9.62255592f-03, 9.47577586f-03, 9.32899579f-03, 9.18221573f-03, 8.95546270f-03, 7.27529487f-03, 6.87077561f-03, 5.68127147f-03, 5.04178068f-03, 4.11843972f-03, 3.17671910f-03,
                2.38562417f-03, 1.67200894f-03, 1.06965999f-03, 5.85453529f-04, 2.40111106f-04, 5.34755186f-05, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20,
                6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20,
                6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20, 6.52656971f-20)

        else
            solar_flux_negative_H = (1.01138759f-10, 1.01140803f-10, 1.01144890f-10, 1.01148978f-10,
                1.01153065f-10, 1.01157153f-10, 1.01218464f-10, 1.01238901f-10, 1.01259338f-10, 1.01279775f-10, 1.01300212f-10, 1.01320649f-10, 1.01341086f-10, 1.01361523f-10, 1.01381960f-10, 1.01398310f-10, 1.01449402f-10, 1.01496407f-10, 1.01555675f-10, 1.01608811f-10,
                1.01688516f-10, 1.01708953f-10, 1.01749827f-10, 1.01790701f-10, 1.01831575f-10, 1.01872449f-10, 1.01892886f-10, 1.01954197f-10, 1.02015508f-10, 1.02076819f-10, 1.02117693f-10, 1.02158568f-10, 1.02199442f-10, 1.31947679f-10, 1.79667353f-10, 2.27387027f-10,
                2.75106701f-10, 2.18755851f-10, 1.87966295f-10, 1.04548641f-10, 1.08990516f-10, 1.13432390f-10, 1.17874265f-10, 1.05611936f-10, 2.23062248f-10, 3.97834996f-10, 6.86300873f-10, 9.74650849f-10, 1.09822941f-09, 1.23553892f-09, 1.37284843f-09, 1.51015795f-09,
                1.64746746f-09, 1.68681881f-09, 1.58127371f-09, 1.42295607f-09, 1.33396561f-09, 1.29720064f-09, 1.26043567f-09, 1.23102369f-09, 1.05183427f-09, 3.03474762f-10, 2.93550455f-10, 2.85916372f-10, 2.78282290f-10, 2.70648207f-10, 2.63014125f-10, 2.55380042f-10,
                5.61776052f-09, 4.04191237f-08, 7.52204870f-08, 9.95814412f-08, 1.20462259f-07, 1.44823213f-07, 1.65704031f-07, 1.90064986f-07, 2.02240737f-07, 1.65679636f-07, 1.33688673f-07, 1.01697710f-07, 6.51366090f-08, 3.31456458f-08, 3.04191345f-09, 3.35476217f-09,
                3.71230356f-09, 4.06984495f-09, 4.42738634f-09, 4.78492773f-09, 5.14246912f-09, 5.52316631f-09, 5.96062855f-09, 6.34948387f-09, 6.78694611f-09, 7.17580143f-09, 7.61326367f-09, 7.26107589f-09, 2.85906251f-09, 2.53829684f-09, 2.61890893f-09, 2.69145981f-09,
                2.77207191f-09, 2.92523488f-09, 3.08645907f-09, 4.03246400f-09, 5.18735733f-09, 6.39724559f-09, 7.74890674f-09, 1.03852685f-08, 1.28921766f-08, 1.45027458f-08, 1.61777378f-08, 5.09191810f-08, 6.57481438f-08, 8.05771066f-08, 9.59356752f-08, 1.06776918f-07,
                1.19230103f-07, 1.32513500f-07, 1.45796897f-07, 1.59080294f-07, 1.72363692f-07, 1.96980847f-07, 2.44088112f-07, 2.91195377f-07, 3.41073657f-07, 3.90951938f-07, 4.49969697f-07, 5.24768571f-07, 5.99567445f-07, 6.80137619f-07, 8.52343492f-07, 1.02454937f-06,
                1.37902281f-06, 1.99863550f-06, 2.69160673f-06, 3.47487523f-06, 4.29374685f-06, 5.07701536f-06, 6.11733177f-06, 7.23772604f-06, 8.35812031f-06, 9.02263800f-06, 8.94673380f-06, 8.87082960f-06, 8.79200601f-06, 8.71318241f-06, 9.21755493f-06, 9.84230460f-06,
                1.04670543f-05, 1.11133470f-05, 1.44498268f-05, 2.03410129f-05, 2.51823555f-05, 4.36245299f-05, 4.42384348f-05, 4.48523398f-05, 4.54837849f-05, 4.61327701f-05, 5.21108706f-05, 5.85443494f-05, 1.33772046f-04, 1.33477666f-04, 1.33183285f-04, 1.36899186f-04,
                1.59561829f-04, 1.83231701f-04, 2.17987831f-04, 2.64434481f-04, 3.10881130f-04, 3.32167506f-04, 3.46820440f-04, 3.61473373f-04, 3.76126307f-04, 3.90779240f-04, 4.05432174f-04, 4.39685266f-04, 4.91307737f-04, 5.14330882f-04, 5.00518021f-04, 4.86705160f-04,
                4.72892299f-04, 4.97701294f-04, 5.34823804f-04, 8.82965561f-04, 8.92801437f-04, 9.02637313f-04, 9.12473189f-04, 9.22309065f-04, 9.32144941f-04, 9.91518812f-04, 1.09499688f-03, 1.17835026f-03, 1.21100533f-03, 1.24366040f-03, 1.27631547f-03, 1.30897055f-03,
                1.34162562f-03, 1.37428069f-03, 1.40693576f-03, 1.43959083f-03, 1.44359535f-03, 1.44455927f-03, 1.44552319f-03, 1.44648711f-03, 1.44745103f-03, 1.44841495f-03, 1.44937887f-03, 1.48635680f-03, 1.53402442f-03, 1.58169204f-03, 1.62935966f-03, 1.67702728f-03,
                1.71214327f-03, 1.72092697f-03, 1.72971068f-03, 1.73849438f-03, 1.74727809f-03, 1.75606179f-03, 1.76484549f-03, 1.77362920f-03, 1.78241290f-03, 1.79119660f-03, 1.79998031f-03, 1.80876401f-03, 1.81754771f-03, 1.82652541f-03, 1.83896238f-03, 1.85139936f-03,
                1.86383633f-03, 1.87627331f-03, 1.88871028f-03, 1.90114726f-03, 1.91358423f-03, 1.92602121f-03, 1.94467667f-03, 1.96819971f-03, 1.94457836f-03, 1.92095701f-03, 1.89733566f-03, 1.89024531f-03, 1.88558104f-03, 1.88091677f-03, 1.87616882f-03, 1.86681802f-03,
                1.85746722f-03, 1.84811642f-03, 1.83876562f-03, 1.82941483f-03, 1.82006403f-03, 1.80058436f-03, 1.74433252f-03, 1.68808068f-03, 1.63182884f-03, 1.70518380f-03, 1.76223067f-03, 1.73409963f-03, 1.70596860f-03, 1.67783756f-03, 1.64970653f-03, 1.62157549f-03,
                1.59344446f-03, 1.56531342f-03, 1.54183538f-03, 1.51934577f-03, 1.49685615f-03, 1.47436653f-03, 1.45187691f-03, 1.42938729f-03, 1.40689767f-03, 1.37215461f-03, 1.11471955f-03, 1.05273917f-03, 8.70483535f-04, 7.72500854f-04, 6.31026696f-04, 4.86736409f-04,
                3.65524966f-04, 2.56184950f-04, 1.63893137f-04, 8.97030990f-05, 3.67897864f-05, 8.19351068f-06, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_negative_H, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end
    
    elseif parent_type == "HO2"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_active = flux_quiet = (6.75306153f-10, 6.75306153f-10, 6.75306153f-10, 6.75306153f-10,
                6.75306153f-10, 6.75306153f-10, 2.48184662f-08, 6.47726476f-08, 7.78195684f-08, 8.35593865f-08, 9.43436919f-08, 1.16668955f-07, 1.02346101f-07, 5.32394072f-08, 4.42857252f-08, 9.54402336f-08, 5.34318243f-07, 7.93527136f-06, 4.31977994f-06, 4.28922853f-06,
                6.80343096f-06, 7.49568314f-06, 3.82924228f-05, 1.55987816f-05, 4.08014561f-06, 1.63716775f-05, 9.67891413f-07, 1.44605453f-06, 1.56423549f-06, 1.04877162f-06, 2.00461437f-06, 6.15243186f-06, 4.65404230f-06, 2.82123472f-06, 1.51902390f-06, 4.80564989f-06,
                9.02539996f-06, 1.44993255f-05, 6.22901301f-06, 2.60687846f-06, 1.55408115f-06, 1.20831587f-06, 3.63729441f-06, 8.60479446f-06, 1.21304736f-05, 1.21304736f-05, 1.51806772f-05, 6.49543275f-06, 2.46469680f-06, 4.69800425f-06, 6.92563514f-06, 4.54713174f-06,
                2.16862834f-06, 1.40009827f-05, 3.87511618f-05, 2.75432858f-06, 1.46165724f-05, 2.17750498f-05, 1.31045154f-05, 6.16808785f-06, 8.93581548f-07, 8.90874826f-07, 8.87942544f-07, 8.85686942f-07, 4.23850923f-06, 3.39458695f-06, 1.99107050f-06, 1.57178906f-06,
                3.91962630f-06, 2.59965687f-06, 1.27968745f-06, 1.32725172f-06, 2.00465280f-06, 2.79495406f-06, 2.52657836f-06, 2.12841451f-06, 1.73025066f-06, 3.26225597f-06, 6.62090513f-06, 1.60438678f-03, 1.86194250f-03, 1.13243552f-03, 2.98713248f-04, 1.36438555f-05,
                1.84271073f-05, 2.32103591f-05, 2.21283130f-05, 1.68991156f-05, 1.16699182f-05, 1.72110211f-05, 4.59495020f-05, 4.24169753f-05, 1.97158792f-05, 2.91748053f-05, 6.18290091f-05, 6.21544543f-05, 4.30299806f-05, 2.39055068f-05, 1.23911111f-05, 1.31457574f-05,
                1.39842532f-05, 1.55773954f-05, 1.72543872f-05, 2.31412822f-05, 2.49376883f-05, 2.67962118f-05, 2.87392136f-05, 3.32195724f-05, 4.33838053f-05, 5.39715479f-05, 5.65022048f-05, 1.12392156f-04, 1.50073455f-04, 1.60112206f-04, 1.67230391f-04, 1.70912210f-04,
                1.72744620f-04, 1.68072113f-04, 1.63399605f-04, 1.58727098f-04, 1.64237846f-04, 1.79989056f-04, 2.45973470f-04, 4.74335511f-04, 8.20806374f-04, 1.18663856f-03, 1.50248325f-03, 1.82822726f-03, 1.69187621f-03, 1.74208678f-03, 2.00868007f-03, 2.33250131f-03,
                2.93147997f-03, 3.65496290f-03, 4.47193590f-03, 9.01154241f-03, 1.14016837f-02, 1.07329542f-02, 1.19332485f-02, 1.30886915f-02, 1.44660158f-02, 1.37489894f-02, 1.29396678f-02, 1.37549276f-02, 1.11254185f-02, 1.06939421f-02, 6.41784111f-03, 5.85137532f-03,
                4.79562094f-03, 3.69526381f-03, 3.11009421f-03, 2.98854082f-03, 6.65207829f-03, 4.46648422f-03, 9.43830925f-03, 9.77169824f-03, 9.79200194f-03, 9.27069079f-03, 9.17302287f-03, 1.01584438f-02, 1.44976824f-02, 2.12032138f-02, 2.26166427f-02, 2.22438692f-02,
                2.22397112f-02, 2.54959525f-02, 2.53043050f-02, 2.55540541f-02, 2.84960389f-02, 3.21493467f-02, 3.57361822f-02, 3.46677851f-02, 3.35993880f-02, 3.24483575f-02, 3.10111674f-02, 2.95854286f-02, 2.82728131f-02, 2.89701194f-02, 2.95122550f-02, 2.77789301f-02,
                2.33427281f-02, 2.05828871f-02, 1.90827872f-02, 2.04227038f-02, 2.21884517f-02, 2.18493615f-02, 2.01623064f-02, 1.64896034f-02, 1.00869518f-02, 8.72747986f-03, 3.14749557f-03, 1.27999585f-03, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17,
                6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17, 6.60717588f-17)

        else
            solar_flux_ho2 = (1.02207988f-13, 1.02207988f-13, 1.02207988f-13, 1.02207988f-13,
                1.02207988f-13, 1.02207988f-13, 3.75628962f-12, 9.80337875f-12, 1.17780380f-11, 1.26467629f-11, 1.42789739f-11, 1.76579157f-11, 1.54901432f-11, 8.05781595f-12, 6.70267085f-12, 1.44449361f-11, 8.08693839f-11, 1.20100804f-09, 6.53801263f-10, 6.49177289f-10,
                1.02970332f-09, 1.13447610f-09, 5.79558097f-09, 2.36088488f-09, 6.17532465f-10, 2.47786313f-09, 1.46490941f-10, 2.18861213f-10, 2.36747972f-10, 1.58732208f-10, 3.03399577f-10, 9.31174221f-10, 7.04392071f-10, 4.26995553f-10, 2.29905170f-10, 7.27337969f-10,
                1.36599965f-09, 2.19448154f-09, 9.42764824f-10, 3.94552606f-10, 2.35211106f-10, 1.82879325f-10, 5.50506672f-10, 1.30234076f-09, 1.83595440f-09, 1.83595440f-09, 2.29760453f-09, 9.83087611f-10, 3.73033327f-10, 7.11045738f-10, 1.04819900f-09, 6.88211094f-10,
                3.28223189f-10, 2.11905706f-09, 5.86501139f-09, 4.16869270f-10, 2.21222692f-09, 3.29566675f-09, 1.98337620f-09, 9.33543765f-10, 1.35244099f-10, 1.34834435f-10, 1.34390632f-10, 1.34049246f-10, 6.41500894f-10, 5.13772754f-10, 3.01349705f-10, 2.37891209f-10,
                5.93237772f-10, 3.93459614f-10, 1.93681456f-10, 2.00880337f-10, 3.03405394f-10, 4.23017960f-10, 3.82399138f-10, 3.22136802f-10, 2.61874466f-10, 4.93744382f-10, 1.00207793f-09, 2.42824894f-07, 2.81806105f-07, 1.71394789f-07, 4.52104278f-08, 2.06500564f-09,
                2.78895365f-09, 3.51290166f-09, 3.34913333f-09, 2.55769120f-09, 1.76624907f-09, 2.60489828f-09, 6.95448447f-09, 6.41983445f-09, 2.98401004f-09, 4.41562413f-09, 9.35785731f-09, 9.40711364f-09, 6.51261315f-09, 3.61811267f-09, 1.87540203f-09, 1.98961820f-09,
                2.11652505f-09, 2.35764806f-09, 2.61146176f-09, 3.50244683f-09, 3.77433396f-09, 4.05562259f-09, 4.34969707f-09, 5.02780204f-09, 6.56616473f-09, 8.16862588f-09, 8.55164231f-09, 1.70106196f-08, 2.27137067f-08, 2.42330776f-08, 2.53104191f-08, 2.58676647f-08,
                2.61450010f-08, 2.54378142f-08, 2.47306274f-08, 2.40234407f-08, 2.48574957f-08, 2.72414506f-08, 3.72282311f-08, 7.17909617f-08, 1.24229533f-07, 1.79598452f-07, 2.27401734f-07, 2.76703284f-07, 2.56066470f-07, 2.63665871f-07, 3.04014924f-07, 3.53025461f-07,
                4.43681237f-07, 5.53180809f-07, 6.76830158f-07, 1.36390230f-06, 1.72565162f-06, 1.62443901f-06, 1.80610426f-06, 1.98098124f-06, 2.18944009f-06, 2.08091772f-06, 1.95842642f-06, 2.08181647f-06, 1.68383870f-06, 1.61853450f-06, 9.71344069f-07, 8.85609135f-07,
                7.25820082f-07, 5.59280376f-07, 4.70714608f-07, 4.52317431f-07, 1.00679601f-06, 6.76005043f-07, 1.42849372f-06, 1.47895234f-06, 1.48202532f-06, 1.40312457f-06, 1.38834247f-06, 1.53748651f-06, 2.19423286f-06, 3.20911902f-06, 3.42304233f-06, 3.36662283f-06,
                3.36599351f-06, 3.85882758f-06, 3.82982162f-06, 3.86762128f-06, 4.31289245f-06, 4.86582274f-06, 5.40869244f-06, 5.24698990f-06, 5.08528736f-06, 4.91107821f-06, 4.69355863f-06, 4.47777222f-06, 4.27910709f-06, 4.38464480f-06, 4.46669734f-06, 4.20435759f-06,
                3.53293579f-06, 3.11523220f-06, 2.88819120f-06, 3.09098838f-06, 3.35823537f-06, 3.30691386f-06, 3.05157707f-06, 2.49571128f-06, 1.52666616f-06, 1.32090927f-06, 4.76375327f-07, 1.93728134f-07, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_ho2, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end

    elseif parent_type == "H2O2"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_active = flux_quiet = (1.90099439f-09, 2.10652520f-09, 2.59339160f-09, 3.08025800f-09,
                3.56712440f-09, 4.05399079f-09, 4.73934775f-07, 1.61211362f-06, 2.25785617f-06, 2.90359872f-06, 3.54934127f-06, 2.89984569f-06, 2.19838085f-06, 1.49691602f-06, 6.32482673f-06, 1.64089337f-05, 4.57266099f-05, 2.01252681f-04, 1.31568724f-04, 1.95852888f-04,
                1.59588052f-04, 5.86411355f-04, 9.76446594f-04, 2.74833756f-04, 1.22647588f-04, 2.41431952f-04, 3.38287582f-05, 4.21338908f-05, 3.47192564f-05, 7.03649514f-05, 1.25054581f-04, 1.78600765f-04, 9.23134948f-05, 1.06007800f-04, 5.22110551f-05, 2.96836383f-04,
                2.30837416f-04, 6.59013599f-04, 2.89131936f-04, 6.98855277f-05, 4.06130125f-05, 1.39504959f-04, 2.18300999f-04, 1.67034588f-04, 3.85839890f-04, 4.47058806f-04, 6.59526548f-04, 1.06516881f-04, 1.80621111f-04, 1.66744741f-04, 1.16111165f-04, 6.54775888f-05,
                4.09771223f-04, 1.11198594f-03, 1.08853259f-04, 5.57109432f-05, 3.25428031f-04, 5.68986079f-04, 4.22747568f-04, 3.05756760f-04, 1.59518249f-04, 3.78421025f-05, 9.84109389f-05, 1.33370293f-04, 9.10060923f-05, 4.86418913f-05, 5.95416965f-05, 1.10599635f-04,
                8.44525702f-05, 5.83055052f-05, 3.21584401f-05, 5.71332688f-05, 8.12233837f-05, 6.96484822f-05, 5.97271380f-05, 4.81522365f-05, 7.81070315f-05, 1.42031680f-04, 1.97965747f-04, 5.99288352f-02, 4.04951486f-02, 2.34906727f-02, 4.05698609f-03, 4.67569951f-04,
                6.34280494f-04, 6.98361298f-04, 5.09576391f-04, 3.20791483f-04, 5.50782996f-04, 1.13846256f-03, 1.54079007f-03, 1.10637198f-03, 6.17651626f-04, 1.48981625f-03, 1.88532654f-03, 1.52560049f-03, 1.16587444f-03, 8.06148394f-04, 4.06452785f-04, 4.09161150f-04,
                4.32406940f-04, 4.76573941f-04, 5.23065522f-04, 6.23623408f-04, 7.22075159f-04, 7.68118875f-04, 8.16255487f-04, 9.40571258f-04, 1.18565522f-03, 1.63388094f-03, 1.67128044f-03, 3.29235227f-03, 4.64552964f-03, 4.73390525f-03, 4.82543712f-03, 4.87278119f-03,
                4.87289886f-03, 4.76430039f-03, 4.65570192f-03, 4.54710344f-03, 4.90332089f-03, 5.31094697f-03, 5.17367375f-03, 5.01179762f-03, 4.84039936f-03, 5.42067527f-03, 6.74252019f-03, 6.45752527f-03, 5.38637746f-03, 5.91466660f-03, 6.56963942f-03, 7.22461223f-03,
                7.91233369f-03, 1.07231464f-02, 1.84366616f-02, 2.36374719f-02, 2.09506438f-02, 2.28531004f-02, 2.53806449f-02, 2.44195008f-02, 3.19135090f-02, 2.92518173f-02, 2.83229624f-02, 3.06706152f-02, 2.61475174f-02, 2.09942825f-02, 1.97982207f-02, 1.85594424f-02,
                1.73206641f-02, 1.60391693f-02, 1.46007239f-02, 1.62629780f-02, 2.17641669f-02, 1.18608602f-02, 2.46480104f-02, 2.39702459f-02, 1.71318530f-02, 1.59298818f-02, 1.47357898f-02, 1.35102743f-02, 1.45838404f-02, 1.74037467f-02, 1.40225849f-02, 1.06612167f-02,
                1.03858736f-02, 9.58598979f-03, 6.20228160f-03, 5.35193702f-03, 5.07006793f-03, 4.69879231f-03, 3.24809505f-03, 2.58615000f-03, 1.98538512f-03, 1.29755515f-03, 1.26144523f-03, 1.22533531f-03, 1.22430185f-03, 1.25479961f-03, 1.28529737f-03, 1.22659756f-03,
                1.13046765f-03, 1.06502530f-03, 1.10376721f-03, 1.36154827f-03, 1.65674485f-03, 1.66878646f-03, 1.68082808f-03, 1.69286969f-03, 1.63023958f-03, 1.46046651f-03, 1.46447222f-03, 1.51754446f-03, 1.67672465f-03, 1.63880909f-03, 1.59082056f-03, 1.54283203f-03,
                1.48952653f-03, 1.42540369f-03, 1.36128086f-03, 1.29226479f-03, 1.20391778f-03, 1.14480292f-03, 1.09427322f-03, 1.03810401f-03, 9.70035759f-04, 9.01967512f-04, 8.21247077f-04, 7.34405619f-04, 6.72729252f-04, 6.33898818f-04, 5.88030573f-04, 5.39092469f-04,
                4.78367462f-04, 4.05510073f-04, 3.29858288f-04, 2.63019793f-04, 1.95933090f-04, 9.29046076f-05, 2.20952286f-05, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15,
                1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15, 1.90780969f-15)

        else
            solar_flux_h2o2 = (9.96427684f-15, 1.10415898f-14, 1.35935550f-14, 1.61455202f-14,
                1.86974854f-14, 2.12494507f-14, 2.48418266f-12, 8.45007565f-12, 1.18348082f-11, 1.52195407f-11, 1.86042732f-11, 1.51998687f-11, 1.15230616f-11, 7.84625438f-12, 3.31522937f-11, 8.60092794f-11, 2.39681191f-10, 1.05488866f-09, 6.89632330f-10, 1.02658504f-09,
                8.36498799f-10, 3.07374135f-09, 5.11815512f-09, 1.44057217f-09, 6.42871185f-10, 1.26549285f-09, 1.77317257f-10, 2.20849548f-10, 1.81984904f-10, 3.68825841f-10, 6.55487709f-10, 9.36156084f-10, 4.83871610f-10, 5.55651856f-10, 2.73670143f-10, 1.55590143f-09,
                1.20996039f-09, 3.45429422f-09, 1.51551770f-09, 3.66312887f-10, 2.12877692f-10, 7.31231001f-10, 1.14424935f-09, 8.75530661f-10, 2.02242337f-09, 2.34330923f-09, 3.45698290f-09, 5.58320263f-10, 9.46745955f-10, 8.74011395f-10, 6.08609786f-10, 3.43208178f-10,
                2.14786215f-09, 5.82859992f-09, 5.70566651f-10, 2.92015202f-10, 1.70576778f-09, 2.98240480f-09, 2.21587913f-09, 1.60265859f-09, 8.36132920f-10, 1.98353654f-10, 5.15832052f-10, 6.99075457f-10, 4.77018712f-10, 2.54961967f-10, 3.12094527f-10, 5.79720481f-10,
                4.42667686f-10, 3.05614891f-10, 1.68562096f-10, 2.99470482f-10, 4.25741540f-10, 3.65070386f-10, 3.13066540f-10, 2.52395387f-10, 4.09406828f-10, 7.44475093f-10, 1.03765983f-09, 3.14123759f-07, 2.12259895f-07, 1.23129015f-07, 2.12651509f-08, 2.45082071f-09,
                3.32465285f-09, 3.66053962f-09, 2.67100221f-09, 1.68146479f-09, 2.88699128f-09, 5.96738008f-09, 8.07622516f-09, 5.79917368f-09, 3.23749077f-09, 7.80904013f-09, 9.88215199f-09, 7.99660728f-09, 6.11106257f-09, 4.22551786f-09, 2.13046818f-09, 2.14466438f-09,
                2.26650982f-09, 2.49801614f-09, 2.74170702f-09, 3.26879253f-09, 3.78483850f-09, 4.02618184f-09, 4.27849533f-09, 4.93011049f-09, 6.21474577f-09, 8.56417149f-09, 8.76020519f-09, 1.72572363f-08, 2.43500684f-08, 2.48132991f-08, 2.52930737f-08, 2.55412330f-08,
                2.55418498f-08, 2.49726186f-08, 2.44033875f-08, 2.38341563f-08, 2.57013103f-08, 2.78379285f-08, 2.71183953f-08, 2.62699033f-08, 2.53715000f-08, 2.84130817f-08, 3.53416812f-08, 3.38478481f-08, 2.82333059f-08, 3.10023931f-08, 3.44355071f-08, 3.78686211f-08,
                4.14733907f-08, 5.62065831f-08, 9.66378445f-08, 1.23898479f-07, 1.09815166f-07, 1.19787107f-07, 1.33035517f-07, 1.27997572f-07, 1.67278262f-07, 1.53326704f-07, 1.48458006f-07, 1.60763494f-07, 1.37055166f-07, 1.10043903f-07, 1.03774610f-07, 9.72814136f-08,
                9.07882172f-08, 8.40711174f-08, 7.65313438f-08, 8.52442359f-08, 1.14079339f-07, 6.21700383f-08, 1.29195330f-07, 1.25642752f-07, 8.97985426f-08, 8.34982747f-08, 7.72393065f-08, 7.08156287f-08, 7.64428469f-08, 9.12237040f-08, 7.35009625f-08, 5.58819716f-08,
                5.44387295f-08, 5.02460483f-08, 3.25099596f-08, 2.80527824f-08, 2.65753338f-08, 2.46292506f-08, 1.70252571f-08, 1.35555973f-08, 1.04066204f-08, 6.80128189f-09, 6.61200765f-09, 6.42273342f-09, 6.41731642f-09, 6.57717389f-09, 6.73703135f-09, 6.42934966f-09,
                5.92547385f-09, 5.58245039f-09, 5.78552053f-09, 7.13670903f-09, 8.68401528f-09, 8.74713275f-09, 8.81025021f-09, 8.87336768f-09, 8.54508492f-09, 7.65520020f-09, 7.67619658f-09, 7.95438072f-09, 8.78874164f-09, 8.59000295f-09, 8.33846566f-09, 8.08692836f-09,
                7.80752156f-09, 7.47141446f-09, 7.13530737f-09, 6.77355186f-09, 6.31047102f-09, 6.00061382f-09, 5.73575669f-09, 5.44133940f-09, 5.08455200f-09, 4.72776459f-09, 4.30465932f-09, 3.84947000f-09, 3.52618636f-09, 3.32265225f-09, 3.08222867f-09, 2.82571407f-09,
                2.50741708f-09, 2.12552685f-09, 1.72898947f-09, 1.37864795f-09, 1.02700542f-09, 4.86969994f-10, 1.15814637f-10, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20,
                1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20, 1.00000000f-20)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_h2o2, wvl_range[1], wvl_range[2])
            flux_active = flux_quiet
        end

    elseif parent_type == "He"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_quiet  = (0.00000000f+00, 1.61451735f-15, 1.03149719f-12, 3.71697771f-11,
                5.42477828f-10, 2.28185118f-08, 1.41646989f-05, 4.69017289f-05, 1.12526477f-04, 1.68627367f-04, 3.16445400f-04, 3.58745754f-04, 2.66215971f-04, 1.50239809f-04, 8.86908196f-05, 2.64240161f-03, 1.15857765f-02, 6.45692129f-02, 3.36537171f-02, 8.15761798f-02,
                1.89705788f-02, 6.96179880f-02, 3.02768644f-01, 6.80465244f-02, 2.97071192f-02, 9.61158055f-02, 1.36851872f-02, 2.46569089f-02, 1.80669873f-02, 2.44538385f-02, 5.37828019f-02, 8.45777469f-02, 4.34125775f-23, 6.49394755f-23, 9.27450520f-24, 1.82978633f-22,
                9.90237306f-23, 2.15268980f-22, 2.06299439f-23, 6.08134867f-23, 2.85231398f-23, 9.31038337f-23, 2.29620245f-22, 1.44768389f-22, 1.88360357f-22, 6.69127745f-22, 5.99165326f-22, 1.68447976f-23, 4.19774510f-23, 1.04764237f-22, 1.06558145f-22, 1.86566449f-23,
                1.86566449f-23, 9.50771326f-22, 1.35619457f-22, 2.24238520f-23, 1.86566449f-23, 6.45806939f-22, 4.41301408f-22, 3.28285194f-22, 2.81643582f-23, 3.04964388f-23, 2.35001969f-23, 1.29340779f-22, 2.35001969f-23, 2.35001969f-23, 2.35001969f-23, 1.11401697f-22,
                2.35001969f-23, 2.35001969f-23, 1.64142597f-23, 1.40642400f-23, 1.84772541f-23, 4.77179571f-23, 2.00917714f-23, 2.22444612f-23, 3.26491286f-23, 3.40842551f-23, 1.32749204f-22, 5.41760265f-20, 6.58364296f-22, 2.43971510f-22, 2.88819214f-22, 2.36795878f-22,
                2.52941051f-22, 5.57905439f-22, 1.90154265f-22, 2.45765418f-22, 1.82978633f-22, 2.04505531f-22, 1.30775905f-21, 3.94659796f-22, 2.85231398f-22, 3.96453704f-22, 2.22444612f-22, 3.56987724f-22, 5.54317622f-22, 4.61034398f-22, 4.91530837f-22, 5.56111531f-22,
                1.36337020f-21, 1.81184724f-21, 2.33208061f-21, 3.26491286f-21, 2.38589786f-21, 2.97788755f-21, 5.20233367f-21, 6.45806939f-21, 8.52106377f-21, 1.14810122f-20, 9.84855581f-21, 2.13475071f-20, 3.15727837f-20, 4.16186694f-20, 2.58322775f-20, 3.28285194f-20,
                2.40383694f-20, 4.70003939f-20, 5.16645551f-20, 5.63287163f-20, 6.83479010f-20, 7.94701316f-20, 8.87984541f-20, 1.06558145f-19, 1.18218548f-19, 1.30237733f-19, 1.76699954f-19, 2.27826337f-19, 1.81184724f-19, 2.15268980f-19, 2.58322775f-19, 3.22903469f-19,
                3.73132898f-19, 4.39507500f-19, 9.13099255f-19, 1.27726261f-18, 1.65577723f-18, 1.51047067f-18, 2.15268980f-18, 2.18856796f-18, 3.17521745f-18, 2.87025306f-18, 3.51606000f-18, 4.30537959f-18, 4.03629337f-18, 3.96453704f-18, 4.16186694f-18, 4.48477041f-18,
                4.89736928f-18, 5.16645551f-18, 5.41760265f-18, 7.12181541f-18, 1.27905652f-17, 7.83937867f-18, 2.00917714f-17, 2.24238520f-17, 2.08093347f-17, 2.13475071f-17, 2.47559326f-17, 3.04964388f-17, 4.41301408f-17, 6.99624184f-17, 7.15769357f-17, 6.92448551f-17,
                9.11305347f-17, 1.06199363f-16, 1.08531444f-16, 1.24497227f-16, 1.45665343f-16, 1.74188483f-16, 1.60913562f-16, 1.69344931f-16, 1.81184724f-16, 1.84772541f-16, 1.84772541f-16, 1.86566449f-16, 2.11681163f-16, 2.20650704f-16, 2.22444612f-16, 2.09887255f-16,
                1.99123806f-16, 1.95535990f-16, 2.13475071f-16, 2.76261857f-16, 3.40842551f-16, 3.56987724f-16, 3.56987724f-16, 3.62369449f-16, 3.60575541f-16, 3.48018184f-16, 3.55193816f-16, 4.03629337f-16, 4.28744051f-16, 4.44889224f-16, 4.46683133f-16, 4.44889224f-16,
                4.48477041f-16, 4.57446582f-16, 4.68210031f-16, 4.64622214f-16, 4.41301408f-16, 4.37713592f-16, 4.53858765f-16, 4.44889224f-16, 4.46683133f-16, 4.48477041f-16, 4.35919684f-16, 4.35919684f-16, 4.52064857f-16, 4.62828306f-16, 4.73591755f-16, 4.78973480f-16,
                4.84355204f-16, 4.80767388f-16, 4.77179571f-16, 4.77179571f-16, 4.78973480f-16, 4.78973480f-16, 4.82561296f-16, 4.86149112f-16, 4.86149112f-16, 4.86149112f-16, 4.87943020f-16, 4.87943020f-16, 4.86149112f-16, 4.84355204f-16, 4.84355204f-16, 4.84355204f-16,
                4.82561296f-16, 4.80767388f-16, 4.78973480f-16, 4.77179571f-16, 4.75385663f-16, 7.08593724f-16, 9.36420061f-16, 9.29244428f-16, 9.22068796f-16, 9.13099255f-16, 9.04129714f-16, 8.95160173f-16, 8.86190632f-16, 8.79015000f-16, 8.66457643f-16, 8.61075918f-16,
                8.37755112f-16, 8.23403847f-16, 8.39549020f-16, 8.14434306f-16, 8.25197755f-16, 8.12640398f-16, 7.91113500f-16, 7.78556143f-16, 7.73174418f-16, 7.22944990f-16, 7.76762235f-16, 7.62410969f-16, 7.65998786f-16, 7.58823153f-16, 7.40884071f-16, 7.19357173f-16,
                6.97830275f-16, 6.96036367f-16, 6.78097286f-16, 6.74509469f-16, 6.67333837f-16, 6.67333837f-16, 6.79891194f-16, 6.79891194f-16, 1.34363721f-15, 3.78514622f-15, 3.01376571f-15, 2.87025306f-15, 2.69086224f-15, 2.65498408f-15, 2.56528867f-15, 2.36795878f-15,
                2.24238520f-15, 2.08093347f-15, 2.00917714f-15, 1.91948173f-15, 1.78493862f-15, 1.74367873f-15, 1.65039551f-15, 1.47818033f-15, 1.38130929f-15, 1.24497227f-15, 1.16783421f-15, 1.11042915f-15, 1.33825549f-15, 1.99123806f-15, 1.48535596f-15, 1.31493468f-15,
                1.22523928f-15, 1.08890225f-15, 9.86649490f-16, 8.89778449f-16, 8.09052581f-16, 7.33708439f-16, 6.70921653f-16, 6.09928775f-16, 5.70462796f-16, 5.14851643f-16, 4.84355204f-16, 4.43095316f-16, 4.14392786f-16, 3.83896347f-16, 3.60575541f-16, 3.35460826f-16,
                3.06758296f-16, 2.87025306f-16, 2.65498408f-16, 2.52941051f-16, 2.38589786f-16, 2.24238520f-16, 2.08093347f-16, 1.90154265f-16, 1.73470919f-16, 1.65936505f-16, 5.09469918f-16, 1.20909410f-15, 6.00959235f-16, 3.98247612f-16, 2.85231398f-16, 8.12640398f-16)

            flux_active = (0.00000000f+00, 3.41184681f-15, 2.17979102f-12, 7.85482955f-11,
                1.14638053f-09, 4.82207683f-08, 2.99332694f-05, 9.91141499f-05, 9.28699583f-05, 1.31037264f-04, 2.44944895f-04, 2.74921714f-04, 2.05382622f-04, 1.16681658f-04, 7.21634811f-05, 2.38691449f-03, 1.73344100f-02, 1.13734372f-01, 3.82458053f-02, 1.36988640f-01,
                1.71512326f-02, 5.15033622f-02, 2.81693103f-01, 5.82019420f-02, 2.15547204f-02, 9.12661202f-02, 9.78527010f-03, 1.87672125f-02, 1.43848175f-02, 1.94699868f-02, 4.25268728f-02, 6.37381202f-02, 3.21991776f-23, 4.40624223f-23, 5.99395133f-24, 1.14251163f-22,
                6.09452495f-23, 1.36484664f-22, 1.32743022f-23, 3.98337983f-23, 2.05034289f-23, 6.09389752f-23, 1.87468872f-22, 1.19267218f-22, 1.51432050f-22, 5.34974962f-22, 4.79039242f-22, 1.34676002f-23, 3.35614319f-23, 6.84009901f-23, 6.94803491f-23, 1.21488210f-23,
                1.21327324f-23, 7.37457539f-22, 1.05812440f-22, 1.75168484f-23, 1.45882652f-23, 5.05389392f-22, 2.62727975f-22, 1.87321281f-22, 1.60707328f-23, 1.74014305f-23, 1.34093376f-23, 7.89515517f-23, 1.43448728f-23, 1.43448728f-23, 1.43448728f-23, 6.80012671f-23,
                1.48091040f-23, 1.48440807f-23, 1.02689386f-23, 8.73920942f-24, 1.14143214f-23, 2.92757805f-23, 1.23578492f-23, 1.59324260f-23, 2.50750237f-23, 2.57425441f-23, 9.87790965f-23, 3.97080040f-20, 4.74148130f-22, 1.73834181f-22, 2.05145264f-22, 1.67731828f-22,
                1.78604326f-22, 3.92699400f-22, 1.33422276f-22, 1.66106496f-22, 1.13418913f-22, 1.26508573f-22, 8.07163594f-22, 2.44502023f-22, 1.77621548f-22, 2.64252326f-22, 1.50456261f-22, 2.36346776f-22, 3.59054148f-22, 3.00278665f-22, 3.22964142f-22, 3.54848490f-22,
                8.14226237f-22, 9.94966883f-22, 1.28807433f-21, 1.81421717f-21, 1.33374905f-21, 1.52776337f-21, 2.60929280f-21, 3.18573388f-21, 4.15613090f-21, 5.43892988f-21, 4.54529976f-21, 9.43497190f-21, 1.34919933f-20, 1.66543889f-20, 1.02113848f-20, 1.28942618f-20,
                9.38113895f-21, 1.82159227f-20, 1.98847715f-20, 2.16546591f-20, 2.62478052f-20, 3.04852095f-20, 3.40257385f-20, 4.07854419f-20, 4.51951123f-20, 4.97312527f-20, 6.71540385f-20, 8.52747791f-20, 6.72238660f-20, 7.91652851f-20, 9.41082519f-20, 1.16522702f-19,
                1.34187616f-19, 1.56643337f-19, 3.18064108f-19, 4.44914823f-19, 5.71059344f-19, 5.16127380f-19, 7.35573463f-19, 7.47833020f-19, 1.08497086f-18, 9.80764617f-19, 1.20143666f-18, 1.47114693f-18, 1.37920024f-18, 1.35468113f-18, 1.42210869f-18, 1.53244471f-18,
                1.67342963f-18, 1.75945728f-18, 1.81524772f-18, 2.38626117f-18, 4.28563826f-18, 2.62667224f-18, 6.73194939f-18, 7.51330822f-18, 6.97232317f-18, 7.15261354f-18, 8.29459373f-18, 1.02179351f-17, 1.47858899f-17, 2.34409395f-17, 2.39817765f-17, 2.32003061f-17,
                3.05328982f-17, 3.55814661f-17, 3.63626291f-17, 4.17116190f-17, 4.88035351f-17, 5.83595800f-17, 5.39117024f-17, 5.67362037f-17, 6.07026049f-17, 6.19043053f-17, 6.19039740f-17, 6.25046489f-17, 7.09183566f-17, 7.39229761f-17, 7.45235770f-17, 7.03162245f-17,
                6.67099072f-17, 6.55075762f-17, 7.15170628f-17, 9.25509976f-17, 1.14185685f-16, 1.19593840f-16, 1.19593200f-16, 1.21395463f-16, 1.20793848f-16, 1.16586473f-16, 1.18989681f-16, 1.35214823f-16, 1.43627421f-16, 1.49035187f-16, 1.49635334f-16, 1.49033592f-16,
                1.50234671f-16, 1.53238544f-16, 1.56843317f-16, 1.55640620f-16, 1.47827751f-16, 1.46625114f-16, 1.52032604f-16, 1.49027209f-16, 1.49627324f-16, 1.50227433f-16, 1.46020283f-16, 1.46019502f-16, 1.51426821f-16, 1.55031391f-16, 1.58635923f-16, 1.60437745f-16,
                1.62239548f-16, 1.61036911f-16, 1.59834288f-16, 1.59833432f-16, 1.60433451f-16, 1.60432592f-16, 1.61633469f-16, 1.62834333f-16, 1.62833461f-16, 1.62832589f-16, 1.63432572f-16, 1.63431697f-16, 1.62829974f-16, 1.62228257f-16, 1.62227388f-16, 1.62226520f-16,
                1.61624815f-16, 1.61023117f-16, 1.60421426f-16, 1.59819741f-16, 1.59218062f-16, 2.37323766f-16, 3.13625344f-16, 3.11218752f-16, 3.08812211f-16, 3.05804926f-16, 3.02797706f-16, 2.99790550f-16, 2.96783459f-16, 2.94377201f-16, 2.90168705f-16, 2.88363327f-16,
                2.80550482f-16, 2.75741525f-16, 2.81145210f-16, 2.72731963f-16, 2.76333390f-16, 2.72125403f-16, 2.64913945f-16, 2.60706170f-16, 2.58901280f-16, 2.42079115f-16, 2.60097107f-16, 2.55288883f-16, 2.56487495f-16, 2.54082081f-16, 2.48072755f-16, 2.40862250f-16,
                2.33651899f-16, 2.33048756f-16, 2.27039912f-16, 2.25836224f-16, 2.23431318f-16, 2.23428924f-16, 2.27630793f-16, 2.27628355f-16, 4.49846469f-16, 1.26723059f-15, 1.00891495f-15, 9.60819915f-16, 9.00720417f-16, 8.88663202f-16, 8.58594795f-16, 7.92506579f-16,
                7.50439503f-16, 6.96370543f-16, 6.72321737f-16, 6.42272953f-16, 5.97221813f-16, 5.83385417f-16, 5.52145902f-16, 4.94504171f-16, 4.62072574f-16, 4.16443086f-16, 3.90619474f-16, 3.71398604f-16, 4.47574320f-16, 6.65917155f-16, 4.96678272f-16, 4.39645079f-16,
                4.09611704f-16, 3.63993603f-16, 3.29777599f-16, 2.97367523f-16, 2.70359598f-16, 2.45155672f-16, 2.24152518f-16, 2.03753141f-16, 1.90548655f-16, 1.71954692f-16, 1.61751852f-16, 1.47957099f-16, 1.38357971f-16, 1.28162015f-16, 1.20363540f-16, 1.11967979f-16,
                1.02376829f-16, 9.57808909f-17, 8.85878021f-17, 8.43887668f-17, 7.95921948f-17, 7.47966521f-17, 6.94038300f-17, 6.34139214f-17, 5.78440257f-17, 5.53257176f-17, 1.69846634f-16, 4.02945798f-16, 2.00013188f-16, 1.32403223f-16, 9.47270386f-17, 2.69591245f-16)

        else

            solar_flux_He = (0.000000f+00, 9.000000f-23, 5.750000f-20, 2.072000f-18,
                3.024000f-17, 1.272000f-15, 7.896000f-13, 2.614500f-12, 6.272700f-12, 9.400000f-12, 1.764000f-11, 1.999800f-11, 1.484000f-11, 8.375000f-12, 4.944000f-12, 1.472986f-10, 6.458400f-10, 3.599360f-09, 1.876000f-09, 4.547400f-09,
                1.057500f-09, 3.880800f-09, 1.687760f-08, 3.793200f-09, 1.656000f-09, 5.357900f-09, 7.628700f-10, 1.374480f-09, 1.007130f-09, 1.363160f-09, 2.998080f-09, 4.714720f-09, 2.420000f-30, 3.620000f-30, 5.170000f-31, 1.020000f-29,
                5.520000f-30, 1.200000f-29, 1.150000f-30, 3.390000f-30, 1.590000f-30, 5.190000f-30, 1.280000f-29, 8.070000f-30, 1.050000f-29, 3.730000f-29, 3.340000f-29, 9.390000f-31, 2.340000f-30, 5.840000f-30, 5.940000f-30, 1.040000f-30,
                1.040000f-30, 5.300000f-29, 7.560000f-30, 1.250000f-30, 1.040000f-30, 3.600000f-29, 2.460000f-29, 1.830000f-29, 1.570000f-30, 1.700000f-30, 1.310000f-30, 7.210000f-30, 1.310000f-30, 1.310000f-30, 1.310000f-30, 6.210000f-30,
                1.310000f-30, 1.310000f-30, 9.150000f-31, 7.840000f-31, 1.030000f-30, 2.660000f-30, 1.120000f-30, 1.240000f-30, 1.820000f-30, 1.900000f-30, 7.400000f-30, 3.020000f-27, 3.670000f-29, 1.360000f-29, 1.610000f-29, 1.320000f-29,
                1.410000f-29, 3.110000f-29, 1.060000f-29, 1.370000f-29, 1.020000f-29, 1.140000f-29, 7.290000f-29, 2.200000f-29, 1.590000f-29, 2.210000f-29, 1.240000f-29, 1.990000f-29, 3.090000f-29, 2.570000f-29, 2.740000f-29, 3.100000f-29,
                7.600000f-29, 1.010000f-28, 1.300000f-28, 1.820000f-28, 1.330000f-28, 1.660000f-28, 2.900000f-28, 3.600000f-28, 4.750000f-28, 6.400000f-28, 5.490000f-28, 1.190000f-27, 1.760000f-27, 2.320000f-27, 1.440000f-27, 1.830000f-27,
                1.340000f-27, 2.620000f-27, 2.880000f-27, 3.140000f-27, 3.810000f-27, 4.430000f-27, 4.950000f-27, 5.940000f-27, 6.590000f-27, 7.260000f-27, 9.850000f-27, 1.270000f-26, 1.010000f-26, 1.200000f-26, 1.440000f-26, 1.800000f-26,
                2.080000f-26, 2.450000f-26, 5.090000f-26, 7.120000f-26, 9.230000f-26, 8.420000f-26, 1.200000f-25, 1.220000f-25, 1.770000f-25, 1.600000f-25, 1.960000f-25, 2.400000f-25, 2.250000f-25, 2.210000f-25, 2.320000f-25, 2.500000f-25,
                2.730000f-25, 2.880000f-25, 3.020000f-25, 3.970000f-25, 7.130000f-25, 4.370000f-25, 1.120000f-24, 1.250000f-24, 1.160000f-24, 1.190000f-24, 1.380000f-24, 1.700000f-24, 2.460000f-24, 3.900000f-24, 3.990000f-24, 3.860000f-24,
                5.080000f-24, 5.920000f-24, 6.050000f-24, 6.940000f-24, 8.120000f-24, 9.710000f-24, 8.970000f-24, 9.440000f-24, 1.010000f-23, 1.030000f-23, 1.030000f-23, 1.040000f-23, 1.180000f-23, 1.230000f-23, 1.240000f-23, 1.170000f-23,
                1.110000f-23, 1.090000f-23, 1.190000f-23, 1.540000f-23, 1.900000f-23, 1.990000f-23, 1.990000f-23, 2.020000f-23, 2.010000f-23, 1.940000f-23, 1.980000f-23, 2.250000f-23, 2.390000f-23, 2.480000f-23, 2.490000f-23, 2.480000f-23,
                2.500000f-23, 2.550000f-23, 2.610000f-23, 2.590000f-23, 2.460000f-23, 2.440000f-23, 2.530000f-23, 2.480000f-23, 2.490000f-23, 2.500000f-23, 2.430000f-23, 2.430000f-23, 2.520000f-23, 2.580000f-23, 2.640000f-23, 2.670000f-23,
                2.700000f-23, 2.680000f-23, 2.660000f-23, 2.660000f-23, 2.670000f-23, 2.670000f-23, 2.690000f-23, 2.710000f-23, 2.710000f-23, 2.710000f-23, 2.720000f-23, 2.720000f-23, 2.710000f-23, 2.700000f-23, 2.700000f-23, 2.700000f-23,
                2.690000f-23, 2.680000f-23, 2.670000f-23, 2.660000f-23, 2.650000f-23, 3.950000f-23, 5.220000f-23, 5.180000f-23, 5.140000f-23, 5.090000f-23, 5.040000f-23, 4.990000f-23, 4.940000f-23, 4.900000f-23, 4.830000f-23, 4.800000f-23,
                4.670000f-23, 4.590000f-23, 4.680000f-23, 4.540000f-23, 4.600000f-23, 4.530000f-23, 4.410000f-23, 4.340000f-23, 4.310000f-23, 4.030000f-23, 4.330000f-23, 4.250000f-23, 4.270000f-23, 4.230000f-23, 4.130000f-23, 4.010000f-23,
                3.890000f-23, 3.880000f-23, 3.780000f-23, 3.760000f-23, 3.720000f-23, 3.720000f-23, 3.790000f-23, 3.790000f-23, 7.490000f-23, 2.110000f-22, 1.680000f-22, 1.600000f-22, 1.500000f-22, 1.480000f-22, 1.430000f-22, 1.320000f-22,
                1.250000f-22, 1.160000f-22, 1.120000f-22, 1.070000f-22, 9.950000f-23, 9.720000f-23, 9.200000f-23, 8.240000f-23, 7.700000f-23, 6.940000f-23, 6.510000f-23, 6.190000f-23, 7.460000f-23, 1.110000f-22, 8.280000f-23, 7.330000f-23,
                6.830000f-23, 6.070000f-23, 5.500000f-23, 4.960000f-23, 4.510000f-23, 4.090000f-23, 3.740000f-23, 3.400000f-23, 3.180000f-23, 2.870000f-23, 2.700000f-23, 2.470000f-23, 2.310000f-23, 2.140000f-23, 2.010000f-23, 1.870000f-23,
                1.710000f-23, 1.600000f-23, 1.480000f-23, 1.410000f-23, 1.330000f-23, 1.250000f-23, 1.160000f-23, 1.060000f-23, 9.670000f-24, 9.250000f-24, 2.840000f-23, 6.740000f-23, 3.350000f-23, 2.220000f-23, 1.590000f-23, 4.530000f-23)

            solar_flux_He_active = (0.00000000f+00, 5.73300000f-22, 3.66275000f-19, 1.31986400f-17,
                1.92628800f-16, 8.10264000f-15, 5.02975200f-12, 1.66543650f-11, 1.56051400f-11, 2.20184750f-11, 4.11586205f-11, 4.61956903f-11, 3.45108863f-11, 1.96062713f-11, 1.21257858f-11, 4.01078405f-10, 2.91273840f-09, 1.91110325f-08, 6.42652539f-09, 2.30184974f-08,
                2.88195872f-09, 8.65422135f-09, 4.73335014f-08, 9.77979821f-09, 3.62188630f-09, 1.53356436f-08, 1.64424010f-09, 3.15349531f-09, 2.41711200f-09, 3.27158400f-09, 7.14588242f-09, 1.07100542f-08, 5.41049746f-30, 7.40390413f-30, 1.00717661f-30, 1.91978701f-29,
                1.02407621f-29, 2.29338134f-29, 2.23050971f-30, 6.69335930f-30, 3.44523552f-30, 1.02397078f-29, 3.15008000f-29, 2.00407286f-29, 2.54454549f-29, 8.98930000f-29, 8.04940000f-29, 2.26299000f-30, 5.63940000f-30, 1.14935663f-29, 1.16749334f-29, 2.04139267f-30,
                2.03868926f-30, 1.23916585f-28, 1.77798931f-29, 2.94339392f-30, 2.45129776f-30, 8.49216727f-29, 4.41467500f-29, 3.14760000f-29, 2.70040000f-30, 2.92400000f-30, 2.25320000f-30, 1.32664000f-29, 2.41040000f-30, 2.41040000f-30, 2.41040000f-30, 1.14264000f-29,
                2.48840577f-30, 2.49428298f-30, 1.72551196f-30, 1.46846826f-30, 1.91797311f-30, 4.91927273f-30, 2.07651613f-30, 2.67716000f-30, 4.21341047f-30, 4.32557537f-30, 1.65980653f-29, 6.67222180f-27, 7.96721358f-29, 2.92097334f-29, 3.44710025f-29, 2.81843418f-29,
                3.00112713f-29, 6.59861295f-29, 2.24192337f-29, 2.79112339f-29, 1.90580252f-29, 2.12575091f-29, 1.35629445f-28, 4.10842038f-29, 2.98461330f-29, 4.44028899f-29, 2.52814910f-29, 3.97138600f-29, 6.03326451f-29, 5.04564735f-29, 5.42683634f-29, 5.96259593f-29,
                1.36816196f-28, 1.67186438f-28, 2.16437915f-28, 3.04846835f-28, 2.24112737f-28, 2.56713383f-28, 4.38445113f-28, 5.35305755f-28, 6.98363665f-28, 9.13915152f-28, 7.63756550f-28, 1.58537874f-27, 2.26708881f-27, 2.79847299f-27, 1.71584107f-27, 2.16665070f-27,
                1.57633307f-27, 3.06086090f-27, 3.34128117f-27, 3.63867920f-27, 4.41047548f-27, 5.12249570f-27, 5.71741844f-27, 6.85326602f-27, 7.59423248f-27, 8.35644995f-27, 1.12840383f-26, 1.43289056f-26, 1.12957716f-26, 1.33023141f-26, 1.58132131f-26, 1.95795617f-26,
                2.25478353f-26, 2.63211187f-26, 5.34450000f-26, 7.47600000f-26, 9.59563367f-26, 8.67260000f-26, 1.23600000f-25, 1.25660000f-25, 1.82310000f-25, 1.64800000f-25, 2.01880000f-25, 2.47200000f-25, 2.31750000f-25, 2.27630000f-25, 2.38960000f-25, 2.57500000f-25,
                2.81190000f-25, 2.95645412f-25, 3.05020000f-25, 4.00968627f-25, 7.20125067f-25, 4.41365417f-25, 1.13118402f-24, 1.26247743f-24, 1.17157454f-24, 1.20186912f-24, 1.39375853f-24, 1.71694174f-24, 2.48450506f-24, 3.93883177f-24, 4.02970977f-24, 3.89839761f-24,
                5.13050893f-24, 5.97883072f-24, 6.11009122f-24, 7.00889357f-24, 8.20056357f-24, 9.80628646f-24, 9.05889997f-24, 9.53350703f-24, 1.01999900f-23, 1.04019143f-23, 1.04018586f-23, 1.05027914f-23, 1.19165649f-23, 1.24214376f-23, 1.25223578f-23, 1.18153873f-23,
                1.12094100f-23, 1.10073797f-23, 1.20171668f-23, 1.55515443f-23, 1.91868676f-23, 2.00956116f-23, 2.00955041f-23, 2.03983422f-23, 2.02972516f-23, 1.95902773f-23, 1.99940935f-23, 2.27204392f-23, 2.41340262f-23, 2.50427049f-23, 2.51435489f-23, 2.50424368f-23,
                2.52442568f-23, 2.57490041f-23, 2.63547219f-23, 2.61526300f-23, 2.48398168f-23, 2.46377351f-23, 2.55463673f-23, 2.50413643f-23, 2.51422030f-23, 2.52430405f-23, 2.45361041f-23, 2.45359727f-23, 2.54445762f-23, 2.60502600f-23, 2.66559373f-23, 2.69587014f-23,
                2.72614622f-23, 2.70593805f-23, 2.68573011f-23, 2.68571573f-23, 2.69579797f-23, 2.69578354f-23, 2.71596214f-23, 2.73614051f-23, 2.73612586f-23, 2.73611122f-23, 2.74619286f-23, 2.74617816f-23, 2.73606727f-23, 2.72595649f-23, 2.72594189f-23, 2.72592730f-23,
                2.71581673f-23, 2.70570627f-23, 2.69559592f-23, 2.68548568f-23, 2.67537554f-23, 3.98780257f-23, 5.26991449f-23, 5.22947600f-23, 5.18903838f-23, 5.13850632f-23, 5.08797535f-23, 5.03744546f-23, 4.98691665f-23, 4.94648378f-23, 4.87576751f-23, 4.84543135f-23,
                4.71415043f-23, 4.63334449f-23, 4.72414378f-23, 4.58277416f-23, 4.64328973f-23, 4.57258200f-23, 4.45140632f-23, 4.38070216f-23, 4.35037422f-23, 4.06770773f-23, 4.37046795f-23, 4.28967432f-23, 4.30981486f-23, 4.26939616f-23, 4.16842016f-23, 4.04726049f-23,
                3.92610341f-23, 3.91596865f-23, 3.81500076f-23, 3.79477492f-23, 3.75436476f-23, 3.75432454f-23, 3.82492946f-23, 3.82488849f-23, 7.55886751f-23, 2.12935497f-22, 1.69530162f-22, 1.61448649f-22, 1.51350000f-22, 1.49324000f-22, 1.44271541f-22, 1.33166595f-22,
                1.26097973f-22, 1.17012649f-22, 1.12971676f-22, 1.07922514f-22, 1.00352473f-22, 9.80275135f-23, 9.27782703f-23, 8.30926054f-23, 7.76430541f-23, 6.99758324f-23, 6.56366351f-23, 6.24069108f-23, 7.52068811f-23, 1.11895500f-22, 8.34579243f-23, 7.38745135f-23,
                6.88279405f-23, 6.11626324f-23, 5.54132432f-23, 4.99673081f-23, 4.54291081f-23, 4.11940378f-23, 3.76648324f-23, 3.42370811f-23, 3.20183027f-23, 2.88939189f-23, 2.71795135f-23, 2.48615514f-23, 2.32485892f-23, 2.15353405f-23, 2.02249459f-23, 1.88142216f-23,
                1.72026000f-23, 1.60942703f-23, 1.48856000f-23, 1.41800270f-23, 1.33740486f-23, 1.25682432f-23, 1.16620757f-23, 1.06555784f-23, 9.71965676f-24, 9.29650000f-24, 2.85396973f-23, 6.77078541f-23, 3.36086486f-23, 2.22480000f-23, 1.59171892f-23, 4.53000000f-23)
                
            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_He, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_He_active, wvl_range[1], wvl_range[2])
        end

    elseif parent_type == "Ne"
        if wvl_range == (1.0f0, 95000.0f0)
            flux_quiet = (0.00000000f+00, 3.21007477f-13, 1.75914424f-10, 5.95957359f-09,
                8.37410809f-08, 3.41942747f-06, 9.51159111f-05, 2.99258057f-04, 5.94189492f-04, 7.81699729f-04, 1.33985730f-03, 1.40475663f-03, 9.70466082f-04, 5.08843374f-04, 2.81230463f-04, 7.76611295f-03, 2.76240891f-02, 1.29746337f-01, 5.58506487f-02, 1.15148639f-01,
                2.14324829f-02, 7.46900658f-02, 2.91391048f-01, 5.91607475f-02, 2.32643190f-02, 6.81821044f-02, 9.22268438f-03, 1.43008831f-02, 8.97564819f-03, 1.03806374f-02, 2.04746943f-02, 2.87776225f-02, 1.05126459f-02, 1.48413620f-02, 1.97830162f-03, 5.93165990f-23,
                3.21007477f-23, 6.97842341f-23, 6.68765577f-24, 1.97140461f-23, 9.24641102f-24, 3.01816813f-23, 7.44365164f-23, 4.69298974f-23, 6.10612049f-23, 2.16912661f-22, 1.94232785f-22, 5.46061632f-24, 1.36079257f-23, 3.39616606f-23, 3.45431959f-23, 6.04796696f-24,
                6.04796696f-24, 3.08213701f-22, 4.39640675f-23, 7.26919105f-24, 6.04796696f-24, 2.09352702f-22, 1.43057680f-22, 1.06420957f-22, 9.13010396f-24, 9.88609983f-24, 7.61811222f-24, 4.19286940f-23, 7.61811222f-24, 7.61811222f-24, 7.61811222f-24, 3.61133412f-23,
                7.61811222f-24, 7.61811222f-24, 5.32104785f-24, 4.55923663f-24, 5.98981343f-24, 1.54688386f-23, 6.51319518f-24, 7.21103753f-24, 1.05839422f-23, 1.10491704f-23, 4.30336110f-23, 1.75623656f-20, 2.13423449f-22, 7.90887987f-23, 9.36271808f-23, 7.67626575f-23,
                8.19964751f-23, 1.80857473f-22, 6.16427401f-23, 7.96703339f-23, 5.93165990f-23, 6.62950224f-23, 4.23939222f-22, 1.27937763f-22, 9.24641102f-23, 1.28519298f-22, 7.21103753f-23, 1.15725522f-22, 1.79694403f-22, 1.49454568f-22, 1.59340668f-22, 1.80275938f-22,
                4.41966816f-22, 5.87350637f-22, 7.55995870f-22, 1.05839422f-21, 7.73441928f-22, 9.65348572f-22, 1.68645232f-21, 2.09352702f-21, 2.76229260f-21, 3.72182582f-21, 3.19262871f-21, 6.92026988f-21, 1.02350210f-20, 1.34916186f-20, 8.37410809f-21, 1.06420957f-20,
                7.79257281f-21, 1.52362244f-20, 1.67482162f-20, 1.82602079f-20, 2.21564943f-20, 2.57620131f-20, 2.87859966f-20, 3.45431959f-20, 3.83231752f-20, 4.22194616f-20, 5.72812255f-20, 7.38549811f-20, 5.87350637f-20, 6.97842341f-20, 8.37410809f-20, 1.04676351f-19,
                1.20959339f-19, 1.42476145f-19, 2.96001460f-19, 4.14053122f-19, 5.36757067f-19, 4.89652709f-19, 6.97842341f-19, 7.09473047f-19, 1.02931745f-18, 9.30456455f-19, 1.13980916f-18, 1.39568468f-18, 1.30845439f-18, 1.28519298f-18, 1.34916186f-18, 1.45383821f-18,
                1.58759133f-18, 1.67482162f-18, 1.75623656f-18, 2.30869508f-18, 4.14634658f-18, 2.54130919f-18, 6.51319518f-18, 7.26919105f-18, 6.74580930f-18, 6.92026988f-18, 8.02518692f-18, 9.88609983f-18, 1.43057680f-17, 2.26798761f-17, 2.32032578f-17, 2.24472620f-17,
                2.95419924f-17, 3.44268888f-17, 3.51828847f-17, 4.03585487f-17, 4.72206651f-17, 5.64670761f-17, 5.21637150f-17, 5.48969308f-17, 5.87350637f-17, 5.98981343f-17, 5.98981343f-17, 6.04796696f-17, 6.86211635f-17, 7.15288400f-17, 7.21103753f-17, 6.80396283f-17,
                6.45504166f-17, 6.33873460f-17, 6.92026988f-17, 8.95564338f-17, 1.10491704f-16, 1.15725522f-16, 1.15725522f-16, 1.17470127f-16, 1.16888592f-16, 1.12817845f-16, 1.15143986f-16, 1.30845439f-16, 1.38986933f-16, 1.44220751f-16, 1.44802286f-16, 1.44220751f-16,
                1.45383821f-16, 1.48291497f-16, 1.51780709f-16, 1.50617639f-16, 1.43057680f-16, 1.41894609f-16, 1.47128427f-16, 1.44220751f-16, 1.44802286f-16, 1.45383821f-16, 1.41313074f-16, 1.41313074f-16, 1.46546892f-16, 1.50036103f-16, 1.53525315f-16, 1.55269921f-16,
                1.57014527f-16, 1.55851456f-16, 1.54688386f-16, 1.54688386f-16, 1.55269921f-16, 1.55269921f-16, 1.56432991f-16, 1.57596062f-16, 1.57596062f-16, 1.57596062f-16, 1.58177597f-16, 1.58177597f-16, 1.57596062f-16, 1.57014527f-16, 1.57014527f-16, 1.57014527f-16,
                1.56432991f-16, 1.55851456f-16, 1.55269921f-16, 1.54688386f-16, 1.54106850f-16, 2.29706437f-16, 3.03561418f-16, 3.01235277f-16, 2.98909136f-16, 2.96001460f-16, 2.93093783f-16, 2.90186107f-16, 2.87278430f-16, 2.84952289f-16, 2.80881542f-16, 2.79136936f-16,
                2.71576978f-16, 2.66924695f-16, 2.72158513f-16, 2.64017019f-16, 2.67506231f-16, 2.63435484f-16, 2.56457060f-16, 2.52386313f-16, 2.50641708f-16, 2.34358720f-16, 2.51804778f-16, 2.47152496f-16, 2.48315566f-16, 2.45989425f-16, 2.40174072f-16, 2.33195649f-16,
                2.26217226f-16, 2.25635690f-16, 2.19820337f-16, 2.18657267f-16, 2.16331126f-16, 2.16331126f-16, 2.20401873f-16, 2.20401873f-16, 4.35569928f-16, 1.22703945f-15, 9.76979278f-16, 9.30456455f-16, 8.72302926f-16, 8.60672221f-16, 8.31595457f-16, 7.67626575f-16,
                7.26919105f-16, 6.74580930f-16, 6.51319518f-16, 6.22242754f-16, 5.78627608f-16, 5.65252296f-16, 5.35012462f-16, 4.79185074f-16, 4.47782169f-16, 4.03585487f-16, 3.78579470f-16, 3.59970341f-16, 4.33825322f-16, 6.45504166f-16, 4.81511215f-16, 4.26265363f-16,
                3.97188599f-16, 3.52991918f-16, 3.19844406f-16, 2.88441501f-16, 2.62272413f-16, 2.37847931f-16, 2.17494196f-16, 1.97721997f-16, 1.84928220f-16, 1.66900627f-16, 1.57014527f-16, 1.43639215f-16, 1.34334651f-16, 1.24448551f-16, 1.16888592f-16, 1.08747098f-16,
                9.94425336f-17, 9.30456455f-17, 8.60672221f-17, 8.19964751f-17, 7.73441928f-17, 7.26919105f-17, 6.74580930f-17, 6.16427401f-17, 5.62344620f-17, 5.37920138f-17, 1.65156021f-16, 3.91954782f-16, 1.94814320f-16, 1.29100833f-16, 9.24641102f-17, 2.63435484f-16)

            flux_active = (0.00000000f+00, 6.12780032f-13, 3.35807898f-10, 1.13763945f-08,
                1.59855661f-07, 6.52743947f-06, 1.81569388f-04, 5.71261965f-04, 4.42984104f-04, 5.48718204f-04, 9.36851593f-04, 9.72447161f-04, 6.76320572f-04, 3.56980375f-04, 2.06701590f-04, 6.33700993f-03, 3.73348604f-02, 2.06444823f-01, 5.73352407f-02, 1.74671740f-01,
                1.75037012f-02, 4.99136815f-02, 2.44897399f-01, 4.57096430f-02, 1.52480690f-02, 5.84827558f-02, 5.95692415f-03, 9.83256092f-03, 6.45545842f-03, 7.46595364f-03, 1.46244688f-02, 1.95902825f-02, 7.04342500f-03, 9.09653507f-03, 1.15493520f-03, 3.34563950f-23,
                1.78467185f-23, 3.99670753f-23, 3.88714028f-24, 1.16646103f-23, 6.00405982f-24, 1.78448811f-23, 5.48968820f-23, 3.49252563f-23, 4.43441479f-23, 1.56657781f-22, 1.40278013f-22, 3.94374413f-24, 9.82786076f-24, 2.00299978f-23, 2.03460686f-23, 3.55756338f-24,
                3.55285212f-24, 2.15951156f-22, 3.09852669f-23, 5.12949349f-24, 4.27191067f-24, 1.47994179f-22, 7.69351548f-23, 5.48536627f-23, 4.70602461f-24, 5.09569544f-24, 3.92668296f-24, 2.31195397f-23, 4.20063758f-24, 4.20063758f-24, 4.20063758f-24, 1.99129461f-23,
                4.33657933f-24, 4.34682162f-24, 3.00707368f-24, 2.55912005f-24, 3.34247840f-24, 8.57288496f-24, 3.61877352f-24, 4.66552394f-24, 7.34276899f-24, 7.53824031f-24, 2.89256790f-23, 1.16277737f-20, 1.38845738f-22, 5.09042083f-23, 6.00730952f-23, 4.91172442f-23,
                5.23010595f-23, 1.14994945f-22, 3.90703101f-23, 4.86412952f-23, 3.32126855f-23, 3.70457566f-23, 2.36363318f-22, 7.15980129f-23, 5.20132708f-23, 7.73815334f-23, 4.40584058f-23, 6.92098958f-23, 1.05142539f-22, 8.79311977f-23, 9.45742312f-23, 1.03910988f-22,
                2.38431486f-22, 2.91358128f-22, 3.77189363f-22, 5.31260816f-22, 3.90564382f-22, 4.47377981f-22, 7.64084392f-22, 9.32884780f-22, 1.21704807f-21, 1.59269264f-21, 1.33100915f-21, 2.76286156f-21, 3.95088718f-21, 4.87693777f-21, 2.99022008f-21, 3.77585229f-21,
                2.74709755f-21, 5.33420483f-21, 5.82289713f-21, 6.34117682f-21, 7.68619691f-21, 8.92704445f-21, 9.96382459f-21, 1.19432819f-20, 1.32345745f-20, 1.45629015f-20, 1.96648505f-20, 2.49711829f-20, 1.96852982f-20, 2.31821276f-20, 2.75579063f-20, 3.41215743f-20,
                3.92944260f-20, 4.58701794f-20, 9.31393443f-20, 1.30285291f-19, 1.67224442f-19, 1.51138606f-19, 2.15399438f-19, 2.18989429f-19, 3.17714171f-19, 2.87199251f-19, 3.51819082f-19, 4.30798876f-19, 4.03873946f-19, 3.96693965f-19, 4.16438913f-19, 4.48748829f-19,
                4.90033721f-19, 5.15225369f-19, 5.31562593f-19, 6.98773599f-19, 1.25497196f-18, 7.69173647f-19, 1.97133011f-18, 2.20013697f-18, 2.04171924f-18, 2.09451403f-18, 2.42892235f-18, 2.99213824f-18, 4.32978150f-18, 6.86425688f-18, 7.02263123f-18, 6.79379170f-18, 
                8.94100922f-18, 1.04193914f-17, 1.06481409f-17, 1.22144962f-17, 1.42912361f-17, 1.70895517f-17, 1.57870709f-17, 1.66141752f-17, 1.77756643f-17, 1.81275607f-17, 1.81274636f-17, 1.83033605f-17, 2.07671632f-17, 2.16470119f-17, 2.18228871f-17, 2.05908397f-17, 
                1.95347946f-17, 1.91827136f-17, 2.09424835f-17, 2.71018924f-17, 3.34372208f-17, 3.50209017f-17, 3.50207142f-17, 3.55484744f-17, 3.53723025f-17, 3.41402485f-17, 3.48439847f-17, 3.95952252f-17, 4.20587029f-17, 4.36422698f-17, 4.38180122f-17, 4.36418026f-17, 
                4.39935171f-17, 4.48731473f-17, 4.59287401f-17, 4.55765518f-17, 4.32886939f-17, 4.29365235f-17, 4.45200094f-17, 4.36399337f-17, 4.38156666f-17, 4.39913976f-17, 4.27594096f-17, 4.27591807f-17, 4.43426166f-17, 4.53981502f-17, 4.64536724f-17, 4.69813035f-17, 
                4.75089290f-17, 4.71567586f-17, 4.68045919f-17, 4.68043413f-17, 4.69800460f-17, 4.69797945f-17, 4.73314496f-17, 4.76831010f-17, 4.76828457f-17, 4.76825905f-17, 4.78582848f-17, 4.78580285f-17, 4.76818246f-17, 4.75056226f-17, 4.75053682f-17, 4.75051139f-17, 
                4.73289156f-17, 4.71527192f-17, 4.69765247f-17, 4.68003321f-17, 4.66241414f-17, 6.94959896f-17, 9.18395322f-17, 9.11348051f-17, 9.04300930f-17, 8.95494639f-17, 8.86688536f-17, 8.77882622f-17, 8.69076896f-17, 8.62030604f-17, 8.49706781f-17, 8.44420056f-17, 
                8.21541548f-17, 8.07459384f-17, 8.23283103f-17, 7.98646423f-17, 8.09192555f-17, 7.96870221f-17, 7.75752767f-17, 7.63431055f-17, 7.58145761f-17, 7.08885080f-17, 7.61647523f-17, 7.47567507f-17, 7.51077427f-17, 7.44033603f-17, 7.26436375f-17, 7.05321710f-17, 
                6.84207497f-17, 6.82441299f-17, 6.64845484f-17, 6.61320700f-17, 6.54278364f-17, 6.54271356f-17, 6.66575773f-17, 6.66568633f-17, 1.31729435f-16, 3.71085651f-16, 2.95442570f-16, 2.81358804f-16, 2.63759749f-16, 2.60229010f-16, 2.51424019f-16, 2.32071275f-16, 
                2.19752690f-16, 2.03919569f-16, 1.96877309f-16, 1.88078064f-16, 1.74885649f-16, 1.70833910f-16, 1.61685981f-16, 1.44806638f-16, 1.35309629f-16, 1.21947856f-16, 1.14385876f-16, 1.08757391f-16, 1.31064077f-16, 1.95001843f-16, 1.45443285f-16, 1.28742141f-16, 
                1.19947409f-16, 1.06588970f-16, 9.65694292f-17, 8.70787223f-17, 7.91699381f-17, 7.17894223f-17, 6.56390270f-17, 5.96654371f-17, 5.57987411f-17, 5.03538341f-17, 4.73661160f-17, 4.33265711f-17, 4.05156395f-17, 3.75299373f-17, 3.52462944f-17, 3.27878055f-17, 
                2.99792101f-17, 2.80477085f-17, 2.59413420f-17, 2.47117302f-17, 2.33071405f-17, 2.19028522f-17, 2.03236614f-17, 1.85696245f-17, 1.69385809f-17, 1.62011398f-17, 4.97365272f-17, 1.17995418f-16, 5.85702591f-17, 3.87718988f-17, 2.77391068f-17, 7.89449396f-17)

        else

            solar_flux_Ne = (0.00000f+00, 5.52000f-20, 3.02500f-17, 1.02480f-15, 1.44000f-14,
                5.88000f-13, 1.63560f-11, 5.14600f-11, 1.02176f-10, 1.34420f-10, 2.30400f-10, 2.41560f-10, 1.66880f-10, 8.75000f-11, 4.83600f-11, 1.33545f-09, 4.75020f-09, 2.23110f-08, 9.60400f-09, 1.98008f-08, 3.68550f-09, 1.28436f-08, 5.01072f-08, 1.01732f-08, 4.00050f-09,
                1.17245f-08, 1.58592f-09, 2.45916f-09, 1.54344f-09, 1.78504f-09, 3.52080f-09, 4.94856f-09, 1.80774f-09, 2.55210f-09, 3.40186f-10, 1.02000f-29, 5.52000f-30, 1.20000f-29, 1.15000f-30, 3.39000f-30, 1.59000f-30, 5.19000f-30, 1.28000f-29, 8.07000f-30, 1.05000f-29,
                3.73000f-29, 3.34000f-29, 9.39000f-31, 2.34000f-30, 5.84000f-30, 5.94000f-30, 1.04000f-30, 1.04000f-30, 5.30000f-29, 7.56000f-30, 1.25000f-30, 1.04000f-30, 3.60000f-29, 2.46000f-29, 1.83000f-29, 1.57000f-30, 1.70000f-30, 1.31000f-30, 7.21000f-30, 1.31000f-30,
                1.31000f-30, 1.31000f-30, 6.21000f-30, 1.31000f-30, 1.31000f-30, 9.15000f-31, 7.84000f-31, 1.03000f-30, 2.66000f-30, 1.12000f-30, 1.24000f-30, 1.82000f-30, 1.90000f-30, 7.40000f-30, 3.02000f-27, 3.67000f-29, 1.36000f-29, 1.61000f-29, 1.32000f-29, 1.41000f-29,
                3.11000f-29, 1.06000f-29, 1.37000f-29, 1.02000f-29, 1.14000f-29, 7.29000f-29, 2.20000f-29, 1.59000f-29, 2.21000f-29, 1.24000f-29, 1.99000f-29, 3.09000f-29, 2.57000f-29, 2.74000f-29, 3.10000f-29, 7.60000f-29, 1.01000f-28, 1.30000f-28, 1.82000f-28, 1.33000f-28,
                1.66000f-28, 2.90000f-28, 3.60000f-28, 4.75000f-28, 6.40000f-28, 5.49000f-28, 1.19000f-27, 1.76000f-27, 2.32000f-27, 1.44000f-27, 1.83000f-27, 1.34000f-27, 2.62000f-27, 2.88000f-27, 3.14000f-27, 3.81000f-27, 4.43000f-27, 4.95000f-27, 5.94000f-27, 6.59000f-27,
                7.26000f-27, 9.85000f-27, 1.27000f-26, 1.01000f-26, 1.20000f-26, 1.44000f-26, 1.80000f-26, 2.08000f-26, 2.45000f-26, 5.09000f-26, 7.12000f-26, 9.23000f-26, 8.42000f-26, 1.20000f-25, 1.22000f-25, 1.77000f-25, 1.60000f-25, 1.96000f-25, 2.40000f-25, 2.25000f-25,
                2.21000f-25, 2.32000f-25, 2.50000f-25, 2.73000f-25, 2.88000f-25, 3.02000f-25, 3.97000f-25, 7.13000f-25, 4.37000f-25, 1.12000f-24, 1.25000f-24, 1.16000f-24, 1.19000f-24, 1.38000f-24, 1.70000f-24, 2.46000f-24, 3.90000f-24, 3.99000f-24, 3.86000f-24, 5.08000f-24,
                5.92000f-24, 6.05000f-24, 6.94000f-24, 8.12000f-24, 9.71000f-24, 8.97000f-24, 9.44000f-24, 1.01000f-23, 1.03000f-23, 1.03000f-23, 1.04000f-23, 1.18000f-23, 1.23000f-23, 1.24000f-23, 1.17000f-23, 1.11000f-23, 1.09000f-23, 1.19000f-23, 1.54000f-23, 1.90000f-23,
                1.99000f-23, 1.99000f-23, 2.02000f-23, 2.01000f-23, 1.94000f-23, 1.98000f-23, 2.25000f-23, 2.39000f-23, 2.48000f-23, 2.49000f-23, 2.48000f-23, 2.50000f-23, 2.55000f-23, 2.61000f-23, 2.59000f-23, 2.46000f-23, 2.44000f-23, 2.53000f-23, 2.48000f-23, 2.49000f-23, 
                2.50000f-23, 2.43000f-23, 2.43000f-23, 2.52000f-23, 2.58000f-23, 2.64000f-23, 2.67000f-23, 2.70000f-23, 2.68000f-23, 2.66000f-23, 2.66000f-23, 2.67000f-23, 2.67000f-23, 2.69000f-23, 2.71000f-23, 2.71000f-23, 2.71000f-23, 2.72000f-23, 2.72000f-23, 2.71000f-23,
                2.70000f-23, 2.70000f-23, 2.70000f-23, 2.69000f-23, 2.68000f-23, 2.67000f-23, 2.66000f-23, 2.65000f-23, 3.95000f-23, 5.22000f-23, 5.18000f-23, 5.14000f-23, 5.09000f-23, 5.04000f-23, 4.99000f-23, 4.94000f-23, 4.90000f-23, 4.83000f-23, 4.80000f-23, 4.67000f-23,
                4.59000f-23, 4.68000f-23, 4.54000f-23, 4.60000f-23, 4.53000f-23, 4.41000f-23, 4.34000f-23, 4.31000f-23, 4.03000f-23, 4.33000f-23, 4.25000f-23, 4.27000f-23, 4.23000f-23, 4.13000f-23, 4.01000f-23, 3.89000f-23, 3.88000f-23, 3.78000f-23, 3.76000f-23, 3.72000f-23,
                3.72000f-23, 3.79000f-23, 3.79000f-23, 7.49000f-23, 2.11000f-22, 1.68000f-22, 1.60000f-22, 1.50000f-22, 1.48000f-22, 1.43000f-22, 1.32000f-22, 1.25000f-22, 1.16000f-22, 1.12000f-22, 1.07000f-22, 9.95000f-23, 9.72000f-23, 9.20000f-23, 8.24000f-23, 7.70000f-23,
                6.94000f-23, 6.51000f-23, 6.19000f-23, 7.46000f-23, 1.11000f-22, 8.28000f-23, 7.33000f-23, 6.83000f-23, 6.07000f-23, 5.50000f-23, 4.96000f-23, 4.51000f-23, 4.09000f-23, 3.74000f-23, 3.40000f-23, 3.18000f-23, 2.87000f-23, 2.70000f-23, 2.47000f-23, 2.31000f-23,
                2.14000f-23, 2.01000f-23, 1.87000f-23, 1.71000f-23, 1.60000f-23, 1.48000f-23, 1.41000f-23, 1.33000f-23, 1.25000f-23, 1.16000f-23, 1.06000f-23, 9.67000f-24, 9.25000f-24, 2.84000f-23, 6.74000f-23, 3.35000f-23, 2.22000f-23, 1.59000f-23, 4.53000f-23)


            solar_flux_Ne_active = (0.00000000f+00, 3.51624000f-19, 1.92692500f-16, 6.52797600f-15,
                9.17280000f-14, 3.74556000f-12, 1.04187720f-10, 3.27800200f-10, 2.54192099f-10, 3.14864192f-10, 5.37581982f-10, 5.58007348f-10, 3.88084683f-10, 2.04841641f-10, 1.18609022f-10, 3.63628817f-09, 2.14234020f-08, 1.18461684f-07, 3.28999733f-08, 1.00229728f-07,
                1.00439327f-08, 2.86413516f-08, 1.40526451f-07, 2.62290001f-08, 8.74961119f-09, 3.35584377f-08, 3.41818824f-09, 5.64209703f-09, 3.70425600f-09, 4.28409600f-09, 8.39177835f-09, 1.12412499f-08, 4.04164161f-09, 5.21975241f-09, 6.62722208f-10, 1.91978701f-29,
                1.02407621f-29, 2.29338134f-29, 2.23050971f-30, 6.69335930f-30, 3.44523552f-30, 1.02397078f-29, 3.15008000f-29, 2.00407286f-29, 2.54454549f-29, 8.98930000f-29, 8.04940000f-29, 2.26299000f-30, 5.63940000f-30, 1.14935663f-29, 1.16749334f-29, 2.04139267f-30, 
                2.03868926f-30, 1.23916585f-28, 1.77798931f-29, 2.94339392f-30, 2.45129776f-30, 8.49216727f-29, 4.41467500f-29, 3.14760000f-29, 2.70040000f-30, 2.92400000f-30, 2.25320000f-30, 1.32664000f-29, 2.41040000f-30, 2.41040000f-30, 2.41040000f-30, 1.14264000f-29,
                2.48840577f-30, 2.49428298f-30, 1.72551196f-30, 1.46846826f-30, 1.91797311f-30, 4.91927273f-30, 2.07651613f-30, 2.67716000f-30, 4.21341047f-30, 4.32557537f-30, 1.65980653f-29, 6.67222180f-27, 7.96721358f-29, 2.92097334f-29, 3.44710025f-29, 2.81843418f-29,
                3.00112713f-29, 6.59861295f-29, 2.24192337f-29, 2.79112339f-29, 1.90580252f-29, 2.12575091f-29, 1.35629445f-28, 4.10842038f-29, 2.98461330f-29, 4.44028899f-29, 2.52814910f-29, 3.97138600f-29, 6.03326451f-29, 5.04564735f-29, 5.42683634f-29, 5.96259593f-29,
                1.36816196f-28, 1.67186438f-28, 2.16437915f-28, 3.04846835f-28, 2.24112737f-28, 2.56713383f-28, 4.38445113f-28, 5.35305755f-28, 6.98363665f-28, 9.13915152f-28, 7.63756550f-28, 1.58537874f-27, 2.26708881f-27, 2.79847299f-27, 1.71584107f-27, 2.16665070f-27,
                1.57633307f-27, 3.06086090f-27, 3.34128117f-27, 3.63867920f-27, 4.41047548f-27, 5.12249570f-27, 5.71741844f-27, 6.85326602f-27, 7.59423248f-27, 8.35644995f-27, 1.12840383f-26, 1.43289056f-26, 1.12957716f-26, 1.33023141f-26, 1.58132131f-26, 1.95795617f-26,
                2.25478353f-26, 2.63211187f-26, 5.34450000f-26, 7.47600000f-26, 9.59563367f-26, 8.67260000f-26, 1.23600000f-25, 1.25660000f-25, 1.82310000f-25, 1.64800000f-25, 2.01880000f-25, 2.47200000f-25, 2.31750000f-25, 2.27630000f-25, 2.38960000f-25, 2.57500000f-25,
                2.81190000f-25, 2.95645412f-25, 3.05020000f-25, 4.00968627f-25, 7.20125067f-25, 4.41365417f-25, 1.13118402f-24, 1.26247743f-24, 1.17157454f-24, 1.20186912f-24, 1.39375853f-24, 1.71694174f-24, 2.48450506f-24, 3.93883177f-24, 4.02970977f-24, 3.89839761f-24,
                5.13050893f-24, 5.97883072f-24, 6.11009122f-24, 7.00889357f-24, 8.20056357f-24, 9.80628646f-24, 9.05889997f-24, 9.53350703f-24, 1.01999900f-23, 1.04019143f-23, 1.04018586f-23, 1.05027914f-23, 1.19165649f-23, 1.24214376f-23, 1.25223578f-23, 1.18153873f-23,
                1.12094100f-23, 1.10073797f-23, 1.20171668f-23, 1.55515443f-23, 1.91868676f-23, 2.00956116f-23, 2.00955041f-23, 2.03983422f-23, 2.02972516f-23, 1.95902773f-23, 1.99940935f-23, 2.27204392f-23, 2.41340262f-23, 2.50427049f-23, 2.51435489f-23, 2.50424368f-23,
                2.52442568f-23, 2.57490041f-23, 2.63547219f-23, 2.61526300f-23, 2.48398168f-23, 2.46377351f-23, 2.55463673f-23, 2.50413643f-23, 2.51422030f-23, 2.52430405f-23, 2.45361041f-23, 2.45359727f-23, 2.54445762f-23, 2.60502600f-23, 2.66559373f-23, 2.69587014f-23,
                2.72614622f-23, 2.70593805f-23, 2.68573011f-23, 2.68571573f-23, 2.69579797f-23, 2.69578354f-23, 2.71596214f-23, 2.73614051f-23, 2.73612586f-23, 2.73611122f-23, 2.74619286f-23, 2.74617816f-23, 2.73606727f-23, 2.72595649f-23, 2.72594189f-23, 2.72592730f-23,
                2.71581673f-23, 2.70570627f-23, 2.69559592f-23, 2.68548568f-23, 2.67537554f-23, 3.98780257f-23, 5.26991449f-23, 5.22947600f-23, 5.18903838f-23, 5.13850632f-23, 5.08797535f-23, 5.03744546f-23, 4.98691665f-23, 4.94648378f-23, 4.87576751f-23, 4.84543135f-23,
                4.71415043f-23, 4.63334449f-23, 4.72414378f-23, 4.58277416f-23, 4.64328973f-23, 4.57258200f-23, 4.45140632f-23, 4.38070216f-23, 4.35037422f-23, 4.06770773f-23, 4.37046795f-23, 4.28967432f-23, 4.30981486f-23, 4.26939616f-23, 4.16842016f-23, 4.04726049f-23,
                3.92610341f-23, 3.91596865f-23, 3.81500076f-23, 3.79477492f-23, 3.75436476f-23, 3.75432454f-23, 3.82492946f-23, 3.82488849f-23, 7.55886751f-23, 2.12935497f-22, 1.69530162f-22, 1.61448649f-22, 1.51350000f-22, 1.49324000f-22, 1.44271541f-22, 1.33166595f-22,
                1.26097973f-22, 1.17012649f-22, 1.12971676f-22, 1.07922514f-22, 1.00352473f-22, 9.80275135f-23, 9.27782703f-23, 8.30926054f-23, 7.76430541f-23, 6.99758324f-23, 6.56366351f-23, 6.24069108f-23, 7.52068811f-23, 1.11895500f-22, 8.34579243f-23, 7.38745135f-23,
                6.88279405f-23, 6.11626324f-23, 5.54132432f-23, 4.99673081f-23, 4.54291081f-23, 4.11940378f-23, 3.76648324f-23, 3.42370811f-23, 3.20183027f-23, 2.88939189f-23, 2.71795135f-23, 2.48615514f-23, 2.32485892f-23, 2.15353405f-23, 2.02249459f-23, 1.88142216f-23,
                1.72026000f-23, 1.60942703f-23, 1.48856000f-23, 1.41800270f-23, 1.33740486f-23, 1.25682432f-23, 1.16620757f-23, 1.06555784f-23, 9.71965676f-24, 9.29650000f-24, 2.85396973f-23, 6.77078541f-23, 3.36086486f-23, 2.22480000f-23, 1.59171892f-23, 4.53000000f-23)

            wavelengths, flux_quiet = normalize_flux_distribution(solar_wavelength, solar_flux_Ne, wvl_range[1], wvl_range[2])
            wavelengths, flux_active = normalize_flux_distribution(solar_wavelength, solar_flux_Ne_active, wvl_range[1], wvl_range[2])
        end

    else
        error("Unknown parent_type: $parent_type")
    end

    # Interpolate between quiet and active
    normalized_fluxes = (1.0f0 - sun_mode) .* flux_quiet .+ sun_mode .* flux_active

    # Generate photon energy and wavelength vectors (size 1 if num_reactions is 1, vector otherwise)
    photon_wvl, photon_energy = generate_energy_vector(wavelengths, normalized_fluxes, num_reactions)
    return photon_energy, photon_wvl

end

end